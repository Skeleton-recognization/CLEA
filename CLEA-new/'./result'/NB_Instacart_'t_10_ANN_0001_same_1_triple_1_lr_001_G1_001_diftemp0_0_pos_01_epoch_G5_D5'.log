2023-03-06 10:39:03.891: ******************************************************************************************************************************************************
2023-03-06 10:39:03.891:  *************************************  model_1 *************************************** 
2023-03-06 10:52:27.736: test user nums : 6198  valid user nums : 688
2023-03-06 10:52:32.538: margin1=0.1
2023-03-06 10:52:32.538: margin2=0.1
2023-03-06 10:52:32.538: same_embedding=1
2023-03-06 10:52:32.538: neg_margin=0.9
2023-03-06 10:52:32.538: pos_margin=0.1
2023-03-06 10:52:32.539: next_k=2
2023-03-06 10:52:32.539: pretrain_h=2
2023-03-06 10:52:32.539: soft=0
2023-03-06 10:52:32.539: rnn=GRU
2023-03-06 10:52:32.539: double=0
2023-03-06 10:52:32.539: alternative_train_epoch_D=5
2023-03-06 10:52:32.539: alternative_train_epoch_G2=1
2023-03-06 10:52:32.539: clip_value=0.1
2023-03-06 10:52:32.539: temp_learn=0
2023-03-06 10:52:32.539: output_dir='./result'
2023-03-06 10:52:32.539: G1_lr=0.001
2023-03-06 10:52:32.540: distrisample=0
2023-03-06 10:52:32.540: pretrain_epoch=2
2023-03-06 10:52:32.540: to2=0
2023-03-06 10:52:32.540: MODEL_DIR=./runs
2023-03-06 10:52:32.540: input_dir=dataset/Instacart/user_date_tran_dict_new.txt
2023-03-06 10:52:32.540: dataset=Instacart
2023-03-06 10:52:32.540: epochs=40
2023-03-06 10:52:32.540: device_id=0
2023-03-06 10:52:32.540: log_interval=500
2023-03-06 10:52:32.540: num_users=6886
2023-03-06 10:52:32.540: num_product=8222
2023-03-06 10:52:32.541: seed=24
2023-03-06 10:52:32.541: test_ratio=100
2023-03-06 10:52:32.541: log_fire='t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5'
2023-03-06 10:52:32.541: test_type=1000
2023-03-06 10:52:32.541: test_every_epoch=4
2023-03-06 10:52:32.541: alternative_train_epoch=5
2023-03-06 10:52:32.541: alternative_train_batch=1000
2023-03-06 10:52:32.541: max_basket_size=25
2023-03-06 10:52:32.541: max_basket_num=32
2023-03-06 10:52:32.541: group_split1=4
2023-03-06 10:52:32.542: group_split2=6
2023-03-06 10:52:32.542: clip=0
2023-03-06 10:52:32.542: batch_size=128
2023-03-06 10:52:32.542: neg_ratio=1
2023-03-06 10:52:32.542: judge_ratio=1
2023-03-06 10:52:32.542: sd1=1
2023-03-06 10:52:32.542: sd2=1
2023-03-06 10:52:32.542: sd3=1
2023-03-06 10:52:32.542: sd4=1
2023-03-06 10:52:32.542: sd5=1
2023-03-06 10:52:32.543: learning_rate=0.001
2023-03-06 10:52:32.543: H_lr=1e-05
2023-03-06 10:52:32.543: G2D_lr=0.0001
2023-03-06 10:52:32.543: dropout=0.2
2023-03-06 10:52:32.543: weight_decay=1e-05
2023-03-06 10:52:32.543: basket_pool_type=avg
2023-03-06 10:52:32.543: num_layer=1
2023-03-06 10:52:32.543: embedding_dim=128
2023-03-06 10:52:32.543: ANNEAL_RATE=0.0001
2023-03-06 10:52:32.543: temp=10.0
2023-03-06 10:52:32.544: temp_min=0.3
2023-03-06 10:52:32.544: before_epoch=2
2023-03-06 10:52:32.544: G1_flag=0
2023-03-06 10:52:32.544: histroy=1
2023-03-06 10:53:00.836: reset from ... ./runs/base_model_Instacart_basemodel.pt
2023-03-06 10:53:27.992: 1
2023-03-06 10:53:27.993: Epochs   2 topk   5  basket_length <4  num 714  Hit ratio 0.7465 | recall 0.4532 |  precision 0.2944 | f1  0.3248 | ndcg  0.4824 | mrr  0.6250 
2023-03-06 10:53:27.994: Epochs   2 topk   5  basket_length 4<<6  num 1190  Hit ratio 0.7790 | recall 0.3515 |  precision 0.3593 | f1  0.3260 | ndcg  0.4551 | mrr  0.6468 
2023-03-06 10:53:27.997: Epochs   2 topk   5  basket_length >6  num 4294  Hit ratio 0.9068 | recall 0.2771 |  precision 0.5429 | f1  0.3403 | ndcg  0.5903 | mrr  0.7861 
2023-03-06 10:53:27.997: ...............................................
2023-03-06 10:53:27.997: neg_sample TOP5 [Test]| Epochs   2 | Hit ratio 0.8638 | recall 0.3117 |  precision 0.4790 | f1  0.3358 | ndcg  0.5519 | mrr  0.7408| have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-03-06 10:53:27.997: ##############################################
2023-03-06 10:54:39.051: G1_flag 1 pretrain 1 temp 10.0 train_epoch 0  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-03-06 11:47:33.830: Early Stopping!
2023-03-06 11:47:42.668: ******************************************************************************************************************************************************
2023-03-06 11:47:42.669:  *************************************  model_1 *************************************** 
2023-03-06 11:48:31.490: test user nums : 6198  valid user nums : 688
2023-03-06 11:48:36.425: margin1=0.1
2023-03-06 11:48:36.441: margin2=0.1
2023-03-06 11:48:36.457: same_embedding=1
2023-03-06 11:48:36.472: neg_margin=0.9
2023-03-06 11:48:36.488: pos_margin=0.1
2023-03-06 11:48:36.503: next_k=2
2023-03-06 11:48:36.524: pretrain_h=2
2023-03-06 11:48:36.539: soft=0
2023-03-06 11:48:36.555: rnn=GRU
2023-03-06 11:48:36.570: double=0
2023-03-06 11:48:36.586: alternative_train_epoch_D=5
2023-03-06 11:48:36.606: alternative_train_epoch_G2=1
2023-03-06 11:48:36.622: clip_value=0.1
2023-03-06 11:48:36.638: temp_learn=0
2023-03-06 11:48:37.066: output_dir='./result'
2023-03-06 11:48:37.082: G1_lr=0.001
2023-03-06 11:48:37.098: distrisample=0
2023-03-06 11:48:37.113: pretrain_epoch=2
2023-03-06 11:48:37.129: to2=0
2023-03-06 11:48:37.144: MODEL_DIR=./runs
2023-03-06 11:48:37.165: input_dir=dataset/Instacart/user_date_tran_dict_new.txt
2023-03-06 11:48:37.180: dataset=Instacart
2023-03-06 11:48:37.196: epochs=40
2023-03-06 11:48:37.212: device_id=0
2023-03-06 11:48:37.227: log_interval=500
2023-03-06 11:48:37.243: num_users=6886
2023-03-06 11:48:37.258: num_product=8222
2023-03-06 11:48:37.279: seed=24
2023-03-06 11:48:37.294: test_ratio=100
2023-03-06 11:48:37.305: log_fire='t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5'
2023-03-06 11:48:37.320: test_type=1000
2023-03-06 11:48:37.336: test_every_epoch=4
2023-03-06 11:48:37.352: alternative_train_epoch=5
2023-03-06 11:48:37.372: alternative_train_batch=1000
2023-03-06 11:48:37.388: max_basket_size=25
2023-03-06 11:48:37.403: max_basket_num=32
2023-03-06 11:48:37.419: group_split1=4
2023-03-06 11:48:37.434: group_split2=6
2023-03-06 11:48:37.450: clip=0
2023-03-06 11:48:37.466: batch_size=128
2023-03-06 11:48:37.486: neg_ratio=1
2023-03-06 11:48:37.502: judge_ratio=1
2023-03-06 11:48:37.517: sd1=1
2023-03-06 11:48:37.533: sd2=1
2023-03-06 11:48:37.548: sd3=1
2023-03-06 11:48:37.564: sd4=1
2023-03-06 11:48:37.579: sd5=1
2023-03-06 11:48:37.595: learning_rate=0.001
2023-03-06 11:48:37.611: H_lr=1e-05
2023-03-06 11:48:37.626: G2D_lr=0.0001
2023-03-06 11:48:37.642: dropout=0.2
2023-03-06 11:48:37.657: weight_decay=1e-05
2023-03-06 11:48:38.080: basket_pool_type=avg
2023-03-06 11:48:38.096: num_layer=1
2023-03-06 11:48:38.111: embedding_dim=128
2023-03-06 11:48:38.127: ANNEAL_RATE=0.0001
2023-03-06 11:48:38.142: temp=10.0
2023-03-06 11:48:38.158: temp_min=0.3
2023-03-06 11:48:38.178: before_epoch=2
2023-03-06 11:48:38.194: G1_flag=0
2023-03-06 11:48:38.209: histroy=1
2023-03-06 11:49:54.294: reset from ... ./runs/base_model_Instacart_basemodel.pt
2023-03-06 11:51:39.866: 1
2023-03-06 11:51:39.867: Epochs   2 topk   5  basket_length <4  num 714  Hit ratio 0.7465 | recall 0.4532 |  precision 0.2944 | f1  0.3248 | ndcg  0.4824 | mrr  0.6250 
2023-03-06 11:51:39.868: Epochs   2 topk   5  basket_length 4<<6  num 1190  Hit ratio 0.7790 | recall 0.3515 |  precision 0.3593 | f1  0.3260 | ndcg  0.4551 | mrr  0.6468 
2023-03-06 11:51:39.871: Epochs   2 topk   5  basket_length >6  num 4294  Hit ratio 0.9068 | recall 0.2771 |  precision 0.5429 | f1  0.3403 | ndcg  0.5903 | mrr  0.7861 
2023-03-06 11:51:39.871: ...............................................
2023-03-06 11:51:39.871: neg_sample TOP5 [Test]| Epochs   2 | Hit ratio 0.8638 | recall 0.3117 |  precision 0.4790 | f1  0.3358 | ndcg  0.5519 | mrr  0.7408| have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-03-06 11:51:39.872: ##############################################
2023-03-06 11:51:39.875: G1_flag 1 pretrain 1 temp 10.0 train_epoch 0  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-03-06 15:32:36.062: Early Stopping!
