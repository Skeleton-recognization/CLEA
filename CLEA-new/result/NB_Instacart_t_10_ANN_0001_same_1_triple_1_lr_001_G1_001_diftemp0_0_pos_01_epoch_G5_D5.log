2023-02-20 16:10:09.186: ******************************************************************************************************************************************************
2023-02-20 16:10:09.186:  *************************************  model_1 *************************************** 
2023-02-20 16:10:41.855: test user nums : 6198  valid user nums : 688
2023-02-20 16:10:46.477: margin1=0.1
2023-02-20 16:10:46.478: margin2=0.1
2023-02-20 16:10:46.478: same_embedding=1
2023-02-20 16:10:46.478: neg_margin=0.9
2023-02-20 16:10:46.478: pos_margin=0.1
2023-02-20 16:10:46.478: next_k=2
2023-02-20 16:10:46.478: pretrain_h=2
2023-02-20 16:10:46.478: soft=0
2023-02-20 16:10:46.478: rnn=GRU
2023-02-20 16:10:46.478: double=0
2023-02-20 16:10:46.478: alternative_train_epoch_D=5
2023-02-20 16:10:46.478: alternative_train_epoch_G2=1
2023-02-20 16:10:46.478: clip_value=0.1
2023-02-20 16:10:46.478: temp_learn=0
2023-02-20 16:10:46.478: output_dir=./result
2023-02-20 16:10:46.478: G1_lr=0.001
2023-02-20 16:10:46.478: distrisample=0
2023-02-20 16:10:46.478: pretrain_epoch=2
2023-02-20 16:10:46.478: to2=0
2023-02-20 16:10:46.478: MODEL_DIR=./runs
2023-02-20 16:10:46.478: input_dir=dataset/Instacart/user_date_tran_dict_new.txt
2023-02-20 16:10:46.478: dataset=Instacart
2023-02-20 16:10:46.478: epochs=40
2023-02-20 16:10:46.478: device_id=0
2023-02-20 16:10:46.478: log_interval=500
2023-02-20 16:10:46.478: num_users=6886
2023-02-20 16:10:46.478: num_product=8222
2023-02-20 16:10:46.478: seed=24
2023-02-20 16:10:46.478: test_ratio=100
2023-02-20 16:10:46.478: log_fire=t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5
2023-02-20 16:10:46.478: test_type=1000
2023-02-20 16:10:46.478: test_every_epoch=4
2023-02-20 16:10:46.478: alternative_train_epoch=5
2023-02-20 16:10:46.478: alternative_train_batch=1000
2023-02-20 16:10:46.478: max_basket_size=35
2023-02-20 16:10:46.478: max_basket_num=32
2023-02-20 16:10:46.478: group_split1=4
2023-02-20 16:10:46.478: group_split2=6
2023-02-20 16:10:46.478: clip=0
2023-02-20 16:10:46.478: batch_size=128
2023-02-20 16:10:46.478: neg_ratio=1
2023-02-20 16:10:46.478: judge_ratio=1
2023-02-20 16:10:46.479: sd1=1
2023-02-20 16:10:46.479: sd2=1
2023-02-20 16:10:46.479: sd3=1
2023-02-20 16:10:46.479: sd4=1
2023-02-20 16:10:46.479: sd5=1
2023-02-20 16:10:46.479: learning_rate=0.001
2023-02-20 16:10:46.479: H_lr=1e-05
2023-02-20 16:10:46.479: G2D_lr=0.0001
2023-02-20 16:10:46.479: dropout=0.2
2023-02-20 16:10:46.479: weight_decay=1e-05
2023-02-20 16:10:46.479: basket_pool_type=avg
2023-02-20 16:10:46.479: num_layer=1
2023-02-20 16:10:46.479: embedding_dim=128
2023-02-20 16:10:46.479: ANNEAL_RATE=0.0001
2023-02-20 16:10:46.479: temp=10.0
2023-02-20 16:10:46.479: temp_min=0.3
2023-02-20 16:10:46.479: before_epoch=2
2023-02-20 16:10:46.479: G1_flag=0
2023-02-20 16:10:46.479: histroy=1
2023-02-26 11:32:30.153: ******************************************************************************************************************************************************
2023-02-26 11:32:30.153:  *************************************  model_1 *************************************** 
2023-02-26 11:33:04.423: test user nums : 6198  valid user nums : 688
2023-02-26 11:33:09.251: margin1=0.1
2023-02-26 11:33:09.251: margin2=0.1
2023-02-26 11:33:09.251: same_embedding=1
2023-02-26 11:33:09.251: neg_margin=0.9
2023-02-26 11:33:09.251: pos_margin=0.1
2023-02-26 11:33:09.251: next_k=2
2023-02-26 11:33:09.251: pretrain_h=2
2023-02-26 11:33:09.251: soft=0
2023-02-26 11:33:09.251: rnn=GRU
2023-02-26 11:33:09.251: double=0
2023-02-26 11:33:09.251: alternative_train_epoch_D=5
2023-02-26 11:33:09.251: alternative_train_epoch_G2=1
2023-02-26 11:33:09.251: clip_value=0.1
2023-02-26 11:33:09.251: temp_learn=0
2023-02-26 11:33:09.251: output_dir=./result
2023-02-26 11:33:09.251: G1_lr=0.001
2023-02-26 11:33:09.251: distrisample=0
2023-02-26 11:33:09.251: pretrain_epoch=2
2023-02-26 11:33:09.252: to2=0
2023-02-26 11:33:09.252: MODEL_DIR=./runs
2023-02-26 11:33:09.252: input_dir=dataset/Instacart/user_date_tran_dict_new.txt
2023-02-26 11:33:09.252: dataset=Instacart
2023-02-26 11:33:09.252: epochs=40
2023-02-26 11:33:09.252: device_id=0
2023-02-26 11:33:09.252: log_interval=500
2023-02-26 11:33:09.252: num_users=6886
2023-02-26 11:33:09.252: num_product=8222
2023-02-26 11:33:09.252: seed=24
2023-02-26 11:33:09.252: test_ratio=100
2023-02-26 11:33:09.252: log_fire=t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5
2023-02-26 11:33:09.252: test_type=1000
2023-02-26 11:33:09.252: test_every_epoch=4
2023-02-26 11:33:09.252: alternative_train_epoch=5
2023-02-26 11:33:09.252: alternative_train_batch=1000
2023-02-26 11:33:09.252: max_basket_size=35
2023-02-26 11:33:09.252: max_basket_num=32
2023-02-26 11:33:09.252: group_split1=4
2023-02-26 11:33:09.252: group_split2=6
2023-02-26 11:33:09.252: clip=0
2023-02-26 11:33:09.252: batch_size=128
2023-02-26 11:33:09.252: neg_ratio=1
2023-02-26 11:33:09.252: judge_ratio=1
2023-02-26 11:33:09.252: sd1=1
2023-02-26 11:33:09.252: sd2=1
2023-02-26 11:33:09.252: sd3=1
2023-02-26 11:33:09.252: sd4=1
2023-02-26 11:33:09.252: sd5=1
2023-02-26 11:33:09.252: learning_rate=0.001
2023-02-26 11:33:09.252: H_lr=1e-05
2023-02-26 11:33:09.252: G2D_lr=0.0001
2023-02-26 11:33:09.252: dropout=0.2
2023-02-26 11:33:09.252: weight_decay=1e-05
2023-02-26 11:33:09.252: basket_pool_type=avg
2023-02-26 11:33:09.252: num_layer=1
2023-02-26 11:33:09.252: embedding_dim=128
2023-02-26 11:33:09.252: ANNEAL_RATE=0.0001
2023-02-26 11:33:09.252: temp=10.0
2023-02-26 11:33:09.252: temp_min=0.3
2023-02-26 11:33:09.252: before_epoch=2
2023-02-26 11:33:09.252: G1_flag=0
2023-02-26 11:33:09.252: histroy=1
2023-02-26 11:33:19.569: reset from ... ./runs/base_model_Instacart_basemodel.pt
2023-02-26 11:33:40.136: 1
2023-02-26 11:33:40.136: Epochs   2 topk   5  basket_length <4  num 714  Hit ratio 0.7591 | recall 0.4535 |  precision 0.2936 | f1  0.3239 | ndcg  0.4779 | mrr  0.6266 
2023-02-26 11:33:40.137: Epochs   2 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.7822 | recall 0.3500 |  precision 0.3600 | f1  0.3253 | ndcg  0.4576 | mrr  0.6534 
2023-02-26 11:33:40.139: Epochs   2 topk   5  basket_length >6  num 4295  Hit ratio 0.9076 | recall 0.2773 |  precision 0.5469 | f1  0.3401 | ndcg  0.5951 | mrr  0.7909 
2023-02-26 11:33:40.139: ...............................................
2023-02-26 11:33:40.139: neg_sample TOP5 [Test]| Epochs   2 | Hit ratio 0.8664 | recall 0.3115 |  precision 0.4818 | f1  0.3354 | ndcg  0.5552 | mrr  0.7456| have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 11:33:40.139: ##############################################
2023-02-26 11:33:40.141: G1_flag 1 pretrain 1 temp 10.0 train_epoch 0  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 11:33:40.347: [Training]| Epochs   3 | Batch     0  | ms/batch 0.00 | Loss 7.5962 | p1_Loss 0.6950 | p2_Loss 0.6915 | p3_Loss 6.2097 | p4_Loss 6.2097 | 
2023-02-26 11:33:40.347: real_rest_sum 8259.4482 | real_rest_sum_int 15378.0000 | all_sum 36019.0000 | rest_ratio 0.5371 | repeat_ratio 0.4872
2023-02-26 11:33:56.767: [Training]| Epochs   3 | Batch   500  | ms/batch 0.03 | Loss 7.8650 | p1_Loss 0.6813 | p2_Loss 0.6904 | p3_Loss 6.4933 | p4_Loss 6.4933 | 
2023-02-26 11:33:56.767: real_rest_sum 957.1224 | real_rest_sum_int 1790.0000 | all_sum 8431.0000 | rest_ratio 0.5347 | repeat_ratio 0.5736
2023-02-26 11:34:12.733: [Training]| Epochs   3 | Batch  1000  | ms/batch 0.03 | Loss 8.0539 | p1_Loss 0.6772 | p2_Loss 0.6880 | p3_Loss 6.6886 | p4_Loss 6.6886 | 
2023-02-26 11:34:12.733: real_rest_sum 667.8676 | real_rest_sum_int 1203.0000 | all_sum 6345.0000 | rest_ratio 0.5552 | repeat_ratio 0.8232
2023-02-26 11:34:28.540: [Training]| Epochs   3 | Batch  1500  | ms/batch 0.03 | Loss 7.4677 | p1_Loss 0.6695 | p2_Loss 0.6896 | p3_Loss 6.0909 | p4_Loss 6.0909 | 
2023-02-26 11:34:28.540: real_rest_sum 420.6519 | real_rest_sum_int 738.0000 | all_sum 5135.0000 | rest_ratio 0.5700 | repeat_ratio 0.8452
2023-02-26 11:34:44.516: [Training]| Epochs   3 | Batch  2000  | ms/batch 0.03 | Loss 6.7725 | p1_Loss 0.6573 | p2_Loss 0.6873 | p3_Loss 5.4279 | p4_Loss 5.4279 | 
2023-02-26 11:34:44.516: real_rest_sum 955.3438 | real_rest_sum_int 1617.0000 | all_sum 9130.0000 | rest_ratio 0.5908 | repeat_ratio 0.9678
2023-02-26 11:35:01.143: [Training]| Epochs   3 | Batch  2500  | ms/batch 0.03 | Loss 6.7899 | p1_Loss 0.6606 | p2_Loss 0.6889 | p3_Loss 5.4405 | p4_Loss 5.4405 | 
2023-02-26 11:35:01.143: real_rest_sum 2515.6309 | real_rest_sum_int 4112.0000 | all_sum 22479.0000 | rest_ratio 0.6118 | repeat_ratio 0.9305
2023-02-26 11:35:17.679: [Training]| Epochs   3 | Batch  3000  | ms/batch 0.03 | Loss 6.2074 | p1_Loss 0.6484 | p2_Loss 0.6858 | p3_Loss 4.8731 | p4_Loss 4.8731 | 
2023-02-26 11:35:17.680: real_rest_sum 1930.1355 | real_rest_sum_int 3084.0000 | all_sum 16665.0000 | rest_ratio 0.6259 | repeat_ratio 0.9640
2023-02-26 11:35:33.309: [Training]| Epochs   3 | Batch  3500  | ms/batch 0.03 | Loss 6.5275 | p1_Loss 0.6549 | p2_Loss 0.6882 | p3_Loss 5.1844 | p4_Loss 5.1844 | 
2023-02-26 11:35:33.309: real_rest_sum 1332.6656 | real_rest_sum_int 2016.0000 | all_sum 12073.0000 | rest_ratio 0.6610 | repeat_ratio 0.9552
2023-02-26 11:35:49.451: [Training]| Epochs   3 | Batch  4000  | ms/batch 0.03 | Loss 6.6591 | p1_Loss 0.6491 | p2_Loss 0.6883 | p3_Loss 5.3101 | p4_Loss 5.3101 | 
2023-02-26 11:35:49.451: real_rest_sum 801.5776 | real_rest_sum_int 1202.0000 | all_sum 8613.0000 | rest_ratio 0.6669 | repeat_ratio 0.9207
2023-02-26 11:36:04.353: [Training]| Epochs   3 | Batch  4500  | ms/batch 0.03 | Loss 8.9384 | p1_Loss 0.6845 | p2_Loss 0.6922 | p3_Loss 7.5617 | p4_Loss 7.5617 | 
2023-02-26 11:36:04.353: real_rest_sum 165.0542 | real_rest_sum_int 227.0000 | all_sum 1181.0000 | rest_ratio 0.7271 | repeat_ratio 0.8800
2023-02-26 11:36:20.071: [Training]| Epochs   3 | Batch  5000  | ms/batch 0.03 | Loss 8.7366 | p1_Loss 0.6892 | p2_Loss 0.6891 | p3_Loss 7.3583 | p4_Loss 7.3583 | 
2023-02-26 11:36:20.072: real_rest_sum 184.6109 | real_rest_sum_int 253.0000 | all_sum 1986.0000 | rest_ratio 0.7297 | repeat_ratio 0.7500
2023-02-26 11:36:25.095: batch_num: 5179
2023-02-26 11:36:25.095: [Training]| Epochs   3 | loss_all  7.2572 | p1_all  0.6666 | p2_all  0.6884 | p3_all  5.8978 | p4_all  5.8978 | real_rest_ratio 0.1959 | repeat_ratio 0.8425 |
2023-02-26 11:36:40.797: 1
2023-02-26 11:36:40.797: valid_real_ratio_avg 0.1169 valid_neg_ratio_avg 0.1826 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 11:36:40.797: [Validation] neg_sample TOP5 [Test]| Epochs   3 | Hit ratio 0.8503 | recall 0.2769 |  precision 0.4558 | f1  0.3053 | ndcg  0.5166 | mrr  0.7032 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 11:36:40.797: [Validation] p_n_score_differences_avg 0.1290 
2023-02-26 11:36:40.798: ##############################################
2023-02-26 11:38:56.326: 1
2023-02-26 11:38:56.333: Epochs   3 topk   5  basket_length <4  num 714  Hit ratio 0.7451 | recall 0.4227 |  precision 0.2804 | f1  0.3070 | ndcg  0.4581 | mrr  0.6279 
2023-02-26 11:38:56.334: Epochs   3 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.7864 | recall 0.3326 |  precision 0.3502 | f1  0.3142 | ndcg  0.4446 | mrr  0.6532 
2023-02-26 11:38:56.337: Epochs   3 topk   5  basket_length >6  num 4295  Hit ratio 0.9153 | recall 0.2747 |  precision 0.5454 | f1  0.3378 | ndcg  0.5852 | mrr  0.7717 
2023-02-26 11:38:56.337: ...............................................
2023-02-26 11:38:56.337: test_real_ratio_avg 0.1180 test_neg_ratio_avg 0.1762 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 11:38:56.337: neg_sample TOP5 [Test]| Epochs   3 | Hit ratio 0.8709 | recall 0.3028 |  precision 0.4774 | f1  0.3298 | ndcg  0.5436 | mrr  0.7324 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 11:38:56.337: [Test] p_n_score_differences_avg 0.1341 
2023-02-26 11:38:56.337: ##############################################
2023-02-26 11:38:56.381: Save model as ./runs/model_1_Instacart_t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5.pt
2023-02-26 11:38:56.381: Epochs   3 best_hit 0.8709 best_recall 0.3028 best_precision 0.4774 best_f1 0.3298 best_ndcg 0.5436  best_mrr 0.7324 
2023-02-26 11:38:56.381: Epochs   3 loss_all 7.2572 Hit ratio 0.8709 recall 0.3028 precision 0.4774 f1  0.3298 ndcg  0.5436 mrr  0.7324 avg_fake_length 5.0000
2023-02-26 11:38:56.382: G1_flag 1 pretrain 1 temp 10.0 train_epoch 1  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 11:38:56.606: [Training]| Epochs   4 | Batch     0  | ms/batch 0.00 | Loss 6.7524 | p1_Loss 0.6521 | p2_Loss 0.6893 | p3_Loss 5.4110 | p4_Loss 5.4110 | 
2023-02-26 11:38:56.606: real_rest_sum 1781.9082 | real_rest_sum_int 2944.0000 | all_sum 15421.0000 | rest_ratio 0.6053 | repeat_ratio 0.8997
2023-02-26 11:39:12.787: [Training]| Epochs   4 | Batch   500  | ms/batch 0.03 | Loss 7.5407 | p1_Loss 0.6609 | p2_Loss 0.6876 | p3_Loss 6.1921 | p4_Loss 6.1921 | 
2023-02-26 11:39:12.787: real_rest_sum 559.7643 | real_rest_sum_int 902.0000 | all_sum 5856.0000 | rest_ratio 0.6206 | repeat_ratio 0.9107
2023-02-26 11:39:28.068: [Training]| Epochs   4 | Batch  1000  | ms/batch 0.03 | Loss 7.6359 | p1_Loss 0.6632 | p2_Loss 0.6891 | p3_Loss 6.2836 | p4_Loss 6.2836 | 
2023-02-26 11:39:28.068: real_rest_sum 389.2120 | real_rest_sum_int 620.0000 | all_sum 3942.0000 | rest_ratio 0.6278 | repeat_ratio 0.8942
2023-02-26 11:39:43.200: [Training]| Epochs   4 | Batch  1500  | ms/batch 0.03 | Loss 8.6342 | p1_Loss 0.6845 | p2_Loss 0.6902 | p3_Loss 7.2596 | p4_Loss 7.2596 | 
2023-02-26 11:39:43.200: real_rest_sum 139.6921 | real_rest_sum_int 219.0000 | all_sum 1301.0000 | rest_ratio 0.6379 | repeat_ratio 0.8333
2023-02-26 11:39:58.707: [Training]| Epochs   4 | Batch  2000  | ms/batch 0.03 | Loss 5.3023 | p1_Loss 0.6208 | p2_Loss 0.6833 | p3_Loss 3.9972 | p4_Loss 3.9972 | 
2023-02-26 11:39:58.707: real_rest_sum 3275.9937 | real_rest_sum_int 4978.0000 | all_sum 36149.0000 | rest_ratio 0.6581 | repeat_ratio 0.9041
2023-02-26 11:40:15.467: [Training]| Epochs   4 | Batch  2500  | ms/batch 0.03 | Loss 7.3838 | p1_Loss 0.6718 | p2_Loss 0.6851 | p3_Loss 6.0269 | p4_Loss 6.0269 | 
2023-02-26 11:40:15.467: real_rest_sum 1873.1873 | real_rest_sum_int 2750.0000 | all_sum 13253.0000 | rest_ratio 0.6812 | repeat_ratio 0.9527
2023-02-26 11:40:31.111: [Training]| Epochs   4 | Batch  3000  | ms/batch 0.03 | Loss 7.0301 | p1_Loss 0.6666 | p2_Loss 0.6871 | p3_Loss 5.6660 | p4_Loss 5.6660 | 
2023-02-26 11:40:31.111: real_rest_sum 513.4429 | real_rest_sum_int 758.0000 | all_sum 6651.0000 | rest_ratio 0.6774 | repeat_ratio 0.8908
2023-02-26 11:40:46.802: [Training]| Epochs   4 | Batch  3500  | ms/batch 0.03 | Loss 7.1220 | p1_Loss 0.6557 | p2_Loss 0.6892 | p3_Loss 5.7771 | p4_Loss 5.7771 | 
2023-02-26 11:40:46.802: real_rest_sum 860.0231 | real_rest_sum_int 1208.0000 | all_sum 8624.0000 | rest_ratio 0.7119 | repeat_ratio 0.9118
2023-02-26 11:41:02.117: [Training]| Epochs   4 | Batch  4000  | ms/batch 0.03 | Loss 9.1808 | p1_Loss 0.6900 | p2_Loss 0.6921 | p3_Loss 7.7920 | p4_Loss 7.7920 | 
2023-02-26 11:41:02.118: real_rest_sum 171.8621 | real_rest_sum_int 238.0000 | all_sum 1580.0000 | rest_ratio 0.7221 | repeat_ratio 0.7963
2023-02-26 11:41:19.382: [Training]| Epochs   4 | Batch  4500  | ms/batch 0.04 | Loss 7.3869 | p1_Loss 0.6650 | p2_Loss 0.6883 | p3_Loss 6.0336 | p4_Loss 6.0336 | 
2023-02-26 11:41:19.382: real_rest_sum 1753.2788 | real_rest_sum_int 2243.0000 | all_sum 10274.0000 | rest_ratio 0.7817 | repeat_ratio 0.9300
2023-02-26 11:41:36.278: [Training]| Epochs   4 | Batch  5000  | ms/batch 0.03 | Loss 6.4985 | p1_Loss 0.6444 | p2_Loss 0.6881 | p3_Loss 5.1660 | p4_Loss 5.1660 | 
2023-02-26 11:41:36.279: real_rest_sum 2099.6582 | real_rest_sum_int 2659.0000 | all_sum 13448.0000 | rest_ratio 0.7896 | repeat_ratio 0.9131
2023-02-26 11:41:41.798: batch_num: 5179
2023-02-26 11:41:41.798: [Training]| Epochs   4 | loss_all  6.9078 | p1_all  0.6561 | p2_all  0.6880 | p3_all  5.5590 | p4_all  5.5590 | real_rest_ratio 0.1609 | repeat_ratio 0.9103 |
2023-02-26 11:41:57.504: 1
2023-02-26 11:41:57.505: valid_real_ratio_avg 0.2233 valid_neg_ratio_avg 0.3910 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 11:41:57.505: [Validation] neg_sample TOP5 [Test]| Epochs   4 | Hit ratio 0.8270 | recall 0.2658 |  precision 0.4401 | f1  0.2934 | ndcg  0.5046 | mrr  0.6933 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 11:41:57.505: [Validation] p_n_score_differences_avg 0.1243 
2023-02-26 11:41:57.505: ##############################################
2023-02-26 11:44:21.608: 1
2023-02-26 11:44:21.615: Epochs   4 topk   5  basket_length <4  num 714  Hit ratio 0.7563 | recall 0.4420 |  precision 0.2882 | f1  0.3176 | ndcg  0.4694 | mrr  0.6274 
2023-02-26 11:44:21.616: Epochs   4 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.7754 | recall 0.3326 |  precision 0.3484 | f1  0.3139 | ndcg  0.4409 | mrr  0.6476 
2023-02-26 11:44:21.620: Epochs   4 topk   5  basket_length >6  num 4295  Hit ratio 0.9176 | recall 0.2703 |  precision 0.5355 | f1  0.3318 | ndcg  0.5744 | mrr  0.7648 
2023-02-26 11:44:21.620: ...............................................
2023-02-26 11:44:21.620: test_real_ratio_avg 0.2220 test_neg_ratio_avg 0.3867 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 11:44:21.620: neg_sample TOP5 [Test]| Epochs   4 | Hit ratio 0.8717 | recall 0.3021 |  precision 0.4711 | f1  0.3267 | ndcg  0.5367 | mrr  0.7265 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 11:44:21.620: [Test] p_n_score_differences_avg 0.1306 
2023-02-26 11:44:21.620: ##############################################
2023-02-26 11:44:21.622: Epochs   4 best_hit 0.8717 best_recall 0.3028 best_precision 0.4774 best_f1 0.3298 best_ndcg 0.5436  best_mrr 0.7324 
2023-02-26 11:44:21.622: Epochs   4 loss_all 6.9078 Hit ratio 0.8717 recall 0.3021 precision 0.4711 f1  0.3267 ndcg  0.5367 mrr  0.7265 avg_fake_length 5.0000
2023-02-26 11:44:21.623: G1_flag 1 pretrain 1 temp 10.0 train_epoch 2  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 11:44:21.820: [Training]| Epochs   5 | Batch     0  | ms/batch 0.00 | Loss 5.6860 | p1_Loss 0.6366 | p2_Loss 0.6889 | p3_Loss 4.3604 | p4_Loss 4.3604 | 
2023-02-26 11:44:21.820: real_rest_sum 6163.4756 | real_rest_sum_int 9548.0000 | all_sum 40361.0000 | rest_ratio 0.6455 | repeat_ratio 0.8952
2023-02-26 11:44:39.363: [Training]| Epochs   5 | Batch   500  | ms/batch 0.04 | Loss 6.1328 | p1_Loss 0.6364 | p2_Loss 0.6891 | p3_Loss 4.8074 | p4_Loss 4.8074 | 
2023-02-26 11:44:39.363: real_rest_sum 4370.5713 | real_rest_sum_int 6905.0000 | all_sum 44363.0000 | rest_ratio 0.6330 | repeat_ratio 0.9135
2023-02-26 11:44:55.035: [Training]| Epochs   5 | Batch  1000  | ms/batch 0.03 | Loss 8.6889 | p1_Loss 0.6856 | p2_Loss 0.6897 | p3_Loss 7.3135 | p4_Loss 7.3135 | 
2023-02-26 11:44:55.036: real_rest_sum 141.2155 | real_rest_sum_int 214.0000 | all_sum 1010.0000 | rest_ratio 0.6599 | repeat_ratio 0.8125
2023-02-26 11:45:11.126: [Training]| Epochs   5 | Batch  1500  | ms/batch 0.03 | Loss 6.1462 | p1_Loss 0.6411 | p2_Loss 0.6867 | p3_Loss 4.8140 | p4_Loss 4.8140 | 
2023-02-26 11:45:11.126: real_rest_sum 1555.2621 | real_rest_sum_int 2386.0000 | all_sum 17739.0000 | rest_ratio 0.6518 | repeat_ratio 0.8926
2023-02-26 11:45:27.621: [Training]| Epochs   5 | Batch  2000  | ms/batch 0.03 | Loss 6.0175 | p1_Loss 0.6454 | p2_Loss 0.6892 | p3_Loss 4.6829 | p4_Loss 4.6829 | 
2023-02-26 11:45:27.622: real_rest_sum 6074.6680 | real_rest_sum_int 9296.0000 | all_sum 55269.0000 | rest_ratio 0.6535 | repeat_ratio 0.9443
2023-02-26 11:45:44.459: [Training]| Epochs   5 | Batch  2500  | ms/batch 0.03 | Loss 5.6786 | p1_Loss 0.6219 | p2_Loss 0.6852 | p3_Loss 4.3715 | p4_Loss 4.3715 | 
2023-02-26 11:45:44.459: real_rest_sum 3500.6179 | real_rest_sum_int 5023.0000 | all_sum 22516.0000 | rest_ratio 0.6969 | repeat_ratio 0.9445
2023-02-26 11:45:59.337: [Training]| Epochs   5 | Batch  3000  | ms/batch 0.03 | Loss 7.5262 | p1_Loss 0.6705 | p2_Loss 0.6897 | p3_Loss 6.1660 | p4_Loss 6.1660 | 
2023-02-26 11:45:59.337: real_rest_sum 315.0906 | real_rest_sum_int 462.0000 | all_sum 3245.0000 | rest_ratio 0.6820 | repeat_ratio 0.9426
2023-02-26 11:46:14.921: [Training]| Epochs   5 | Batch  3500  | ms/batch 0.03 | Loss 8.3442 | p1_Loss 0.6813 | p2_Loss 0.6919 | p3_Loss 6.9711 | p4_Loss 6.9711 | 
2023-02-26 11:46:14.921: real_rest_sum 507.8949 | real_rest_sum_int 716.0000 | all_sum 4509.0000 | rest_ratio 0.7094 | repeat_ratio 0.8778
2023-02-26 11:46:29.807: [Training]| Epochs   5 | Batch  4000  | ms/batch 0.03 | Loss 6.2788 | p1_Loss 0.6521 | p2_Loss 0.6886 | p3_Loss 4.9364 | p4_Loss 4.9364 | 
2023-02-26 11:46:29.808: real_rest_sum 835.7955 | real_rest_sum_int 1121.0000 | all_sum 8838.0000 | rest_ratio 0.7456 | repeat_ratio 0.8484
2023-02-26 11:46:41.664: [Training]| Epochs   5 | Batch  4500  | ms/batch 0.02 | Loss 7.5326 | p1_Loss 0.6741 | p2_Loss 0.6894 | p3_Loss 6.1690 | p4_Loss 6.1690 | 
2023-02-26 11:46:41.664: real_rest_sum 960.4994 | real_rest_sum_int 1196.0000 | all_sum 5845.0000 | rest_ratio 0.8031 | repeat_ratio 0.9500
2023-02-26 11:46:57.327: [Training]| Epochs   5 | Batch  5000  | ms/batch 0.03 | Loss 6.4251 | p1_Loss 0.6475 | p2_Loss 0.6894 | p3_Loss 5.0881 | p4_Loss 5.0881 | 
2023-02-26 11:46:57.327: real_rest_sum 2352.3745 | real_rest_sum_int 2927.0000 | all_sum 16214.0000 | rest_ratio 0.8037 | repeat_ratio 0.8959
2023-02-26 11:47:03.282: batch_num: 5179
2023-02-26 11:47:03.282: [Training]| Epochs   5 | loss_all  6.9023 | p1_all  0.6565 | p2_all  0.6880 | p3_all  5.5545 | p4_all  5.5545 | real_rest_ratio 0.1683 | repeat_ratio 0.8874 |
2023-02-26 11:47:19.193: 1
2023-02-26 11:47:19.194: valid_real_ratio_avg 0.2139 valid_neg_ratio_avg 0.3753 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 11:47:19.194: [Validation] neg_sample TOP5 [Test]| Epochs   5 | Hit ratio 0.8459 | recall 0.2731 |  precision 0.4477 | f1  0.2992 | ndcg  0.5140 | mrr  0.7092 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 11:47:19.194: [Validation] p_n_score_differences_avg 0.1262 
2023-02-26 11:47:19.194: ##############################################
2023-02-26 11:47:19.196: G1_flag 1 pretrain 1 temp 10.0 train_epoch 3  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 11:47:19.407: [Training]| Epochs   6 | Batch     0  | ms/batch 0.00 | Loss 6.5624 | p1_Loss 0.6585 | p2_Loss 0.6834 | p3_Loss 5.2205 | p4_Loss 5.2205 | 
2023-02-26 11:47:19.407: real_rest_sum 1678.6884 | real_rest_sum_int 2536.0000 | all_sum 10770.0000 | rest_ratio 0.6619 | repeat_ratio 0.8938
2023-02-26 11:47:35.760: [Training]| Epochs   6 | Batch   500  | ms/batch 0.03 | Loss 7.7018 | p1_Loss 0.6801 | p2_Loss 0.6882 | p3_Loss 6.3335 | p4_Loss 6.3335 | 
2023-02-26 11:47:35.761: real_rest_sum 259.7763 | real_rest_sum_int 401.0000 | all_sum 2491.0000 | rest_ratio 0.6478 | repeat_ratio 0.9815
2023-02-26 11:47:51.013: [Training]| Epochs   6 | Batch  1000  | ms/batch 0.03 | Loss 7.5581 | p1_Loss 0.6731 | p2_Loss 0.6890 | p3_Loss 6.1960 | p4_Loss 6.1960 | 
2023-02-26 11:47:51.014: real_rest_sum 1545.7419 | real_rest_sum_int 2328.0000 | all_sum 11734.0000 | rest_ratio 0.6640 | repeat_ratio 0.8983
2023-02-26 11:48:07.440: [Training]| Epochs   6 | Batch  1500  | ms/batch 0.03 | Loss 8.1681 | p1_Loss 0.6760 | p2_Loss 0.6900 | p3_Loss 6.7982 | p4_Loss 6.7982 | 
2023-02-26 11:48:07.440: real_rest_sum 452.3320 | real_rest_sum_int 691.0000 | all_sum 4708.0000 | rest_ratio 0.6546 | repeat_ratio 0.8033
2023-02-26 11:48:22.973: [Training]| Epochs   6 | Batch  2000  | ms/batch 0.03 | Loss 8.2612 | p1_Loss 0.6777 | p2_Loss 0.6862 | p3_Loss 6.8973 | p4_Loss 6.8973 | 
2023-02-26 11:48:22.973: real_rest_sum 423.0985 | real_rest_sum_int 629.0000 | all_sum 4086.0000 | rest_ratio 0.6727 | repeat_ratio 0.9180
2023-02-26 11:48:38.978: [Training]| Epochs   6 | Batch  2500  | ms/batch 0.03 | Loss 5.6159 | p1_Loss 0.6339 | p2_Loss 0.6888 | p3_Loss 4.2932 | p4_Loss 4.2932 | 
2023-02-26 11:48:38.978: real_rest_sum 3425.4604 | real_rest_sum_int 4859.0000 | all_sum 39969.0000 | rest_ratio 0.7050 | repeat_ratio 0.9180
2023-02-26 11:48:56.643: [Training]| Epochs   6 | Batch  3000  | ms/batch 0.04 | Loss 6.7659 | p1_Loss 0.6513 | p2_Loss 0.6885 | p3_Loss 5.4262 | p4_Loss 5.4262 | 
2023-02-26 11:48:56.643: real_rest_sum 3103.9717 | real_rest_sum_int 4339.0000 | all_sum 17217.0000 | rest_ratio 0.7154 | repeat_ratio 0.8941
2023-02-26 11:49:11.528: [Training]| Epochs   6 | Batch  3500  | ms/batch 0.03 | Loss 9.5139 | p1_Loss 0.6856 | p2_Loss 0.6928 | p3_Loss 8.1003 | p4_Loss 8.1003 | 
2023-02-26 11:49:11.528: real_rest_sum 101.6885 | real_rest_sum_int 145.0000 | all_sum 1563.0000 | rest_ratio 0.7013 | repeat_ratio 0.8421
2023-02-26 11:49:27.464: [Training]| Epochs   6 | Batch  4000  | ms/batch 0.03 | Loss 6.7795 | p1_Loss 0.6509 | p2_Loss 0.6879 | p3_Loss 5.4407 | p4_Loss 5.4407 | 
2023-02-26 11:49:27.464: real_rest_sum 693.4971 | real_rest_sum_int 931.0000 | all_sum 8428.0000 | rest_ratio 0.7449 | repeat_ratio 0.8986
2023-02-26 11:49:43.588: [Training]| Epochs   6 | Batch  4500  | ms/batch 0.03 | Loss 5.8492 | p1_Loss 0.6442 | p2_Loss 0.6838 | p3_Loss 4.5212 | p4_Loss 4.5212 | 
2023-02-26 11:49:43.588: real_rest_sum 5374.6919 | real_rest_sum_int 6619.0000 | all_sum 31911.0000 | rest_ratio 0.8120 | repeat_ratio 0.9230
2023-02-26 11:50:00.890: [Training]| Epochs   6 | Batch  5000  | ms/batch 0.04 | Loss 7.0193 | p1_Loss 0.6658 | p2_Loss 0.6861 | p3_Loss 5.6673 | p4_Loss 5.6673 | 
2023-02-26 11:50:00.891: real_rest_sum 1212.2035 | real_rest_sum_int 1540.0000 | all_sum 8848.0000 | rest_ratio 0.7871 | repeat_ratio 0.8988
2023-02-26 11:50:06.181: batch_num: 5179
2023-02-26 11:50:06.181: [Training]| Epochs   6 | loss_all  6.8797 | p1_all  0.6564 | p2_all  0.6880 | p3_all  5.5324 | p4_all  5.5324 | real_rest_ratio 0.1702 | repeat_ratio 0.8858 |
2023-02-26 11:50:21.927: 1
2023-02-26 11:50:21.928: valid_real_ratio_avg 0.1830 valid_neg_ratio_avg 0.3243 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 11:50:21.928: [Validation] neg_sample TOP5 [Test]| Epochs   6 | Hit ratio 0.8474 | recall 0.2738 |  precision 0.4485 | f1  0.3014 | ndcg  0.5054 | mrr  0.6874 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 11:50:21.928: [Validation] p_n_score_differences_avg 0.1291 
2023-02-26 11:50:21.928: ##############################################
2023-02-26 11:50:21.930: G1_flag 1 pretrain 1 temp 10.0 train_epoch 4  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 11:50:22.169: [Training]| Epochs   7 | Batch     0  | ms/batch 0.00 | Loss 6.7269 | p1_Loss 0.6595 | p2_Loss 0.6886 | p3_Loss 5.3787 | p4_Loss 5.3787 | 
2023-02-26 11:50:22.169: real_rest_sum 2352.1475 | real_rest_sum_int 3579.0000 | all_sum 16341.0000 | rest_ratio 0.6572 | repeat_ratio 0.8581
2023-02-26 11:50:39.899: [Training]| Epochs   7 | Batch   500  | ms/batch 0.04 | Loss 6.3340 | p1_Loss 0.6523 | p2_Loss 0.6829 | p3_Loss 4.9989 | p4_Loss 4.9989 | 
2023-02-26 11:50:39.900: real_rest_sum 1818.7390 | real_rest_sum_int 2711.0000 | all_sum 16109.0000 | rest_ratio 0.6709 | repeat_ratio 0.8504
2023-02-26 11:50:56.589: [Training]| Epochs   7 | Batch  1000  | ms/batch 0.03 | Loss 6.9925 | p1_Loss 0.6493 | p2_Loss 0.6878 | p3_Loss 5.6467 | p4_Loss 5.6467 | 
2023-02-26 11:50:56.589: real_rest_sum 645.2180 | real_rest_sum_int 983.0000 | all_sum 7747.0000 | rest_ratio 0.6564 | repeat_ratio 0.8769
2023-02-26 11:51:11.569: [Training]| Epochs   7 | Batch  1500  | ms/batch 0.03 | Loss 7.2683 | p1_Loss 0.6585 | p2_Loss 0.6830 | p3_Loss 5.9268 | p4_Loss 5.9268 | 
2023-02-26 11:51:11.569: real_rest_sum 464.8683 | real_rest_sum_int 690.0000 | all_sum 4948.0000 | rest_ratio 0.6737 | repeat_ratio 0.8242
2023-02-26 11:51:27.404: [Training]| Epochs   7 | Batch  2000  | ms/batch 0.03 | Loss 7.6067 | p1_Loss 0.6769 | p2_Loss 0.6913 | p3_Loss 6.2385 | p4_Loss 6.2385 | 
2023-02-26 11:51:27.405: real_rest_sum 1343.6550 | real_rest_sum_int 1988.0000 | all_sum 10975.0000 | rest_ratio 0.6759 | repeat_ratio 0.8742
2023-02-26 11:51:43.905: [Training]| Epochs   7 | Batch  2500  | ms/batch 0.03 | Loss 6.7902 | p1_Loss 0.6623 | p2_Loss 0.6871 | p3_Loss 5.4409 | p4_Loss 5.4409 | 
2023-02-26 11:51:43.905: real_rest_sum 1248.9800 | real_rest_sum_int 1790.0000 | all_sum 9871.0000 | rest_ratio 0.6978 | repeat_ratio 0.9135
2023-02-26 11:51:58.913: [Training]| Epochs   7 | Batch  3000  | ms/batch 0.03 | Loss 6.9156 | p1_Loss 0.6575 | p2_Loss 0.6882 | p3_Loss 5.5620 | p4_Loss 5.5620 | 
2023-02-26 11:51:58.913: real_rest_sum 2190.3875 | real_rest_sum_int 3201.0000 | all_sum 26338.0000 | rest_ratio 0.6843 | repeat_ratio 0.8225
2023-02-26 11:52:15.767: [Training]| Epochs   7 | Batch  3500  | ms/batch 0.03 | Loss 6.0825 | p1_Loss 0.6455 | p2_Loss 0.6859 | p3_Loss 4.7510 | p4_Loss 4.7510 | 
2023-02-26 11:52:15.768: real_rest_sum 2408.9189 | real_rest_sum_int 3160.0000 | all_sum 14400.0000 | rest_ratio 0.7623 | repeat_ratio 0.8995
2023-02-26 11:52:30.678: [Training]| Epochs   7 | Batch  4000  | ms/batch 0.03 | Loss 7.4481 | p1_Loss 0.6629 | p2_Loss 0.6909 | p3_Loss 6.0799 | p4_Loss 6.0799 | 
2023-02-26 11:52:30.679: real_rest_sum 243.1177 | real_rest_sum_int 322.0000 | all_sum 2825.0000 | rest_ratio 0.7550 | repeat_ratio 0.8767
2023-02-26 11:52:40.416: [Training]| Epochs   7 | Batch  4500  | ms/batch 0.02 | Loss 8.8409 | p1_Loss 0.6884 | p2_Loss 0.6914 | p3_Loss 7.4611 | p4_Loss 7.4611 | 
2023-02-26 11:52:40.416: real_rest_sum 184.5946 | real_rest_sum_int 234.0000 | all_sum 1726.0000 | rest_ratio 0.7889 | repeat_ratio 0.8000
2023-02-26 11:52:57.344: [Training]| Epochs   7 | Batch  5000  | ms/batch 0.03 | Loss 5.8205 | p1_Loss 0.6321 | p2_Loss 0.6891 | p3_Loss 4.4993 | p4_Loss 4.4993 | 
2023-02-26 11:52:57.345: real_rest_sum 4523.9814 | real_rest_sum_int 5516.0000 | all_sum 37047.0000 | rest_ratio 0.8202 | repeat_ratio 0.8931
2023-02-26 11:53:03.482: batch_num: 5179
2023-02-26 11:53:03.482: [Training]| Epochs   7 | loss_all  6.9152 | p1_all  0.6573 | p2_all  0.6880 | p3_all  5.5669 | p4_all  5.5669 | real_rest_ratio 0.1735 | repeat_ratio 0.8630 |
2023-02-26 11:53:19.266: 1
2023-02-26 11:53:19.267: valid_real_ratio_avg 0.2502 valid_neg_ratio_avg 0.4429 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 11:53:19.267: [Validation] neg_sample TOP5 [Test]| Epochs   7 | Hit ratio 0.8372 | recall 0.2742 |  precision 0.4477 | f1  0.3001 | ndcg  0.5128 | mrr  0.7039 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 11:53:19.267: [Validation] p_n_score_differences_avg 0.1247 
2023-02-26 11:53:19.267: ##############################################
2023-02-26 11:55:40.201: 1
2023-02-26 11:55:40.209: Epochs   7 topk   5  basket_length <4  num 714  Hit ratio 0.7535 | recall 0.4394 |  precision 0.2896 | f1  0.3180 | ndcg  0.4664 | mrr  0.6235 
2023-02-26 11:55:40.210: Epochs   7 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.7721 | recall 0.3325 |  precision 0.3470 | f1  0.3131 | ndcg  0.4412 | mrr  0.6420 
2023-02-26 11:55:40.213: Epochs   7 topk   5  basket_length >6  num 4295  Hit ratio 0.9092 | recall 0.2689 |  precision 0.5358 | f1  0.3314 | ndcg  0.5747 | mrr  0.7614 
2023-02-26 11:55:40.213: ...............................................
2023-02-26 11:55:40.213: test_real_ratio_avg 0.2495 test_neg_ratio_avg 0.4398 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 11:55:40.213: neg_sample TOP5 [Test]| Epochs   7 | Hit ratio 0.8650 | recall 0.3007 |  precision 0.4712 | f1  0.3264 | ndcg  0.5367 | mrr  0.7226 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 11:55:40.213: [Test] p_n_score_differences_avg 0.1302 
2023-02-26 11:55:40.213: ##############################################
2023-02-26 11:55:40.215: Epochs   7 best_hit 0.8717 best_recall 0.3028 best_precision 0.4774 best_f1 0.3298 best_ndcg 0.5436  best_mrr 0.7324 
2023-02-26 11:55:40.215: Epochs   7 loss_all 6.9152 Hit ratio 0.8650 recall 0.3007 precision 0.4712 f1  0.3264 ndcg  0.5367 mrr  0.7226 avg_fake_length 5.0000
2023-02-26 11:55:40.217: G1_flag 0 pretrain 1 temp 10.0 train_epoch 0  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 11:55:40.412: [Training]| Epochs   8 | Batch     0  | ms/batch 0.00 | Loss 11.8110 | p1_Loss 0.6438 | p2_Loss 0.6907 | p3_Loss 4.9476 | p4_Loss 5.5289 | 
2023-02-26 11:55:40.412: real_rest_sum 9992.3037 | real_rest_sum_int 10153.0000 | all_sum 38630.0000 | rest_ratio 0.9842 | repeat_ratio 0.9260
2023-02-26 11:55:58.464: [Training]| Epochs   8 | Batch   500  | ms/batch 0.04 | Loss 11.2046 | p1_Loss 0.5719 | p2_Loss 0.6862 | p3_Loss 4.3165 | p4_Loss 5.6300 | 
2023-02-26 11:55:58.464: real_rest_sum 1926.0703 | real_rest_sum_int 1957.0000 | all_sum 10837.0000 | rest_ratio 0.9842 | repeat_ratio 0.8890
2023-02-26 11:56:14.979: [Training]| Epochs   8 | Batch  1000  | ms/batch 0.03 | Loss 11.6835 | p1_Loss 0.5846 | p2_Loss 0.6865 | p3_Loss 4.1845 | p4_Loss 6.2280 | 
2023-02-26 11:56:14.979: real_rest_sum 3847.6333 | real_rest_sum_int 3908.0000 | all_sum 20755.0000 | rest_ratio 0.9846 | repeat_ratio 0.8557
2023-02-26 11:56:30.533: [Training]| Epochs   8 | Batch  1500  | ms/batch 0.03 | Loss 15.3144 | p1_Loss 0.6653 | p2_Loss 0.6916 | p3_Loss 6.7560 | p4_Loss 7.2015 | 
2023-02-26 11:56:30.534: real_rest_sum 819.6276 | real_rest_sum_int 834.0000 | all_sum 3055.0000 | rest_ratio 0.9828 | repeat_ratio 0.8676
2023-02-26 11:56:45.890: [Training]| Epochs   8 | Batch  2000  | ms/batch 0.03 | Loss 14.0611 | p1_Loss 0.6382 | p2_Loss 0.6877 | p3_Loss 5.8901 | p4_Loss 6.8451 | 
2023-02-26 11:56:45.890: real_rest_sum 740.2522 | real_rest_sum_int 751.0000 | all_sum 4005.0000 | rest_ratio 0.9857 | repeat_ratio 0.9286
2023-02-26 11:57:02.996: [Training]| Epochs   8 | Batch  2500  | ms/batch 0.03 | Loss 9.4653 | p1_Loss 0.5197 | p2_Loss 0.6853 | p3_Loss 3.0103 | p4_Loss 5.2500 | 
2023-02-26 11:57:02.996: real_rest_sum 2157.3813 | real_rest_sum_int 2194.0000 | all_sum 14625.0000 | rest_ratio 0.9833 | repeat_ratio 0.8764
2023-02-26 11:57:19.659: [Training]| Epochs   8 | Batch  3000  | ms/batch 0.03 | Loss 12.2639 | p1_Loss 0.6130 | p2_Loss 0.6885 | p3_Loss 4.7577 | p4_Loss 6.2047 | 
2023-02-26 11:57:19.659: real_rest_sum 1541.4197 | real_rest_sum_int 1562.0000 | all_sum 5328.0000 | rest_ratio 0.9868 | repeat_ratio 0.9681
2023-02-26 11:57:34.866: [Training]| Epochs   8 | Batch  3500  | ms/batch 0.03 | Loss 11.0243 | p1_Loss 0.5724 | p2_Loss 0.6859 | p3_Loss 4.0895 | p4_Loss 5.6765 | 
2023-02-26 11:57:34.866: real_rest_sum 1281.2792 | real_rest_sum_int 1309.0000 | all_sum 6461.0000 | rest_ratio 0.9788 | repeat_ratio 0.8992
2023-02-26 11:57:53.092: [Training]| Epochs   8 | Batch  4000  | ms/batch 0.04 | Loss 10.6226 | p1_Loss 0.5663 | p2_Loss 0.6909 | p3_Loss 3.3966 | p4_Loss 5.9689 | 
2023-02-26 11:57:53.092: real_rest_sum 5518.2295 | real_rest_sum_int 5613.0000 | all_sum 31817.0000 | rest_ratio 0.9831 | repeat_ratio 0.8829
2023-02-26 11:58:08.186: [Training]| Epochs   8 | Batch  4500  | ms/batch 0.03 | Loss 10.8275 | p1_Loss 0.5505 | p2_Loss 0.6874 | p3_Loss 3.5605 | p4_Loss 6.0291 | 
2023-02-26 11:58:08.186: real_rest_sum 6297.8701 | real_rest_sum_int 6383.0000 | all_sum 26209.0000 | rest_ratio 0.9867 | repeat_ratio 0.9104
2023-02-26 11:58:25.140: [Training]| Epochs   8 | Batch  5000  | ms/batch 0.04 | Loss 11.4555 | p1_Loss 0.5697 | p2_Loss 0.6875 | p3_Loss 4.0645 | p4_Loss 6.1338 | 
2023-02-26 11:58:25.140: real_rest_sum 3658.7051 | real_rest_sum_int 3720.0000 | all_sum 18696.0000 | rest_ratio 0.9835 | repeat_ratio 0.8625
2023-02-26 11:58:31.447: batch_num: 5179
2023-02-26 11:58:31.447: [Training]| Epochs   8 | loss_all  11.6790 | p1_all  0.5832 | p2_all  0.6878 | p3_all  4.3547 | p4_all  6.0533 | real_rest_ratio 0.1871 | repeat_ratio 0.9042 |
2023-02-26 11:58:47.348: 1
2023-02-26 11:58:47.349: valid_real_ratio_avg 0.2101 valid_neg_ratio_avg 0.3851 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 11:58:47.349: [Validation] neg_sample TOP5 [Test]| Epochs   8 | Hit ratio 0.8794 | recall 0.3154 |  precision 0.5081 | f1  0.3448 | ndcg  0.5769 | mrr  0.7520 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 11:58:47.349: [Validation] p_n_score_differences_avg 0.3584 
2023-02-26 11:58:47.349: ##############################################
2023-02-26 12:01:08.264: 1
2023-02-26 12:01:08.267: Epochs   8 topk   5  basket_length <4  num 714  Hit ratio 0.7843 | recall 0.4658 |  precision 0.3168 | f1  0.3429 | ndcg  0.5037 | mrr  0.6599 
2023-02-26 12:01:08.268: Epochs   8 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8108 | recall 0.3859 |  precision 0.4022 | f1  0.3619 | ndcg  0.5074 | mrr  0.6999 
2023-02-26 12:01:08.269: Epochs   8 topk   5  basket_length >6  num 4295  Hit ratio 0.9360 | recall 0.3035 |  precision 0.5909 | f1  0.3699 | ndcg  0.6320 | mrr  0.8056 
2023-02-26 12:01:08.269: ...............................................
2023-02-26 12:01:08.269: test_real_ratio_avg 0.2124 test_neg_ratio_avg 0.3829 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 12:01:08.269: neg_sample TOP5 [Test]| Epochs   8 | Hit ratio 0.8945 | recall 0.3380 |  precision 0.5231 | f1  0.3652 | ndcg  0.5933 | mrr  0.7686 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 12:01:08.269: [Test] p_n_score_differences_avg 0.3802 
2023-02-26 12:01:08.269: ##############################################
2023-02-26 12:01:08.345: Save model as ./runs/model_1_Instacart_t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5.pt
2023-02-26 12:01:08.346: Epochs   8 best_hit 0.8945 best_recall 0.3380 best_precision 0.5231 best_f1 0.3652 best_ndcg 0.5933  best_mrr 0.7686 
2023-02-26 12:01:08.346: Epochs   8 loss_all 11.6790 Hit ratio 0.8945 recall 0.3380 precision 0.5231 f1  0.3652 ndcg  0.5933 mrr  0.7686 avg_fake_length 5.0000
2023-02-26 12:01:08.348: G1_flag 0 pretrain 1 temp 10.0 train_epoch 1  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 12:01:08.425: [Training]| Epochs   9 | Batch     0  | ms/batch 0.00 | Loss 13.2780 | p1_Loss 0.6041 | p2_Loss 0.6896 | p3_Loss 5.1641 | p4_Loss 6.8202 | 
2023-02-26 12:01:08.425: real_rest_sum 694.9451 | real_rest_sum_int 708.0000 | all_sum 5151.0000 | rest_ratio 0.9816 | repeat_ratio 0.8763
2023-02-26 12:01:19.161: [Training]| Epochs   9 | Batch   500  | ms/batch 0.02 | Loss 10.8585 | p1_Loss 0.5563 | p2_Loss 0.6880 | p3_Loss 3.6131 | p4_Loss 6.0012 | 
2023-02-26 12:01:19.161: real_rest_sum 2183.4607 | real_rest_sum_int 2224.0000 | all_sum 15963.0000 | rest_ratio 0.9818 | repeat_ratio 0.8804
2023-02-26 12:01:35.342: [Training]| Epochs   9 | Batch  1000  | ms/batch 0.03 | Loss 11.9534 | p1_Loss 0.6023 | p2_Loss 0.6888 | p3_Loss 4.5520 | p4_Loss 6.1103 | 
2023-02-26 12:01:35.342: real_rest_sum 823.6600 | real_rest_sum_int 838.0000 | all_sum 3975.0000 | rest_ratio 0.9829 | repeat_ratio 0.9648
2023-02-26 12:01:51.291: [Training]| Epochs   9 | Batch  1500  | ms/batch 0.03 | Loss 11.4382 | p1_Loss 0.5784 | p2_Loss 0.6894 | p3_Loss 3.8827 | p4_Loss 6.2878 | 
2023-02-26 12:01:51.291: real_rest_sum 2254.9077 | real_rest_sum_int 2302.0000 | all_sum 14078.0000 | rest_ratio 0.9795 | repeat_ratio 0.9494
2023-02-26 12:02:08.828: [Training]| Epochs   9 | Batch  2000  | ms/batch 0.04 | Loss 10.9044 | p1_Loss 0.5515 | p2_Loss 0.6852 | p3_Loss 3.6192 | p4_Loss 6.0485 | 
2023-02-26 12:02:08.828: real_rest_sum 1687.7607 | real_rest_sum_int 1721.0000 | all_sum 13276.0000 | rest_ratio 0.9807 | repeat_ratio 0.9357
2023-02-26 12:02:24.892: [Training]| Epochs   9 | Batch  2500  | ms/batch 0.03 | Loss 11.5322 | p1_Loss 0.5813 | p2_Loss 0.6882 | p3_Loss 4.2182 | p4_Loss 6.0445 | 
2023-02-26 12:02:24.892: real_rest_sum 742.1452 | real_rest_sum_int 760.0000 | all_sum 6565.0000 | rest_ratio 0.9765 | repeat_ratio 0.8669
2023-02-26 12:02:41.719: [Training]| Epochs   9 | Batch  3000  | ms/batch 0.03 | Loss 14.2582 | p1_Loss 0.6456 | p2_Loss 0.6907 | p3_Loss 6.2353 | p4_Loss 6.6867 | 
2023-02-26 12:02:41.719: real_rest_sum 198.0992 | real_rest_sum_int 202.0000 | all_sum 1444.0000 | rest_ratio 0.9807 | repeat_ratio 0.9394
2023-02-26 12:02:57.317: [Training]| Epochs   9 | Batch  3500  | ms/batch 0.03 | Loss 9.4608 | p1_Loss 0.5239 | p2_Loss 0.6866 | p3_Loss 2.7559 | p4_Loss 5.4945 | 
2023-02-26 12:02:57.317: real_rest_sum 2328.6104 | real_rest_sum_int 2368.0000 | all_sum 14955.0000 | rest_ratio 0.9834 | repeat_ratio 0.9280
2023-02-26 12:03:14.953: [Training]| Epochs   9 | Batch  4000  | ms/batch 0.04 | Loss 10.5955 | p1_Loss 0.5408 | p2_Loss 0.6900 | p3_Loss 3.4502 | p4_Loss 5.9146 | 
2023-02-26 12:03:14.953: real_rest_sum 2447.9167 | real_rest_sum_int 2505.0000 | all_sum 25099.0000 | rest_ratio 0.9772 | repeat_ratio 0.8952
2023-02-26 12:03:31.789: [Training]| Epochs   9 | Batch  4500  | ms/batch 0.03 | Loss 12.8361 | p1_Loss 0.5814 | p2_Loss 0.6902 | p3_Loss 4.7751 | p4_Loss 6.7894 | 
2023-02-26 12:03:31.789: real_rest_sum 604.9286 | real_rest_sum_int 615.0000 | all_sum 5722.0000 | rest_ratio 0.9836 | repeat_ratio 0.8743
2023-02-26 12:03:48.880: [Training]| Epochs   9 | Batch  5000  | ms/batch 0.03 | Loss 8.9162 | p1_Loss 0.4833 | p2_Loss 0.6898 | p3_Loss 2.2263 | p4_Loss 5.5111 | 
2023-02-26 12:03:48.880: real_rest_sum 5995.4409 | real_rest_sum_int 6131.0000 | all_sum 65159.0000 | rest_ratio 0.9779 | repeat_ratio 0.8683
2023-02-26 12:03:55.061: batch_num: 5179
2023-02-26 12:03:55.062: [Training]| Epochs   9 | loss_all  10.9524 | p1_all  0.5599 | p2_all  0.6877 | p3_all  3.7825 | p4_all  5.9208 | real_rest_ratio 0.1265 | repeat_ratio 0.8981 |
2023-02-26 12:04:10.969: 1
2023-02-26 12:04:10.970: valid_real_ratio_avg 0.1516 valid_neg_ratio_avg 0.2724 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 12:04:10.970: [Validation] neg_sample TOP5 [Test]| Epochs   9 | Hit ratio 0.8924 | recall 0.3323 |  precision 0.5387 | f1  0.3653 | ndcg  0.6048 | mrr  0.7683 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 12:04:10.970: [Validation] p_n_score_differences_avg 0.3842 
2023-02-26 12:04:10.970: ##############################################
2023-02-26 12:06:36.042: 1
2023-02-26 12:06:36.049: Epochs   9 topk   5  basket_length <4  num 714  Hit ratio 0.7927 | recall 0.4884 |  precision 0.3294 | f1  0.3583 | ndcg  0.5243 | mrr  0.6733 
2023-02-26 12:06:36.050: Epochs   9 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8301 | recall 0.3967 |  precision 0.4130 | f1  0.3726 | ndcg  0.5179 | mrr  0.7115 
2023-02-26 12:06:36.054: Epochs   9 topk   5  basket_length >6  num 4295  Hit ratio 0.9418 | recall 0.3184 |  precision 0.6171 | f1  0.3874 | ndcg  0.6598 | mrr  0.8266 
2023-02-26 12:06:36.054: ...............................................
2023-02-26 12:06:36.054: test_real_ratio_avg 0.1571 test_neg_ratio_avg 0.2696 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 12:06:36.054: neg_sample TOP5 [Test]| Epochs   9 | Hit ratio 0.9032 | recall 0.3530 |  precision 0.5448 | f1  0.3812 | ndcg  0.6170 | mrr  0.7869 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 12:06:36.054: [Test] p_n_score_differences_avg 0.4063 
2023-02-26 12:06:36.054: ##############################################
2023-02-26 12:06:36.157: Save model as ./runs/model_1_Instacart_t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5.pt
2023-02-26 12:06:36.157: Epochs   9 best_hit 0.9032 best_recall 0.3530 best_precision 0.5448 best_f1 0.3812 best_ndcg 0.6170  best_mrr 0.7869 
2023-02-26 12:06:36.157: Epochs   9 loss_all 10.9524 Hit ratio 0.9032 recall 0.3530 precision 0.5448 f1  0.3812 ndcg  0.6170 mrr  0.7869 avg_fake_length 5.0000
2023-02-26 12:06:36.159: G1_flag 0 pretrain 1 temp 10.0 train_epoch 2  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 12:06:36.304: [Training]| Epochs  10 | Batch     0  | ms/batch 0.00 | Loss 13.7784 | p1_Loss 0.6296 | p2_Loss 0.6924 | p3_Loss 5.6174 | p4_Loss 6.8391 | 
2023-02-26 12:06:36.304: real_rest_sum 333.6823 | real_rest_sum_int 341.0000 | all_sum 3361.0000 | rest_ratio 0.9785 | repeat_ratio 0.8500
2023-02-26 12:06:52.307: [Training]| Epochs  10 | Batch   500  | ms/batch 0.03 | Loss 8.2435 | p1_Loss 0.4708 | p2_Loss 0.6901 | p3_Loss 1.7774 | p4_Loss 5.2973 | 
2023-02-26 12:06:52.307: real_rest_sum 5092.3613 | real_rest_sum_int 5206.0000 | all_sum 56144.0000 | rest_ratio 0.9782 | repeat_ratio 0.8929
2023-02-26 12:07:08.065: [Training]| Epochs  10 | Batch  1000  | ms/batch 0.03 | Loss 12.0927 | p1_Loss 0.5949 | p2_Loss 0.6875 | p3_Loss 4.2212 | p4_Loss 6.5892 | 
2023-02-26 12:07:08.065: real_rest_sum 1294.3947 | real_rest_sum_int 1324.0000 | all_sum 9904.0000 | rest_ratio 0.9776 | repeat_ratio 0.8806
2023-02-26 12:07:24.593: [Training]| Epochs  10 | Batch  1500  | ms/batch 0.03 | Loss 10.2477 | p1_Loss 0.5445 | p2_Loss 0.6848 | p3_Loss 3.4478 | p4_Loss 5.5707 | 
2023-02-26 12:07:24.593: real_rest_sum 939.8851 | real_rest_sum_int 956.0000 | all_sum 6642.0000 | rest_ratio 0.9831 | repeat_ratio 0.9312
2023-02-26 12:07:41.108: [Training]| Epochs  10 | Batch  2000  | ms/batch 0.03 | Loss 9.1594 | p1_Loss 0.4902 | p2_Loss 0.6901 | p3_Loss 2.1659 | p4_Loss 5.7893 | 
2023-02-26 12:07:41.108: real_rest_sum 3135.0654 | real_rest_sum_int 3208.0000 | all_sum 35409.0000 | rest_ratio 0.9773 | repeat_ratio 0.9105
2023-02-26 12:07:58.790: [Training]| Epochs  10 | Batch  2500  | ms/batch 0.04 | Loss 9.3152 | p1_Loss 0.5087 | p2_Loss 0.6834 | p3_Loss 2.5454 | p4_Loss 5.5777 | 
2023-02-26 12:07:58.791: real_rest_sum 4488.9209 | real_rest_sum_int 4584.0000 | all_sum 35666.0000 | rest_ratio 0.9793 | repeat_ratio 0.8997
2023-02-26 12:08:15.295: [Training]| Epochs  10 | Batch  3000  | ms/batch 0.03 | Loss 7.9095 | p1_Loss 0.4406 | p2_Loss 0.6889 | p3_Loss 1.4870 | p4_Loss 5.2295 | 
2023-02-26 12:08:15.295: real_rest_sum 3189.1067 | real_rest_sum_int 3249.0000 | all_sum 48507.0000 | rest_ratio 0.9816 | repeat_ratio 0.8912
2023-02-26 12:08:33.140: [Training]| Epochs  10 | Batch  3500  | ms/batch 0.04 | Loss 9.3595 | p1_Loss 0.5225 | p2_Loss 0.6861 | p3_Loss 2.6914 | p4_Loss 5.4595 | 
2023-02-26 12:08:33.141: real_rest_sum 1354.1355 | real_rest_sum_int 1387.0000 | all_sum 15078.0000 | rest_ratio 0.9763 | repeat_ratio 0.8867
2023-02-26 12:08:49.522: [Training]| Epochs  10 | Batch  4000  | ms/batch 0.03 | Loss 10.9207 | p1_Loss 0.5470 | p2_Loss 0.6885 | p3_Loss 3.5165 | p4_Loss 6.1496 | 
2023-02-26 12:08:49.522: real_rest_sum 648.5503 | real_rest_sum_int 661.0000 | all_sum 7665.0000 | rest_ratio 0.9812 | repeat_ratio 0.8953
2023-02-26 12:09:05.041: [Training]| Epochs  10 | Batch  4500  | ms/batch 0.03 | Loss 9.8748 | p1_Loss 0.5091 | p2_Loss 0.6888 | p3_Loss 2.5160 | p4_Loss 6.1445 | 
2023-02-26 12:09:05.041: real_rest_sum 4604.3101 | real_rest_sum_int 4713.0000 | all_sum 48013.0000 | rest_ratio 0.9769 | repeat_ratio 0.9383
2023-02-26 12:09:23.533: [Training]| Epochs  10 | Batch  5000  | ms/batch 0.04 | Loss 9.1228 | p1_Loss 0.5064 | p2_Loss 0.6871 | p3_Loss 2.4657 | p4_Loss 5.4637 | 
2023-02-26 12:09:23.533: real_rest_sum 2568.2192 | real_rest_sum_int 2613.0000 | all_sum 21216.0000 | rest_ratio 0.9829 | repeat_ratio 0.8915
2023-02-26 12:09:29.750: batch_num: 5179
2023-02-26 12:09:29.750: [Training]| Epochs  10 | loss_all  10.7119 | p1_all  0.5488 | p2_all  0.6879 | p3_all  3.5923 | p4_all  5.8744 | real_rest_ratio 0.0974 | repeat_ratio 0.8958 |
2023-02-26 12:09:45.660: 1
2023-02-26 12:09:45.660: valid_real_ratio_avg 0.1253 valid_neg_ratio_avg 0.2131 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 12:09:45.661: [Validation] neg_sample TOP5 [Test]| Epochs  10 | Hit ratio 0.8939 | recall 0.3318 |  precision 0.5392 | f1  0.3656 | ndcg  0.6087 | mrr  0.7773 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 12:09:45.661: [Validation] p_n_score_differences_avg 0.3966 
2023-02-26 12:09:45.661: ##############################################
2023-02-26 12:12:10.282: 1
2023-02-26 12:12:10.289: Epochs  10 topk   5  basket_length <4  num 714  Hit ratio 0.7969 | recall 0.4946 |  precision 0.3314 | f1  0.3606 | ndcg  0.5280 | mrr  0.6744 
2023-02-26 12:12:10.290: Epochs  10 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8352 | recall 0.4052 |  precision 0.4220 | f1  0.3804 | ndcg  0.5338 | mrr  0.7279 
2023-02-26 12:12:10.293: Epochs  10 topk   5  basket_length >6  num 4295  Hit ratio 0.9441 | recall 0.3232 |  precision 0.6215 | f1  0.3921 | ndcg  0.6648 | mrr  0.8293 
2023-02-26 12:12:10.293: ...............................................
2023-02-26 12:12:10.293: test_real_ratio_avg 0.1297 test_neg_ratio_avg 0.2095 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 12:12:10.293: neg_sample TOP5 [Test]| Epochs  10 | Hit ratio 0.9063 | recall 0.3587 |  precision 0.5498 | f1  0.3863 | ndcg  0.6239 | mrr  0.7920 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 12:12:10.293: [Test] p_n_score_differences_avg 0.4269 
2023-02-26 12:12:10.293: ##############################################
2023-02-26 12:12:10.416: Save model as ./runs/model_1_Instacart_t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5.pt
2023-02-26 12:12:10.416: Epochs  10 best_hit 0.9063 best_recall 0.3587 best_precision 0.5498 best_f1 0.3863 best_ndcg 0.6239  best_mrr 0.7920 
2023-02-26 12:12:10.416: Epochs  10 loss_all 10.7119 Hit ratio 0.9063 recall 0.3587 precision 0.5498 f1  0.3863 ndcg  0.6239 mrr  0.7920 avg_fake_length 5.0000
2023-02-26 12:12:10.418: G1_flag 0 pretrain 1 temp 10.0 train_epoch 3  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 12:12:10.648: [Training]| Epochs  11 | Batch     0  | ms/batch 0.00 | Loss 11.0153 | p1_Loss 0.5734 | p2_Loss 0.6855 | p3_Loss 3.8812 | p4_Loss 5.8752 | 
2023-02-26 12:12:10.649: real_rest_sum 1241.0155 | real_rest_sum_int 1264.0000 | all_sum 8991.0000 | rest_ratio 0.9818 | repeat_ratio 0.9190
2023-02-26 12:12:27.426: [Training]| Epochs  11 | Batch   500  | ms/batch 0.03 | Loss 10.6131 | p1_Loss 0.5623 | p2_Loss 0.6866 | p3_Loss 3.5880 | p4_Loss 5.7523 | 
2023-02-26 12:12:27.427: real_rest_sum 483.7764 | real_rest_sum_int 494.0000 | all_sum 6651.0000 | rest_ratio 0.9793 | repeat_ratio 0.8737
2023-02-26 12:12:44.651: [Training]| Epochs  11 | Batch  1000  | ms/batch 0.03 | Loss 7.9547 | p1_Loss 0.4496 | p2_Loss 0.6845 | p3_Loss 1.7434 | p4_Loss 5.0193 | 
2023-02-26 12:12:44.651: real_rest_sum 1639.2949 | real_rest_sum_int 1677.0000 | all_sum 29353.0000 | rest_ratio 0.9775 | repeat_ratio 0.8818
2023-02-26 12:13:00.262: [Training]| Epochs  11 | Batch  1500  | ms/batch 0.03 | Loss 14.0530 | p1_Loss 0.6265 | p2_Loss 0.6920 | p3_Loss 5.9721 | p4_Loss 6.7623 | 
2023-02-26 12:13:00.263: real_rest_sum 219.4350 | real_rest_sum_int 222.0000 | all_sum 2022.0000 | rest_ratio 0.9884 | repeat_ratio 0.8571
2023-02-26 12:13:16.939: [Training]| Epochs  11 | Batch  2000  | ms/batch 0.03 | Loss 9.2363 | p1_Loss 0.5075 | p2_Loss 0.6897 | p3_Loss 2.4482 | p4_Loss 5.5624 | 
2023-02-26 12:13:16.939: real_rest_sum 1175.4932 | real_rest_sum_int 1205.0000 | all_sum 15988.0000 | rest_ratio 0.9755 | repeat_ratio 0.8839
2023-02-26 12:13:34.302: [Training]| Epochs  11 | Batch  2500  | ms/batch 0.04 | Loss 9.2533 | p1_Loss 0.4925 | p2_Loss 0.6882 | p3_Loss 2.6362 | p4_Loss 5.3954 | 
2023-02-26 12:13:34.303: real_rest_sum 2229.4211 | real_rest_sum_int 2280.0000 | all_sum 32332.0000 | rest_ratio 0.9778 | repeat_ratio 0.9155
2023-02-26 12:13:48.928: [Training]| Epochs  11 | Batch  3000  | ms/batch 0.03 | Loss 8.9592 | p1_Loss 0.5028 | p2_Loss 0.6881 | p3_Loss 2.2972 | p4_Loss 5.4503 | 
2023-02-26 12:13:48.928: real_rest_sum 2488.3086 | real_rest_sum_int 2546.0000 | all_sum 29706.0000 | rest_ratio 0.9773 | repeat_ratio 0.9246
2023-02-26 12:14:03.974: [Training]| Epochs  11 | Batch  3500  | ms/batch 0.03 | Loss 10.2580 | p1_Loss 0.5277 | p2_Loss 0.6827 | p3_Loss 3.1502 | p4_Loss 5.8974 | 
2023-02-26 12:14:03.975: real_rest_sum 1600.1382 | real_rest_sum_int 1631.0000 | all_sum 17197.0000 | rest_ratio 0.9811 | repeat_ratio 0.8925
2023-02-26 12:14:20.869: [Training]| Epochs  11 | Batch  4000  | ms/batch 0.03 | Loss 13.7713 | p1_Loss 0.6370 | p2_Loss 0.6909 | p3_Loss 5.7003 | p4_Loss 6.7431 | 
2023-02-26 12:14:20.869: real_rest_sum 408.1353 | real_rest_sum_int 415.0000 | all_sum 3018.0000 | rest_ratio 0.9835 | repeat_ratio 0.8780
2023-02-26 12:14:36.284: [Training]| Epochs  11 | Batch  4500  | ms/batch 0.03 | Loss 11.9554 | p1_Loss 0.5820 | p2_Loss 0.6864 | p3_Loss 4.2778 | p4_Loss 6.3601 | 
2023-02-26 12:14:36.284: real_rest_sum 912.7362 | real_rest_sum_int 934.0000 | all_sum 11133.0000 | rest_ratio 0.9772 | repeat_ratio 0.9151
2023-02-26 12:14:51.634: [Training]| Epochs  11 | Batch  5000  | ms/batch 0.03 | Loss 12.7722 | p1_Loss 0.6110 | p2_Loss 0.6890 | p3_Loss 5.2479 | p4_Loss 6.2244 | 
2023-02-26 12:14:51.634: real_rest_sum 211.0209 | real_rest_sum_int 216.0000 | all_sum 2080.0000 | rest_ratio 0.9769 | repeat_ratio 0.9444
2023-02-26 12:14:57.633: batch_num: 5179
2023-02-26 12:14:57.633: [Training]| Epochs  11 | loss_all  10.5971 | p1_all  0.5426 | p2_all  0.6880 | p3_all  3.4961 | p4_all  5.8532 | real_rest_ratio 0.0851 | repeat_ratio 0.8978 |
2023-02-26 12:15:13.587: 1
2023-02-26 12:15:13.588: valid_real_ratio_avg 0.1089 valid_neg_ratio_avg 0.1797 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 12:15:13.588: [Validation] neg_sample TOP5 [Test]| Epochs  11 | Hit ratio 0.9041 | recall 0.3407 |  precision 0.5456 | f1  0.3728 | ndcg  0.6189 | mrr  0.7859 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 12:15:13.588: [Validation] p_n_score_differences_avg 0.4200 
2023-02-26 12:15:13.588: ##############################################
2023-02-26 12:17:38.390: 1
2023-02-26 12:17:38.398: Epochs  11 topk   5  basket_length <4  num 714  Hit ratio 0.8067 | recall 0.5078 |  precision 0.3373 | f1  0.3697 | ndcg  0.5368 | mrr  0.6842 
2023-02-26 12:17:38.399: Epochs  11 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8444 | recall 0.4124 |  precision 0.4291 | f1  0.3871 | ndcg  0.5378 | mrr  0.7287 
2023-02-26 12:17:38.402: Epochs  11 topk   5  basket_length >6  num 4295  Hit ratio 0.9451 | recall 0.3241 |  precision 0.6253 | f1  0.3939 | ndcg  0.6648 | mrr  0.8214 
2023-02-26 12:17:38.402: ...............................................
2023-02-26 12:17:38.402: test_real_ratio_avg 0.1157 test_neg_ratio_avg 0.1761 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 12:17:38.402: neg_sample TOP5 [Test]| Epochs  11 | Hit ratio 0.9098 | recall 0.3622 |  precision 0.5545 | f1  0.3898 | ndcg  0.6257 | mrr  0.7878 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 12:17:38.402: [Test] p_n_score_differences_avg 0.4465 
2023-02-26 12:17:38.402: ##############################################
2023-02-26 12:17:38.508: Save model as ./runs/model_1_Instacart_t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5.pt
2023-02-26 12:17:38.508: Epochs  11 best_hit 0.9098 best_recall 0.3622 best_precision 0.5545 best_f1 0.3898 best_ndcg 0.6257  best_mrr 0.7920 
2023-02-26 12:17:38.508: Epochs  11 loss_all 10.5971 Hit ratio 0.9098 recall 0.3622 precision 0.5545 f1  0.3898 ndcg  0.6257 mrr  0.7878 avg_fake_length 5.0000
2023-02-26 12:17:38.510: G1_flag 0 pretrain 1 temp 10.0 train_epoch 4  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 12:17:38.726: [Training]| Epochs  12 | Batch     0  | ms/batch 0.00 | Loss 9.6731 | p1_Loss 0.5173 | p2_Loss 0.6891 | p3_Loss 2.7122 | p4_Loss 5.7546 | 
2023-02-26 12:17:38.727: real_rest_sum 4122.4277 | real_rest_sum_int 4211.0000 | all_sum 35747.0000 | rest_ratio 0.9790 | repeat_ratio 0.9089
2023-02-26 12:17:57.871: [Training]| Epochs  12 | Batch   500  | ms/batch 0.04 | Loss 8.3547 | p1_Loss 0.4976 | p2_Loss 0.6873 | p3_Loss 2.1700 | p4_Loss 4.9998 | 
2023-02-26 12:17:57.871: real_rest_sum 3028.5483 | real_rest_sum_int 3092.0000 | all_sum 24168.0000 | rest_ratio 0.9795 | repeat_ratio 0.9038
2023-02-26 12:18:14.896: [Training]| Epochs  12 | Batch  1000  | ms/batch 0.03 | Loss 10.3610 | p1_Loss 0.5273 | p2_Loss 0.6874 | p3_Loss 3.1847 | p4_Loss 5.9616 | 
2023-02-26 12:18:14.896: real_rest_sum 1926.1907 | real_rest_sum_int 1968.0000 | all_sum 16341.0000 | rest_ratio 0.9788 | repeat_ratio 0.9113
2023-02-26 12:18:31.593: [Training]| Epochs  12 | Batch  1500  | ms/batch 0.03 | Loss 10.0078 | p1_Loss 0.5565 | p2_Loss 0.6828 | p3_Loss 3.4049 | p4_Loss 5.3613 | 
2023-02-26 12:18:31.593: real_rest_sum 784.4118 | real_rest_sum_int 797.0000 | all_sum 9370.0000 | rest_ratio 0.9842 | repeat_ratio 0.9074
2023-02-26 12:18:48.402: [Training]| Epochs  12 | Batch  2000  | ms/batch 0.03 | Loss 13.0783 | p1_Loss 0.6172 | p2_Loss 0.6911 | p3_Loss 5.2157 | p4_Loss 6.5543 | 
2023-02-26 12:18:48.403: real_rest_sum 326.9124 | real_rest_sum_int 336.0000 | all_sum 2743.0000 | rest_ratio 0.9730 | repeat_ratio 0.9479
2023-02-26 12:19:04.008: [Training]| Epochs  12 | Batch  2500  | ms/batch 0.03 | Loss 11.6679 | p1_Loss 0.5795 | p2_Loss 0.6889 | p3_Loss 4.3078 | p4_Loss 6.0917 | 
2023-02-26 12:19:04.009: real_rest_sum 923.6218 | real_rest_sum_int 941.0000 | all_sum 7007.0000 | rest_ratio 0.9815 | repeat_ratio 0.9078
2023-02-26 12:19:20.243: [Training]| Epochs  12 | Batch  3000  | ms/batch 0.03 | Loss 10.7702 | p1_Loss 0.5431 | p2_Loss 0.6896 | p3_Loss 3.6154 | p4_Loss 5.8474 | 
2023-02-26 12:19:20.243: real_rest_sum 443.1871 | real_rest_sum_int 451.0000 | all_sum 7973.0000 | rest_ratio 0.9827 | repeat_ratio 0.8411
2023-02-26 12:19:36.713: [Training]| Epochs  12 | Batch  3500  | ms/batch 0.03 | Loss 14.1397 | p1_Loss 0.6555 | p2_Loss 0.6925 | p3_Loss 6.2032 | p4_Loss 6.5469 | 
2023-02-26 12:19:36.714: real_rest_sum 102.0616 | real_rest_sum_int 105.0000 | all_sum 1281.0000 | rest_ratio 0.9720 | repeat_ratio 0.8333
2023-02-26 12:19:53.808: [Training]| Epochs  12 | Batch  4000  | ms/batch 0.03 | Loss 8.7805 | p1_Loss 0.4865 | p2_Loss 0.6834 | p3_Loss 2.0538 | p4_Loss 5.5147 | 
2023-02-26 12:19:53.808: real_rest_sum 2272.5659 | real_rest_sum_int 2328.0000 | all_sum 38799.0000 | rest_ratio 0.9762 | repeat_ratio 0.9297
2023-02-26 12:20:11.368: [Training]| Epochs  12 | Batch  4500  | ms/batch 0.04 | Loss 9.7905 | p1_Loss 0.5200 | p2_Loss 0.6866 | p3_Loss 2.8913 | p4_Loss 5.6372 | 
2023-02-26 12:20:11.369: real_rest_sum 1439.3206 | real_rest_sum_int 1475.0000 | all_sum 22334.0000 | rest_ratio 0.9758 | repeat_ratio 0.9101
2023-02-26 12:20:27.192: [Training]| Epochs  12 | Batch  5000  | ms/batch 0.03 | Loss 9.8893 | p1_Loss 0.5228 | p2_Loss 0.6874 | p3_Loss 2.9816 | p4_Loss 5.6809 | 
2023-02-26 12:20:27.193: real_rest_sum 854.8318 | real_rest_sum_int 871.0000 | all_sum 10003.0000 | rest_ratio 0.9814 | repeat_ratio 0.8877
2023-02-26 12:20:32.767: batch_num: 5179
2023-02-26 12:20:32.768: [Training]| Epochs  12 | loss_all  10.5122 | p1_all  0.5384 | p2_all  0.6880 | p3_all  3.4315 | p4_all  5.8300 | real_rest_ratio 0.0781 | repeat_ratio 0.9021 |
2023-02-26 12:20:48.767: 1
2023-02-26 12:20:48.768: valid_real_ratio_avg 0.1024 valid_neg_ratio_avg 0.1627 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 12:20:48.768: [Validation] neg_sample TOP5 [Test]| Epochs  12 | Hit ratio 0.9026 | recall 0.3465 |  precision 0.5477 | f1  0.3763 | ndcg  0.6193 | mrr  0.7845 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 12:20:48.768: [Validation] p_n_score_differences_avg 0.4179 
2023-02-26 12:20:48.768: ##############################################
2023-02-26 12:23:13.627: 1
2023-02-26 12:23:13.634: Epochs  12 topk   5  basket_length <4  num 714  Hit ratio 0.8123 | recall 0.5133 |  precision 0.3409 | f1  0.3731 | ndcg  0.5491 | mrr  0.6937 
2023-02-26 12:23:13.635: Epochs  12 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8511 | recall 0.4208 |  precision 0.4326 | f1  0.3923 | ndcg  0.5455 | mrr  0.7364 
2023-02-26 12:23:13.638: Epochs  12 topk   5  basket_length >6  num 4295  Hit ratio 0.9471 | recall 0.3266 |  precision 0.6261 | f1  0.3954 | ndcg  0.6671 | mrr  0.8269 
2023-02-26 12:23:13.638: ...............................................
2023-02-26 12:23:13.638: test_real_ratio_avg 0.1091 test_neg_ratio_avg 0.1598 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 12:23:13.638: neg_sample TOP5 [Test]| Epochs  12 | Hit ratio 0.9132 | recall 0.3662 |  precision 0.5561 | f1  0.3922 | ndcg  0.6302 | mrr  0.7942 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 12:23:13.638: [Test] p_n_score_differences_avg 0.4442 
2023-02-26 12:23:13.638: ##############################################
2023-02-26 12:23:13.751: Save model as ./runs/model_1_Instacart_t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5.pt
2023-02-26 12:23:13.751: Epochs  12 best_hit 0.9132 best_recall 0.3662 best_precision 0.5561 best_f1 0.3922 best_ndcg 0.6302  best_mrr 0.7942 
2023-02-26 12:23:13.751: Epochs  12 loss_all 10.5122 Hit ratio 0.9132 recall 0.3662 precision 0.5561 f1  0.3922 ndcg  0.6302 mrr  0.7942 avg_fake_length 5.0000
2023-02-26 12:23:13.753: G1_flag 1 pretrain 1 temp 10.0 train_epoch 0  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 12:23:13.992: [Training]| Epochs  13 | Batch     0  | ms/batch 0.00 | Loss 4.9323 | p1_Loss 0.5881 | p2_Loss 0.6869 | p3_Loss 3.6335 | p4_Loss 3.6335 | 
2023-02-26 12:23:13.992: real_rest_sum 775.4258 | real_rest_sum_int 1191.0000 | all_sum 9379.0000 | rest_ratio 0.6511 | repeat_ratio 0.8780
2023-02-26 12:23:30.851: [Training]| Epochs  13 | Batch   500  | ms/batch 0.03 | Loss 3.7670 | p1_Loss 0.5008 | p2_Loss 0.6882 | p3_Loss 2.5304 | p4_Loss 2.5304 | 
2023-02-26 12:23:30.851: real_rest_sum 979.9153 | real_rest_sum_int 1452.0000 | all_sum 19700.0000 | rest_ratio 0.6749 | repeat_ratio 0.9615
2023-02-26 12:23:46.651: [Training]| Epochs  13 | Batch  1000  | ms/batch 0.03 | Loss 4.9170 | p1_Loss 0.5464 | p2_Loss 0.6878 | p3_Loss 3.6391 | p4_Loss 3.6391 | 
2023-02-26 12:23:46.651: real_rest_sum 228.7850 | real_rest_sum_int 327.0000 | all_sum 4775.0000 | rest_ratio 0.6996 | repeat_ratio 0.9459
2023-02-26 12:24:02.436: [Training]| Epochs  13 | Batch  1500  | ms/batch 0.03 | Loss 3.8900 | p1_Loss 0.5113 | p2_Loss 0.6884 | p3_Loss 2.6170 | p4_Loss 2.6170 | 
2023-02-26 12:24:02.436: real_rest_sum 728.4199 | real_rest_sum_int 1012.0000 | all_sum 34282.0000 | rest_ratio 0.7198 | repeat_ratio 0.9336
2023-02-26 12:24:18.425: [Training]| Epochs  13 | Batch  2000  | ms/batch 0.03 | Loss 4.5411 | p1_Loss 0.5228 | p2_Loss 0.6893 | p3_Loss 3.2618 | p4_Loss 3.2618 | 
2023-02-26 12:24:18.425: real_rest_sum 637.0196 | real_rest_sum_int 919.0000 | all_sum 19918.0000 | rest_ratio 0.6932 | repeat_ratio 0.9689
2023-02-26 12:24:35.903: [Training]| Epochs  13 | Batch  2500  | ms/batch 0.03 | Loss 2.7533 | p1_Loss 0.4470 | p2_Loss 0.6906 | p3_Loss 1.5509 | p4_Loss 1.5509 | 
2023-02-26 12:24:35.903: real_rest_sum 1758.3823 | real_rest_sum_int 2416.0000 | all_sum 51803.0000 | rest_ratio 0.7278 | repeat_ratio 0.9730
2023-02-26 12:24:52.295: [Training]| Epochs  13 | Batch  3000  | ms/batch 0.03 | Loss 8.0122 | p1_Loss 0.6578 | p2_Loss 0.6929 | p3_Loss 6.5957 | p4_Loss 6.5957 | 
2023-02-26 12:24:52.295: real_rest_sum 54.2508 | real_rest_sum_int 77.0000 | all_sum 1809.0000 | rest_ratio 0.7046 | repeat_ratio 1.0000
2023-02-26 12:25:07.117: [Training]| Epochs  13 | Batch  3500  | ms/batch 0.03 | Loss 4.6888 | p1_Loss 0.5372 | p2_Loss 0.6890 | p3_Loss 3.3856 | p4_Loss 3.3856 | 
2023-02-26 12:25:07.117: real_rest_sum 235.1173 | real_rest_sum_int 302.0000 | all_sum 8379.0000 | rest_ratio 0.7785 | repeat_ratio 0.9561
2023-02-26 12:25:24.401: [Training]| Epochs  13 | Batch  4000  | ms/batch 0.04 | Loss 3.4763 | p1_Loss 0.4719 | p2_Loss 0.6872 | p3_Loss 2.2474 | p4_Loss 2.2474 | 
2023-02-26 12:25:24.401: real_rest_sum 638.5735 | real_rest_sum_int 812.0000 | all_sum 16794.0000 | rest_ratio 0.7864 | repeat_ratio 0.9606
2023-02-26 12:25:39.649: [Training]| Epochs  13 | Batch  4500  | ms/batch 0.03 | Loss 3.4028 | p1_Loss 0.4903 | p2_Loss 0.6877 | p3_Loss 2.1729 | p4_Loss 2.1729 | 
2023-02-26 12:25:39.650: real_rest_sum 918.4443 | real_rest_sum_int 1116.0000 | all_sum 19037.0000 | rest_ratio 0.8230 | repeat_ratio 0.9334
2023-02-26 12:25:55.769: [Training]| Epochs  13 | Batch  5000  | ms/batch 0.03 | Loss 3.5604 | p1_Loss 0.4882 | p2_Loss 0.6863 | p3_Loss 2.3594 | p4_Loss 2.3594 | 
2023-02-26 12:25:55.769: real_rest_sum 1191.9423 | real_rest_sum_int 1480.0000 | all_sum 17848.0000 | rest_ratio 0.8054 | repeat_ratio 0.9516
2023-02-26 12:26:01.995: batch_num: 5179
2023-02-26 12:26:01.995: [Training]| Epochs  13 | loss_all  4.6680 | p1_all  0.5322 | p2_all  0.6880 | p3_all  3.3953 | p4_all  3.3953 | real_rest_ratio 0.0571 | repeat_ratio 0.9395 |
2023-02-26 12:26:17.905: 1
2023-02-26 12:26:17.906: valid_real_ratio_avg 0.0900 valid_neg_ratio_avg 0.1295 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 12:26:17.906: [Validation] neg_sample TOP5 [Test]| Epochs  13 | Hit ratio 0.9026 | recall 0.3433 |  precision 0.5459 | f1  0.3745 | ndcg  0.6190 | mrr  0.7864 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 12:26:17.906: [Validation] p_n_score_differences_avg 0.4108 
2023-02-26 12:26:17.906: ##############################################
2023-02-26 12:26:17.908: G1_flag 1 pretrain 1 temp 10.0 train_epoch 1  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 12:26:18.102: [Training]| Epochs  14 | Batch     0  | ms/batch 0.00 | Loss 3.4053 | p1_Loss 0.4983 | p2_Loss 0.6901 | p3_Loss 2.1761 | p4_Loss 2.1761 | 
2023-02-26 12:26:18.102: real_rest_sum 2357.8884 | real_rest_sum_int 3640.0000 | all_sum 38630.0000 | rest_ratio 0.6478 | repeat_ratio 0.9735
2023-02-26 12:26:34.735: [Training]| Epochs  14 | Batch   500  | ms/batch 0.03 | Loss 3.9780 | p1_Loss 0.5031 | p2_Loss 0.6883 | p3_Loss 2.7268 | p4_Loss 2.7268 | 
2023-02-26 12:26:34.735: real_rest_sum 1087.8157 | real_rest_sum_int 1627.0000 | all_sum 30247.0000 | rest_ratio 0.6686 | repeat_ratio 0.9541
2023-02-26 12:26:50.455: [Training]| Epochs  14 | Batch  1000  | ms/batch 0.03 | Loss 4.0977 | p1_Loss 0.5082 | p2_Loss 0.6896 | p3_Loss 2.8303 | p4_Loss 2.8303 | 
2023-02-26 12:26:50.455: real_rest_sum 464.5527 | real_rest_sum_int 683.0000 | all_sum 16690.0000 | rest_ratio 0.6802 | repeat_ratio 0.9322
2023-02-26 12:27:07.753: [Training]| Epochs  14 | Batch  1500  | ms/batch 0.04 | Loss 4.6783 | p1_Loss 0.5167 | p2_Loss 0.6857 | p3_Loss 3.4145 | p4_Loss 3.4145 | 
2023-02-26 12:27:07.754: real_rest_sum 676.9893 | real_rest_sum_int 957.0000 | all_sum 20047.0000 | rest_ratio 0.7074 | repeat_ratio 0.9624
2023-02-26 12:27:23.680: [Training]| Epochs  14 | Batch  2000  | ms/batch 0.03 | Loss 3.7544 | p1_Loss 0.4766 | p2_Loss 0.6870 | p3_Loss 2.5156 | p4_Loss 2.5156 | 
2023-02-26 12:27:23.680: real_rest_sum 581.2281 | real_rest_sum_int 791.0000 | all_sum 27912.0000 | rest_ratio 0.7348 | repeat_ratio 0.9646
2023-02-26 12:27:40.793: [Training]| Epochs  14 | Batch  2500  | ms/batch 0.03 | Loss 6.4029 | p1_Loss 0.5804 | p2_Loss 0.6915 | p3_Loss 5.0680 | p4_Loss 5.0680 | 
2023-02-26 12:27:40.794: real_rest_sum 96.5168 | real_rest_sum_int 123.0000 | all_sum 2764.0000 | rest_ratio 0.7847 | repeat_ratio 0.9455
2023-02-26 12:27:56.983: [Training]| Epochs  14 | Batch  3000  | ms/batch 0.03 | Loss 3.1740 | p1_Loss 0.4579 | p2_Loss 0.6862 | p3_Loss 1.9711 | p4_Loss 1.9711 | 
2023-02-26 12:27:56.983: real_rest_sum 1436.0898 | real_rest_sum_int 1994.0000 | all_sum 43070.0000 | rest_ratio 0.7202 | repeat_ratio 0.9795
2023-02-26 12:28:13.531: [Training]| Epochs  14 | Batch  3500  | ms/batch 0.03 | Loss 4.7967 | p1_Loss 0.5248 | p2_Loss 0.6881 | p3_Loss 3.5316 | p4_Loss 3.5316 | 
2023-02-26 12:28:13.531: real_rest_sum 371.6640 | real_rest_sum_int 478.0000 | all_sum 9181.0000 | rest_ratio 0.7775 | repeat_ratio 0.9729
2023-02-26 12:28:29.582: [Training]| Epochs  14 | Batch  4000  | ms/batch 0.03 | Loss 4.5197 | p1_Loss 0.5289 | p2_Loss 0.6824 | p3_Loss 3.2850 | p4_Loss 3.2850 | 
2023-02-26 12:28:29.583: real_rest_sum 362.2236 | real_rest_sum_int 466.0000 | all_sum 5721.0000 | rest_ratio 0.7773 | repeat_ratio 0.9206
2023-02-26 12:28:45.377: [Training]| Epochs  14 | Batch  4500  | ms/batch 0.03 | Loss 4.3366 | p1_Loss 0.5262 | p2_Loss 0.6861 | p3_Loss 3.0888 | p4_Loss 3.0888 | 
2023-02-26 12:28:45.377: real_rest_sum 768.9677 | real_rest_sum_int 954.0000 | all_sum 13253.0000 | rest_ratio 0.8060 | repeat_ratio 0.9688
2023-02-26 12:29:00.116: [Training]| Epochs  14 | Batch  5000  | ms/batch 0.03 | Loss 6.7130 | p1_Loss 0.6110 | p2_Loss 0.6926 | p3_Loss 5.3389 | p4_Loss 5.3389 | 
2023-02-26 12:29:00.116: real_rest_sum 76.2840 | real_rest_sum_int 93.0000 | all_sum 1728.0000 | rest_ratio 0.8203 | repeat_ratio 0.9245
2023-02-26 12:29:05.971: batch_num: 5179
2023-02-26 12:29:05.971: [Training]| Epochs  14 | loss_all  4.6646 | p1_all  0.5306 | p2_all  0.6879 | p3_all  3.3923 | p4_all  3.3923 | real_rest_ratio 0.0532 | repeat_ratio 0.9574 |
2023-02-26 12:29:21.787: 1
2023-02-26 12:29:21.788: valid_real_ratio_avg 0.0810 valid_neg_ratio_avg 0.1071 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 12:29:21.788: [Validation] neg_sample TOP5 [Test]| Epochs  14 | Hit ratio 0.9142 | recall 0.3460 |  precision 0.5416 | f1  0.3731 | ndcg  0.6115 | mrr  0.7755 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 12:29:21.788: [Validation] p_n_score_differences_avg 0.4140 
2023-02-26 12:29:21.788: ##############################################
2023-02-26 12:29:21.790: G1_flag 1 pretrain 1 temp 10.0 train_epoch 2  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 12:29:21.995: [Training]| Epochs  15 | Batch     0  | ms/batch 0.00 | Loss 5.0437 | p1_Loss 0.5486 | p2_Loss 0.6866 | p3_Loss 3.7718 | p4_Loss 3.7718 | 
2023-02-26 12:29:21.995: real_rest_sum 385.7201 | real_rest_sum_int 574.0000 | all_sum 7684.0000 | rest_ratio 0.6720 | repeat_ratio 0.9535
2023-02-26 12:29:38.616: [Training]| Epochs  15 | Batch   500  | ms/batch 0.03 | Loss 2.9414 | p1_Loss 0.4530 | p2_Loss 0.6878 | p3_Loss 1.7285 | p4_Loss 1.7285 | 
2023-02-26 12:29:38.616: real_rest_sum 1043.7445 | real_rest_sum_int 1526.0000 | all_sum 46818.0000 | rest_ratio 0.6840 | repeat_ratio 0.9577
2023-02-26 12:29:55.742: [Training]| Epochs  15 | Batch  1000  | ms/batch 0.03 | Loss 2.5491 | p1_Loss 0.4277 | p2_Loss 0.6833 | p3_Loss 1.3874 | p4_Loss 1.3874 | 
2023-02-26 12:29:55.742: real_rest_sum 844.4457 | real_rest_sum_int 1175.0000 | all_sum 20149.0000 | rest_ratio 0.7187 | repeat_ratio 0.9492
2023-02-26 12:30:12.114: [Training]| Epochs  15 | Batch  1500  | ms/batch 0.03 | Loss 5.6838 | p1_Loss 0.5623 | p2_Loss 0.6885 | p3_Loss 4.3659 | p4_Loss 4.3659 | 
2023-02-26 12:30:12.115: real_rest_sum 125.6285 | real_rest_sum_int 178.0000 | all_sum 5979.0000 | rest_ratio 0.7058 | repeat_ratio 0.9624
2023-02-26 12:30:27.233: [Training]| Epochs  15 | Batch  2000  | ms/batch 0.03 | Loss 6.5433 | p1_Loss 0.5986 | p2_Loss 0.6877 | p3_Loss 5.2116 | p4_Loss 5.2116 | 
2023-02-26 12:30:27.233: real_rest_sum 126.9963 | real_rest_sum_int 181.0000 | all_sum 3228.0000 | rest_ratio 0.7016 | repeat_ratio 0.9811
2023-02-26 12:30:42.513: [Training]| Epochs  15 | Batch  2500  | ms/batch 0.03 | Loss 4.7898 | p1_Loss 0.5325 | p2_Loss 0.6889 | p3_Loss 3.4931 | p4_Loss 3.4931 | 
2023-02-26 12:30:42.513: real_rest_sum 275.5366 | real_rest_sum_int 372.0000 | all_sum 9933.0000 | rest_ratio 0.7407 | repeat_ratio 0.9606
2023-02-26 12:30:58.009: [Training]| Epochs  15 | Batch  3000  | ms/batch 0.03 | Loss 6.3375 | p1_Loss 0.5696 | p2_Loss 0.6885 | p3_Loss 5.0191 | p4_Loss 5.0191 | 
2023-02-26 12:30:58.009: real_rest_sum 194.5081 | real_rest_sum_int 269.0000 | all_sum 5935.0000 | rest_ratio 0.7231 | repeat_ratio 0.9508
2023-02-26 12:31:12.665: [Training]| Epochs  15 | Batch  3500  | ms/batch 0.03 | Loss 7.3574 | p1_Loss 0.6470 | p2_Loss 0.6927 | p3_Loss 5.9821 | p4_Loss 5.9821 | 
2023-02-26 12:31:12.666: real_rest_sum 130.1747 | real_rest_sum_int 176.0000 | all_sum 2204.0000 | rest_ratio 0.7396 | repeat_ratio 0.9773
2023-02-26 12:31:30.159: [Training]| Epochs  15 | Batch  4000  | ms/batch 0.04 | Loss 3.9086 | p1_Loss 0.4835 | p2_Loss 0.6870 | p3_Loss 2.6902 | p4_Loss 2.6902 | 
2023-02-26 12:31:30.159: real_rest_sum 949.4639 | real_rest_sum_int 1247.0000 | all_sum 20920.0000 | rest_ratio 0.7614 | repeat_ratio 0.9884
2023-02-26 12:31:46.560: [Training]| Epochs  15 | Batch  4500  | ms/batch 0.03 | Loss 3.3919 | p1_Loss 0.4771 | p2_Loss 0.6894 | p3_Loss 2.1448 | p4_Loss 2.1448 | 
2023-02-26 12:31:46.560: real_rest_sum 669.8207 | real_rest_sum_int 821.0000 | all_sum 16565.0000 | rest_ratio 0.8159 | repeat_ratio 0.9798
2023-02-26 12:32:03.700: [Training]| Epochs  15 | Batch  5000  | ms/batch 0.04 | Loss 4.1364 | p1_Loss 0.5258 | p2_Loss 0.6890 | p3_Loss 2.8912 | p4_Loss 2.8912 | 
2023-02-26 12:32:03.700: real_rest_sum 1390.1960 | real_rest_sum_int 1786.0000 | all_sum 18943.0000 | rest_ratio 0.7784 | repeat_ratio 0.9887
2023-02-26 12:32:09.278: batch_num: 5179
2023-02-26 12:32:09.278: [Training]| Epochs  15 | loss_all  4.6868 | p1_all  0.5301 | p2_all  0.6879 | p3_all  3.4133 | p4_all  3.4133 | real_rest_ratio 0.0526 | repeat_ratio 0.9651 |
2023-02-26 12:32:25.111: 1
2023-02-26 12:32:25.112: valid_real_ratio_avg 0.0784 valid_neg_ratio_avg 0.1038 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 12:32:25.112: [Validation] neg_sample TOP5 [Test]| Epochs  15 | Hit ratio 0.9055 | recall 0.3458 |  precision 0.5532 | f1  0.3775 | ndcg  0.6208 | mrr  0.7809 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 12:32:25.112: [Validation] p_n_score_differences_avg 0.4205 
2023-02-26 12:32:25.112: ##############################################
2023-02-26 12:34:50.293: 1
2023-02-26 12:34:50.300: Epochs  15 topk   5  basket_length <4  num 714  Hit ratio 0.8179 | recall 0.5093 |  precision 0.3429 | f1  0.3732 | ndcg  0.5487 | mrr  0.7019 
2023-02-26 12:34:50.301: Epochs  15 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8537 | recall 0.4209 |  precision 0.4353 | f1  0.3941 | ndcg  0.5413 | mrr  0.7274 
2023-02-26 12:34:50.304: Epochs  15 topk   5  basket_length >6  num 4295  Hit ratio 0.9495 | recall 0.3290 |  precision 0.6292 | f1  0.3979 | ndcg  0.6696 | mrr  0.8259 
2023-02-26 12:34:50.304: ...............................................
2023-02-26 12:34:50.304: test_real_ratio_avg 0.0844 test_neg_ratio_avg 0.1009 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 12:34:50.304: neg_sample TOP5 [Test]| Epochs  15 | Hit ratio 0.9159 | recall 0.3674 |  precision 0.5591 | f1  0.3943 | ndcg  0.6310 | mrr  0.7927 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 12:34:50.304: [Test] p_n_score_differences_avg 0.4474 
2023-02-26 12:34:50.304: ##############################################
2023-02-26 12:34:50.405: Save model as ./runs/model_1_Instacart_t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5.pt
2023-02-26 12:34:50.405: Epochs  15 best_hit 0.9159 best_recall 0.3674 best_precision 0.5591 best_f1 0.3943 best_ndcg 0.6310  best_mrr 0.7942 
2023-02-26 12:34:50.405: Epochs  15 loss_all 4.6868 Hit ratio 0.9159 recall 0.3674 precision 0.5591 f1  0.3943 ndcg  0.6310 mrr  0.7927 avg_fake_length 5.0000
2023-02-26 12:34:50.406: G1_flag 1 pretrain 1 temp 10.0 train_epoch 3  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 12:34:50.609: [Training]| Epochs  16 | Batch     0  | ms/batch 0.00 | Loss 3.6085 | p1_Loss 0.4991 | p2_Loss 0.6887 | p3_Loss 2.3752 | p4_Loss 2.3752 | 
2023-02-26 12:34:50.610: real_rest_sum 2153.6990 | real_rest_sum_int 3336.0000 | all_sum 38630.0000 | rest_ratio 0.6456 | repeat_ratio 0.9674
2023-02-26 12:35:06.091: [Training]| Epochs  16 | Batch   500  | ms/batch 0.03 | Loss 3.0190 | p1_Loss 0.4544 | p2_Loss 0.6877 | p3_Loss 1.8004 | p4_Loss 1.8004 | 
2023-02-26 12:35:06.091: real_rest_sum 653.3938 | real_rest_sum_int 930.0000 | all_sum 31446.0000 | rest_ratio 0.7026 | repeat_ratio 0.8941
2023-02-26 12:35:20.995: [Training]| Epochs  16 | Batch  1000  | ms/batch 0.03 | Loss 6.9272 | p1_Loss 0.6108 | p2_Loss 0.6922 | p3_Loss 5.5496 | p4_Loss 5.5496 | 
2023-02-26 12:35:20.995: real_rest_sum 40.7316 | real_rest_sum_int 57.0000 | all_sum 1843.0000 | rest_ratio 0.7146 | repeat_ratio 0.9302
2023-02-26 12:35:37.346: [Training]| Epochs  16 | Batch  1500  | ms/batch 0.03 | Loss 4.8221 | p1_Loss 0.5316 | p2_Loss 0.6867 | p3_Loss 3.5362 | p4_Loss 3.5362 | 
2023-02-26 12:35:37.346: real_rest_sum 299.2303 | real_rest_sum_int 413.0000 | all_sum 11295.0000 | rest_ratio 0.7245 | repeat_ratio 0.9483
2023-02-26 12:35:52.918: [Training]| Epochs  16 | Batch  2000  | ms/batch 0.03 | Loss 5.8932 | p1_Loss 0.5740 | p2_Loss 0.6858 | p3_Loss 4.5800 | p4_Loss 4.5800 | 
2023-02-26 12:35:52.918: real_rest_sum 153.5650 | real_rest_sum_int 207.0000 | all_sum 4927.0000 | rest_ratio 0.7419 | repeat_ratio 0.9760
2023-02-26 12:36:09.315: [Training]| Epochs  16 | Batch  2500  | ms/batch 0.03 | Loss 4.0267 | p1_Loss 0.5067 | p2_Loss 0.6874 | p3_Loss 2.7644 | p4_Loss 2.7644 | 
2023-02-26 12:36:09.315: real_rest_sum 1175.5154 | real_rest_sum_int 1628.0000 | all_sum 37601.0000 | rest_ratio 0.7221 | repeat_ratio 0.9945
2023-02-26 12:36:26.101: [Training]| Epochs  16 | Batch  3000  | ms/batch 0.03 | Loss 3.7364 | p1_Loss 0.4926 | p2_Loss 0.6881 | p3_Loss 2.4976 | p4_Loss 2.4976 | 
2023-02-26 12:36:26.101: real_rest_sum 630.8982 | real_rest_sum_int 840.0000 | all_sum 20165.0000 | rest_ratio 0.7511 | repeat_ratio 0.9812
2023-02-26 12:36:43.470: [Training]| Epochs  16 | Batch  3500  | ms/batch 0.04 | Loss 6.1208 | p1_Loss 0.5936 | p2_Loss 0.6895 | p3_Loss 4.7892 | p4_Loss 4.7892 | 
2023-02-26 12:36:43.470: real_rest_sum 158.9139 | real_rest_sum_int 208.0000 | all_sum 4125.0000 | rest_ratio 0.7640 | repeat_ratio 0.9917
2023-02-26 12:36:58.979: [Training]| Epochs  16 | Batch  4000  | ms/batch 0.03 | Loss 5.2613 | p1_Loss 0.5549 | p2_Loss 0.6893 | p3_Loss 3.9793 | p4_Loss 3.9793 | 
2023-02-26 12:36:58.979: real_rest_sum 309.1742 | real_rest_sum_int 406.0000 | all_sum 6047.0000 | rest_ratio 0.7615 | repeat_ratio 0.9951
2023-02-26 12:37:14.917: [Training]| Epochs  16 | Batch  4500  | ms/batch 0.03 | Loss 3.7584 | p1_Loss 0.4918 | p2_Loss 0.6859 | p3_Loss 2.5458 | p4_Loss 2.5458 | 
2023-02-26 12:37:14.917: real_rest_sum 749.2048 | real_rest_sum_int 933.0000 | all_sum 15665.0000 | rest_ratio 0.8030 | repeat_ratio 0.9799
2023-02-26 12:37:32.083: [Training]| Epochs  16 | Batch  5000  | ms/batch 0.04 | Loss 2.9695 | p1_Loss 0.4678 | p2_Loss 0.6860 | p3_Loss 1.7800 | p4_Loss 1.7800 | 
2023-02-26 12:37:32.083: real_rest_sum 1270.1450 | real_rest_sum_int 1597.0000 | all_sum 21517.0000 | rest_ratio 0.7953 | repeat_ratio 0.9853
2023-02-26 12:37:38.295: batch_num: 5179
2023-02-26 12:37:38.295: [Training]| Epochs  16 | loss_all  4.7041 | p1_all  0.5311 | p2_all  0.6880 | p3_all  3.4286 | p4_all  3.4286 | real_rest_ratio 0.0516 | repeat_ratio 0.9646 |
2023-02-26 12:37:54.184: 1
2023-02-26 12:37:54.185: valid_real_ratio_avg 0.0840 valid_neg_ratio_avg 0.1140 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 12:37:54.185: [Validation] neg_sample TOP5 [Test]| Epochs  16 | Hit ratio 0.9113 | recall 0.3430 |  precision 0.5459 | f1  0.3726 | ndcg  0.6176 | mrr  0.7811 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 12:37:54.185: [Validation] p_n_score_differences_avg 0.4116 
2023-02-26 12:37:54.185: ##############################################
2023-02-26 12:40:18.404: 1
2023-02-26 12:40:18.412: Epochs  16 topk   5  basket_length <4  num 714  Hit ratio 0.8081 | recall 0.5038 |  precision 0.3381 | f1  0.3689 | ndcg  0.5440 | mrr  0.6970 
2023-02-26 12:40:18.413: Epochs  16 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8495 | recall 0.4180 |  precision 0.4308 | f1  0.3905 | ndcg  0.5407 | mrr  0.7292 
2023-02-26 12:40:18.416: Epochs  16 topk   5  basket_length >6  num 4295  Hit ratio 0.9483 | recall 0.3267 |  precision 0.6258 | f1  0.3953 | ndcg  0.6662 | mrr  0.8227 
2023-02-26 12:40:18.416: ...............................................
2023-02-26 12:40:18.416: test_real_ratio_avg 0.0915 test_neg_ratio_avg 0.1118 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 12:40:18.416: neg_sample TOP5 [Test]| Epochs  16 | Hit ratio 0.9132 | recall 0.3646 |  precision 0.5553 | f1  0.3913 | ndcg  0.6281 | mrr  0.7903 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 12:40:18.416: [Test] p_n_score_differences_avg 0.4367 
2023-02-26 12:40:18.416: ##############################################
2023-02-26 12:40:18.418: Epochs  16 best_hit 0.9159 best_recall 0.3674 best_precision 0.5591 best_f1 0.3943 best_ndcg 0.6310  best_mrr 0.7942 
2023-02-26 12:40:18.418: Epochs  16 loss_all 4.7041 Hit ratio 0.9132 recall 0.3646 precision 0.5553 f1  0.3913 ndcg  0.6281 mrr  0.7903 avg_fake_length 5.0000
2023-02-26 12:40:18.419: G1_flag 1 pretrain 1 temp 10.0 train_epoch 4  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 12:40:18.643: [Training]| Epochs  17 | Batch     0  | ms/batch 0.00 | Loss 4.4440 | p1_Loss 0.5423 | p2_Loss 0.6868 | p3_Loss 3.2102 | p4_Loss 3.2102 | 
2023-02-26 12:40:18.643: real_rest_sum 857.8016 | real_rest_sum_int 1315.0000 | all_sum 10770.0000 | rest_ratio 0.6523 | repeat_ratio 0.9756
2023-02-26 12:40:35.505: [Training]| Epochs  17 | Batch   500  | ms/batch 0.03 | Loss 4.1632 | p1_Loss 0.5015 | p2_Loss 0.6894 | p3_Loss 2.9015 | p4_Loss 2.9015 | 
2023-02-26 12:40:35.506: real_rest_sum 537.5032 | real_rest_sum_int 798.0000 | all_sum 19132.0000 | rest_ratio 0.6736 | repeat_ratio 0.9564
2023-02-26 12:40:51.653: [Training]| Epochs  17 | Batch  1000  | ms/batch 0.03 | Loss 6.5877 | p1_Loss 0.5885 | p2_Loss 0.6878 | p3_Loss 5.2382 | p4_Loss 5.2382 | 
2023-02-26 12:40:51.653: real_rest_sum 99.2990 | real_rest_sum_int 139.0000 | all_sum 4364.0000 | rest_ratio 0.7144 | repeat_ratio 0.9384
2023-02-26 12:41:07.343: [Training]| Epochs  17 | Batch  1500  | ms/batch 0.03 | Loss 5.0965 | p1_Loss 0.5327 | p2_Loss 0.6863 | p3_Loss 3.8043 | p4_Loss 3.8043 | 
2023-02-26 12:41:07.343: real_rest_sum 236.6537 | real_rest_sum_int 332.0000 | all_sum 11436.0000 | rest_ratio 0.7128 | repeat_ratio 0.9537
2023-02-26 12:41:24.705: [Training]| Epochs  17 | Batch  2000  | ms/batch 0.04 | Loss 3.3776 | p1_Loss 0.4699 | p2_Loss 0.6894 | p3_Loss 2.1449 | p4_Loss 2.1449 | 
2023-02-26 12:41:24.705: real_rest_sum 516.2452 | real_rest_sum_int 710.0000 | all_sum 22044.0000 | rest_ratio 0.7271 | repeat_ratio 0.9679
2023-02-26 12:41:39.823: [Training]| Epochs  17 | Batch  2500  | ms/batch 0.03 | Loss 4.6848 | p1_Loss 0.5093 | p2_Loss 0.6891 | p3_Loss 3.4120 | p4_Loss 3.4120 | 
2023-02-26 12:41:39.823: real_rest_sum 282.0247 | real_rest_sum_int 376.0000 | all_sum 10688.0000 | rest_ratio 0.7501 | repeat_ratio 0.9699
2023-02-26 12:41:55.765: [Training]| Epochs  17 | Batch  3000  | ms/batch 0.03 | Loss 4.9482 | p1_Loss 0.5384 | p2_Loss 0.6889 | p3_Loss 3.6639 | p4_Loss 3.6639 | 
2023-02-26 12:41:55.765: real_rest_sum 261.2027 | real_rest_sum_int 348.0000 | all_sum 7538.0000 | rest_ratio 0.7506 | repeat_ratio 0.9883
2023-02-26 12:42:11.123: [Training]| Epochs  17 | Batch  3500  | ms/batch 0.03 | Loss 2.8248 | p1_Loss 0.4579 | p2_Loss 0.6821 | p3_Loss 1.6433 | p4_Loss 1.6433 | 
2023-02-26 12:42:11.123: real_rest_sum 996.0728 | real_rest_sum_int 1258.0000 | all_sum 19965.0000 | rest_ratio 0.7918 | repeat_ratio 0.9864
2023-02-26 12:42:25.807: [Training]| Epochs  17 | Batch  4000  | ms/batch 0.03 | Loss 3.2814 | p1_Loss 0.4805 | p2_Loss 0.6847 | p3_Loss 2.0577 | p4_Loss 2.0577 | 
2023-02-26 12:42:25.807: real_rest_sum 1330.7783 | real_rest_sum_int 1735.0000 | all_sum 35998.0000 | rest_ratio 0.7670 | repeat_ratio 0.9662
2023-02-26 12:42:43.276: [Training]| Epochs  17 | Batch  4500  | ms/batch 0.04 | Loss 3.2956 | p1_Loss 0.4768 | p2_Loss 0.6886 | p3_Loss 2.0663 | p4_Loss 2.0663 | 
2023-02-26 12:42:43.276: real_rest_sum 1895.8474 | real_rest_sum_int 2406.0000 | all_sum 47337.0000 | rest_ratio 0.7880 | repeat_ratio 0.9761
2023-02-26 12:43:00.297: [Training]| Epochs  17 | Batch  5000  | ms/batch 0.03 | Loss 3.6699 | p1_Loss 0.5104 | p2_Loss 0.6861 | p3_Loss 2.4292 | p4_Loss 2.4292 | 
2023-02-26 12:43:00.297: real_rest_sum 1039.6437 | real_rest_sum_int 1331.0000 | all_sum 25972.0000 | rest_ratio 0.7811 | repeat_ratio 0.9537
2023-02-26 12:43:06.844: batch_num: 5179
2023-02-26 12:43:06.844: [Training]| Epochs  17 | loss_all  4.7057 | p1_all  0.5304 | p2_all  0.6880 | p3_all  3.4313 | p4_all  3.4313 | real_rest_ratio 0.0527 | repeat_ratio 0.9693 |
2023-02-26 12:43:22.804: 1
2023-02-26 12:43:22.805: valid_real_ratio_avg 0.0800 valid_neg_ratio_avg 0.1092 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 12:43:22.805: [Validation] neg_sample TOP5 [Test]| Epochs  17 | Hit ratio 0.9012 | recall 0.3413 |  precision 0.5433 | f1  0.3715 | ndcg  0.6168 | mrr  0.7871 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 12:43:22.805: [Validation] p_n_score_differences_avg 0.4149 
2023-02-26 12:43:22.805: ##############################################
2023-02-26 12:45:47.466: 1
2023-02-26 12:45:47.474: Epochs  17 topk   5  basket_length <4  num 714  Hit ratio 0.8123 | recall 0.5161 |  precision 0.3448 | f1  0.3764 | ndcg  0.5495 | mrr  0.6959 
2023-02-26 12:45:47.474: Epochs  17 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8478 | recall 0.4193 |  precision 0.4326 | f1  0.3918 | ndcg  0.5446 | mrr  0.7352 
2023-02-26 12:45:47.477: Epochs  17 topk   5  basket_length >6  num 4295  Hit ratio 0.9467 | recall 0.3265 |  precision 0.6276 | f1  0.3958 | ndcg  0.6681 | mrr  0.8255 
2023-02-26 12:45:47.477: ...............................................
2023-02-26 12:45:47.478: test_real_ratio_avg 0.0870 test_neg_ratio_avg 0.1064 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 12:45:47.478: neg_sample TOP5 [Test]| Epochs  17 | Hit ratio 0.9122 | recall 0.3662 |  precision 0.5576 | f1  0.3928 | ndcg  0.6308 | mrr  0.7932 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 12:45:47.478: [Test] p_n_score_differences_avg 0.4429 
2023-02-26 12:45:47.478: ##############################################
2023-02-26 12:45:47.479: Epochs  17 best_hit 0.9159 best_recall 0.3674 best_precision 0.5591 best_f1 0.3943 best_ndcg 0.6310  best_mrr 0.7942 
2023-02-26 12:45:47.479: Epochs  17 loss_all 4.7057 Hit ratio 0.9122 recall 0.3662 precision 0.5576 f1  0.3928 ndcg  0.6308 mrr  0.7932 avg_fake_length 5.0000
2023-02-26 12:45:47.481: G1_flag 0 pretrain 1 temp 10.0 train_epoch 0  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 12:45:47.690: [Training]| Epochs  18 | Batch     0  | ms/batch 0.00 | Loss 10.7416 | p1_Loss 0.5545 | p2_Loss 0.6873 | p3_Loss 3.5460 | p4_Loss 5.9538 | 
2023-02-26 12:45:47.690: real_rest_sum 960.1025 | real_rest_sum_int 984.0000 | all_sum 8991.0000 | rest_ratio 0.9757 | repeat_ratio 0.9759
2023-02-26 12:46:05.183: [Training]| Epochs  18 | Batch   500  | ms/batch 0.04 | Loss 10.3693 | p1_Loss 0.5215 | p2_Loss 0.6902 | p3_Loss 3.1156 | p4_Loss 5.9694 | 
2023-02-26 12:46:05.184: real_rest_sum 1234.6716 | real_rest_sum_int 1274.0000 | all_sum 20823.0000 | rest_ratio 0.9691 | repeat_ratio 0.9697
2023-02-26 12:46:20.277: [Training]| Epochs  18 | Batch  1000  | ms/batch 0.03 | Loss 11.3706 | p1_Loss 0.5418 | p2_Loss 0.6894 | p3_Loss 3.7901 | p4_Loss 6.3103 | 
2023-02-26 12:46:20.277: real_rest_sum 640.7382 | real_rest_sum_int 659.0000 | all_sum 10202.0000 | rest_ratio 0.9723 | repeat_ratio 0.9895
2023-02-26 12:46:37.296: [Training]| Epochs  18 | Batch  1500  | ms/batch 0.03 | Loss 9.7922 | p1_Loss 0.5170 | p2_Loss 0.6890 | p3_Loss 2.8303 | p4_Loss 5.6950 | 
2023-02-26 12:46:37.297: real_rest_sum 668.7780 | real_rest_sum_int 689.0000 | all_sum 10891.0000 | rest_ratio 0.9707 | repeat_ratio 0.9784
2023-02-26 12:46:54.097: [Training]| Epochs  18 | Batch  2000  | ms/batch 0.03 | Loss 9.4699 | p1_Loss 0.5186 | p2_Loss 0.6869 | p3_Loss 2.8170 | p4_Loss 5.3989 | 
2023-02-26 12:46:54.097: real_rest_sum 1131.9482 | real_rest_sum_int 1163.0000 | all_sum 18828.0000 | rest_ratio 0.9733 | repeat_ratio 0.9718
2023-02-26 12:47:09.768: [Training]| Epochs  18 | Batch  2500  | ms/batch 0.03 | Loss 9.8412 | p1_Loss 0.5011 | p2_Loss 0.6884 | p3_Loss 2.6369 | p4_Loss 5.9772 | 
2023-02-26 12:47:09.768: real_rest_sum 2860.3782 | real_rest_sum_int 2954.0000 | all_sum 41394.0000 | rest_ratio 0.9683 | repeat_ratio 0.9738
2023-02-26 12:47:25.998: [Training]| Epochs  18 | Batch  3000  | ms/batch 0.03 | Loss 9.7772 | p1_Loss 0.5106 | p2_Loss 0.6863 | p3_Loss 2.6138 | p4_Loss 5.9269 | 
2023-02-26 12:47:25.998: real_rest_sum 1165.7195 | real_rest_sum_int 1202.0000 | all_sum 19264.0000 | rest_ratio 0.9698 | repeat_ratio 0.9770
2023-02-26 12:47:44.423: [Training]| Epochs  18 | Batch  3500  | ms/batch 0.04 | Loss 11.1337 | p1_Loss 0.5719 | p2_Loss 0.6878 | p3_Loss 3.8176 | p4_Loss 6.0564 | 
2023-02-26 12:47:44.423: real_rest_sum 1163.4709 | real_rest_sum_int 1196.0000 | all_sum 8770.0000 | rest_ratio 0.9728 | repeat_ratio 0.9940
2023-02-26 12:48:01.958: [Training]| Epochs  18 | Batch  4000  | ms/batch 0.04 | Loss 9.7884 | p1_Loss 0.5147 | p2_Loss 0.6916 | p3_Loss 2.5693 | p4_Loss 5.9560 | 
2023-02-26 12:48:01.958: real_rest_sum 1774.4153 | real_rest_sum_int 1831.0000 | all_sum 29094.0000 | rest_ratio 0.9691 | repeat_ratio 0.9781
2023-02-26 12:48:18.903: [Training]| Epochs  18 | Batch  4500  | ms/batch 0.03 | Loss 9.6572 | p1_Loss 0.5159 | p2_Loss 0.6899 | p3_Loss 2.6975 | p4_Loss 5.7474 | 
2023-02-26 12:48:18.903: real_rest_sum 1330.5334 | real_rest_sum_int 1375.0000 | all_sum 18982.0000 | rest_ratio 0.9677 | repeat_ratio 0.9889
2023-02-26 12:48:35.086: [Training]| Epochs  18 | Batch  5000  | ms/batch 0.03 | Loss 12.7334 | p1_Loss 0.6064 | p2_Loss 0.6882 | p3_Loss 5.2541 | p4_Loss 6.1808 | 
2023-02-26 12:48:35.086: real_rest_sum 160.6648 | real_rest_sum_int 163.0000 | all_sum 2080.0000 | rest_ratio 0.9857 | repeat_ratio 0.9778
2023-02-26 12:48:41.147: batch_num: 5179
2023-02-26 12:48:41.148: [Training]| Epochs  18 | loss_all  10.3921 | p1_all  0.5332 | p2_all  0.6877 | p3_all  3.3287 | p4_all  5.8112 | real_rest_ratio 0.0721 | repeat_ratio 0.9704 |
2023-02-26 12:48:57.255: 1
2023-02-26 12:48:57.256: valid_real_ratio_avg 0.0883 valid_neg_ratio_avg 0.1291 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 12:48:57.256: [Validation] neg_sample TOP5 [Test]| Epochs  18 | Hit ratio 0.9070 | recall 0.3410 |  precision 0.5422 | f1  0.3715 | ndcg  0.6129 | mrr  0.7782 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 12:48:57.256: [Validation] p_n_score_differences_avg 0.4208 
2023-02-26 12:48:57.256: ##############################################
2023-02-26 12:51:22.216: 1
2023-02-26 12:51:22.223: Epochs  18 topk   5  basket_length <4  num 714  Hit ratio 0.8081 | recall 0.5057 |  precision 0.3420 | f1  0.3718 | ndcg  0.5444 | mrr  0.6945 
2023-02-26 12:51:22.224: Epochs  18 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8545 | recall 0.4151 |  precision 0.4299 | f1  0.3888 | ndcg  0.5396 | mrr  0.7341 
2023-02-26 12:51:22.227: Epochs  18 topk   5  basket_length >6  num 4295  Hit ratio 0.9451 | recall 0.3293 |  precision 0.6313 | f1  0.3988 | ndcg  0.6718 | mrr  0.8261 
2023-02-26 12:51:22.227: ...............................................
2023-02-26 12:51:22.227: test_real_ratio_avg 0.0976 test_neg_ratio_avg 0.1259 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 12:51:22.227: neg_sample TOP5 [Test]| Epochs  18 | Hit ratio 0.9119 | recall 0.3661 |  precision 0.5593 | f1  0.3937 | ndcg  0.6318 | mrr  0.7933 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 12:51:22.227: [Test] p_n_score_differences_avg 0.4506 
2023-02-26 12:51:22.227: ##############################################
2023-02-26 12:51:22.337: Save model as ./runs/model_1_Instacart_t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5.pt
2023-02-26 12:51:22.337: Epochs  18 best_hit 0.9159 best_recall 0.3674 best_precision 0.5593 best_f1 0.3943 best_ndcg 0.6318  best_mrr 0.7942 
2023-02-26 12:51:22.337: Epochs  18 loss_all 10.3921 Hit ratio 0.9119 recall 0.3661 precision 0.5593 f1  0.3937 ndcg  0.6318 mrr  0.7933 avg_fake_length 5.0000
2023-02-26 12:51:22.338: G1_flag 0 pretrain 1 temp 10.0 train_epoch 1  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 12:51:22.569: [Training]| Epochs  19 | Batch     0  | ms/batch 0.00 | Loss 9.7250 | p1_Loss 0.5172 | p2_Loss 0.6892 | p3_Loss 2.8314 | p4_Loss 5.6715 | 
2023-02-26 12:51:22.570: real_rest_sum 1521.0509 | real_rest_sum_int 1568.0000 | all_sum 16341.0000 | rest_ratio 0.9701 | repeat_ratio 0.9726
2023-02-26 12:51:40.127: [Training]| Epochs  19 | Batch   500  | ms/batch 0.04 | Loss 9.6889 | p1_Loss 0.4949 | p2_Loss 0.6919 | p3_Loss 2.3019 | p4_Loss 6.1197 | 
2023-02-26 12:51:40.128: real_rest_sum 1856.3059 | real_rest_sum_int 1908.0000 | all_sum 37241.0000 | rest_ratio 0.9729 | repeat_ratio 0.9902
2023-02-26 12:51:57.062: [Training]| Epochs  19 | Batch  1000  | ms/batch 0.03 | Loss 12.7799 | p1_Loss 0.5988 | p2_Loss 0.6885 | p3_Loss 5.0219 | p4_Loss 6.4523 | 
2023-02-26 12:51:57.062: real_rest_sum 445.5169 | real_rest_sum_int 459.0000 | all_sum 5968.0000 | rest_ratio 0.9706 | repeat_ratio 0.9025
2023-02-26 12:52:12.419: [Training]| Epochs  19 | Batch  1500  | ms/batch 0.03 | Loss 9.5325 | p1_Loss 0.5014 | p2_Loss 0.6889 | p3_Loss 2.7439 | p4_Loss 5.5477 | 
2023-02-26 12:52:12.419: real_rest_sum 1079.5830 | real_rest_sum_int 1103.0000 | all_sum 21719.0000 | rest_ratio 0.9788 | repeat_ratio 0.9465
2023-02-26 12:52:30.535: [Training]| Epochs  19 | Batch  2000  | ms/batch 0.04 | Loss 9.8390 | p1_Loss 0.5299 | p2_Loss 0.6860 | p3_Loss 3.1274 | p4_Loss 5.4701 | 
2023-02-26 12:52:30.535: real_rest_sum 791.9449 | real_rest_sum_int 813.0000 | all_sum 9638.0000 | rest_ratio 0.9741 | repeat_ratio 0.9837
2023-02-26 12:52:46.969: [Training]| Epochs  19 | Batch  2500  | ms/batch 0.03 | Loss 11.8825 | p1_Loss 0.5723 | p2_Loss 0.6909 | p3_Loss 4.2833 | p4_Loss 6.2837 | 
2023-02-26 12:52:46.969: real_rest_sum 254.6112 | real_rest_sum_int 260.0000 | all_sum 3598.0000 | rest_ratio 0.9793 | repeat_ratio 0.9661
2023-02-26 12:53:04.706: [Training]| Epochs  19 | Batch  3000  | ms/batch 0.04 | Loss 10.4584 | p1_Loss 0.5519 | p2_Loss 0.6886 | p3_Loss 3.3524 | p4_Loss 5.8399 | 
2023-02-26 12:53:04.706: real_rest_sum 941.0052 | real_rest_sum_int 969.0000 | all_sum 12664.0000 | rest_ratio 0.9711 | repeat_ratio 0.9840
2023-02-26 12:53:22.799: [Training]| Epochs  19 | Batch  3500  | ms/batch 0.04 | Loss 8.5063 | p1_Loss 0.4614 | p2_Loss 0.6895 | p3_Loss 1.7241 | p4_Loss 5.5650 | 
2023-02-26 12:53:22.799: real_rest_sum 2161.4656 | real_rest_sum_int 2222.0000 | all_sum 33025.0000 | rest_ratio 0.9728 | repeat_ratio 0.9696
2023-02-26 12:53:38.791: [Training]| Epochs  19 | Batch  4000  | ms/batch 0.03 | Loss 10.4039 | p1_Loss 0.5412 | p2_Loss 0.6852 | p3_Loss 3.4098 | p4_Loss 5.7626 | 
2023-02-26 12:53:38.791: real_rest_sum 617.1053 | real_rest_sum_int 628.0000 | all_sum 8041.0000 | rest_ratio 0.9827 | repeat_ratio 0.9647
2023-02-26 12:53:55.322: [Training]| Epochs  19 | Batch  4500  | ms/batch 0.03 | Loss 10.6518 | p1_Loss 0.5298 | p2_Loss 0.6896 | p3_Loss 3.2439 | p4_Loss 6.1606 | 
2023-02-26 12:53:55.322: real_rest_sum 570.4245 | real_rest_sum_int 588.0000 | all_sum 8390.0000 | rest_ratio 0.9701 | repeat_ratio 0.9665
2023-02-26 12:54:12.159: [Training]| Epochs  19 | Batch  5000  | ms/batch 0.03 | Loss 11.7657 | p1_Loss 0.5992 | p2_Loss 0.6884 | p3_Loss 4.1876 | p4_Loss 6.2905 | 
2023-02-26 12:54:12.159: real_rest_sum 690.0146 | real_rest_sum_int 705.0000 | all_sum 7466.0000 | rest_ratio 0.9787 | repeat_ratio 0.9861
2023-02-26 12:54:17.769: batch_num: 5179
2023-02-26 12:54:17.769: [Training]| Epochs  19 | loss_all  10.3357 | p1_all  0.5304 | p2_all  0.6877 | p3_all  3.2789 | p4_all  5.8050 | real_rest_ratio 0.0705 | repeat_ratio 0.9706 |
2023-02-26 12:54:33.688: 1
2023-02-26 12:54:33.689: valid_real_ratio_avg 0.0874 valid_neg_ratio_avg 0.1254 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 12:54:33.689: [Validation] neg_sample TOP5 [Test]| Epochs  19 | Hit ratio 0.9084 | recall 0.3450 |  precision 0.5483 | f1  0.3756 | ndcg  0.6172 | mrr  0.7793 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 12:54:33.689: [Validation] p_n_score_differences_avg 0.4191 
2023-02-26 12:54:33.689: ##############################################
2023-02-26 12:54:33.691: G1_flag 0 pretrain 1 temp 10.0 train_epoch 2  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 12:54:33.900: [Training]| Epochs  20 | Batch     0  | ms/batch 0.00 | Loss 8.6595 | p1_Loss 0.4828 | p2_Loss 0.6869 | p3_Loss 2.0124 | p4_Loss 5.4598 | 
2023-02-26 12:54:33.900: real_rest_sum 3005.9258 | real_rest_sum_int 3090.0000 | all_sum 33238.0000 | rest_ratio 0.9728 | repeat_ratio 0.9783
2023-02-26 12:54:51.319: [Training]| Epochs  20 | Batch   500  | ms/batch 0.04 | Loss 10.2770 | p1_Loss 0.5338 | p2_Loss 0.6838 | p3_Loss 3.1386 | p4_Loss 5.9006 | 
2023-02-26 12:54:51.320: real_rest_sum 1022.4803 | real_rest_sum_int 1053.0000 | all_sum 12858.0000 | rest_ratio 0.9710 | repeat_ratio 0.9568
2023-02-26 12:55:08.442: [Training]| Epochs  20 | Batch  1000  | ms/batch 0.03 | Loss 9.1388 | p1_Loss 0.4939 | p2_Loss 0.6886 | p3_Loss 2.2080 | p4_Loss 5.6858 | 
2023-02-26 12:55:08.442: real_rest_sum 2442.7798 | real_rest_sum_int 2520.0000 | all_sum 41693.0000 | rest_ratio 0.9694 | repeat_ratio 0.9792
2023-02-26 12:55:25.951: [Training]| Epochs  20 | Batch  1500  | ms/batch 0.04 | Loss 9.2231 | p1_Loss 0.4898 | p2_Loss 0.6852 | p3_Loss 2.2767 | p4_Loss 5.6890 | 
2023-02-26 12:55:25.952: real_rest_sum 1281.5138 | real_rest_sum_int 1313.0000 | all_sum 27009.0000 | rest_ratio 0.9760 | repeat_ratio 0.9743
2023-02-26 12:55:43.215: [Training]| Epochs  20 | Batch  2000  | ms/batch 0.04 | Loss 8.9414 | p1_Loss 0.4831 | p2_Loss 0.6857 | p3_Loss 2.2616 | p4_Loss 5.4639 | 
2023-02-26 12:55:43.215: real_rest_sum 1549.1509 | real_rest_sum_int 1587.0000 | all_sum 24373.0000 | rest_ratio 0.9762 | repeat_ratio 0.9573
2023-02-26 12:55:58.741: [Training]| Epochs  20 | Batch  2500  | ms/batch 0.03 | Loss 12.1939 | p1_Loss 0.5711 | p2_Loss 0.6874 | p3_Loss 4.6037 | p4_Loss 6.3083 | 
2023-02-26 12:55:58.741: real_rest_sum 234.8707 | real_rest_sum_int 241.0000 | all_sum 2719.0000 | rest_ratio 0.9746 | repeat_ratio 0.9609
2023-02-26 12:56:14.181: [Training]| Epochs  20 | Batch  3000  | ms/batch 0.03 | Loss 10.6106 | p1_Loss 0.5449 | p2_Loss 0.6864 | p3_Loss 3.5995 | p4_Loss 5.7799 | 
2023-02-26 12:56:14.181: real_rest_sum 702.3379 | real_rest_sum_int 718.0000 | all_sum 7351.0000 | rest_ratio 0.9782 | repeat_ratio 0.9890
2023-02-26 12:56:30.383: [Training]| Epochs  20 | Batch  3500  | ms/batch 0.03 | Loss 10.1025 | p1_Loss 0.5272 | p2_Loss 0.6886 | p3_Loss 2.9360 | p4_Loss 5.9062 | 
2023-02-26 12:56:30.383: real_rest_sum 1277.2452 | real_rest_sum_int 1312.0000 | all_sum 19129.0000 | rest_ratio 0.9735 | repeat_ratio 0.9723
2023-02-26 12:56:46.502: [Training]| Epochs  20 | Batch  4000  | ms/batch 0.03 | Loss 9.5720 | p1_Loss 0.5159 | p2_Loss 0.6867 | p3_Loss 2.7097 | p4_Loss 5.6556 | 
2023-02-26 12:56:46.502: real_rest_sum 813.5259 | real_rest_sum_int 837.0000 | all_sum 9196.0000 | rest_ratio 0.9720 | repeat_ratio 0.9719
2023-02-26 12:57:03.807: [Training]| Epochs  20 | Batch  4500  | ms/batch 0.04 | Loss 10.1056 | p1_Loss 0.5292 | p2_Loss 0.6806 | p3_Loss 3.3710 | p4_Loss 5.4953 | 
2023-02-26 12:57:03.808: real_rest_sum 769.2084 | real_rest_sum_int 791.0000 | all_sum 10137.0000 | rest_ratio 0.9725 | repeat_ratio 0.9759
2023-02-26 12:57:18.812: [Training]| Epochs  20 | Batch  5000  | ms/batch 0.03 | Loss 14.8909 | p1_Loss 0.6564 | p2_Loss 0.6919 | p3_Loss 6.7223 | p4_Loss 6.7943 | 
2023-02-26 12:57:18.812: real_rest_sum 93.7830 | real_rest_sum_int 96.0000 | all_sum 1049.0000 | rest_ratio 0.9769 | repeat_ratio 1.0000
2023-02-26 12:57:24.784: batch_num: 5179
2023-02-26 12:57:24.785: [Training]| Epochs  20 | loss_all  10.2768 | p1_all  0.5286 | p2_all  0.6877 | p3_all  3.2363 | p4_all  5.7889 | real_rest_ratio 0.0694 | repeat_ratio 0.9721 |
2023-02-26 12:57:40.635: 1
2023-02-26 12:57:40.636: valid_real_ratio_avg 0.0863 valid_neg_ratio_avg 0.1222 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 12:57:40.636: [Validation] neg_sample TOP5 [Test]| Epochs  20 | Hit ratio 0.8953 | recall 0.3356 |  precision 0.5424 | f1  0.3675 | ndcg  0.6158 | mrr  0.7819 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 12:57:40.636: [Validation] p_n_score_differences_avg 0.4264 
2023-02-26 12:57:40.636: ##############################################
2023-02-26 13:00:04.895: 1
2023-02-26 13:00:04.903: Epochs  20 topk   5  basket_length <4  num 714  Hit ratio 0.8109 | recall 0.5130 |  precision 0.3451 | f1  0.3751 | ndcg  0.5433 | mrr  0.6865 
2023-02-26 13:00:04.904: Epochs  20 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8553 | recall 0.4241 |  precision 0.4373 | f1  0.3963 | ndcg  0.5475 | mrr  0.7345 
2023-02-26 13:00:04.907: Epochs  20 topk   5  basket_length >6  num 4295  Hit ratio 0.9502 | recall 0.3300 |  precision 0.6347 | f1  0.4004 | ndcg  0.6750 | mrr  0.8304 
2023-02-26 13:00:04.907: ...............................................
2023-02-26 13:00:04.907: test_real_ratio_avg 0.0951 test_neg_ratio_avg 0.1192 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 13:00:04.907: neg_sample TOP5 [Test]| Epochs  20 | Hit ratio 0.9159 | recall 0.3691 |  precision 0.5635 | f1  0.3967 | ndcg  0.6354 | mrr  0.7954 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 13:00:04.907: [Test] p_n_score_differences_avg 0.4564 
2023-02-26 13:00:04.907: ##############################################
2023-02-26 13:00:05.012: Save model as ./runs/model_1_Instacart_t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5.pt
2023-02-26 13:00:05.012: Epochs  20 best_hit 0.9159 best_recall 0.3691 best_precision 0.5635 best_f1 0.3967 best_ndcg 0.6354  best_mrr 0.7954 
2023-02-26 13:00:05.012: Epochs  20 loss_all 10.2768 Hit ratio 0.9159 recall 0.3691 precision 0.5635 f1  0.3967 ndcg  0.6354 mrr  0.7954 avg_fake_length 5.0000
2023-02-26 13:00:05.014: G1_flag 0 pretrain 1 temp 10.0 train_epoch 3  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:00:05.216: [Training]| Epochs  21 | Batch     0  | ms/batch 0.00 | Loss 8.4642 | p1_Loss 0.4824 | p2_Loss 0.6895 | p3_Loss 1.8837 | p4_Loss 5.3428 | 
2023-02-26 13:00:05.216: real_rest_sum 2200.4805 | real_rest_sum_int 2260.0000 | all_sum 34342.0000 | rest_ratio 0.9737 | repeat_ratio 0.9727
2023-02-26 13:00:20.761: [Training]| Epochs  21 | Batch   500  | ms/batch 0.03 | Loss 10.9791 | p1_Loss 0.5732 | p2_Loss 0.6852 | p3_Loss 3.9835 | p4_Loss 5.7107 | 
2023-02-26 13:00:20.761: real_rest_sum 577.9586 | real_rest_sum_int 593.0000 | all_sum 9076.0000 | rest_ratio 0.9746 | repeat_ratio 0.9407
2023-02-26 13:00:36.662: [Training]| Epochs  21 | Batch  1000  | ms/batch 0.03 | Loss 11.3931 | p1_Loss 0.5577 | p2_Loss 0.6902 | p3_Loss 4.0555 | p4_Loss 6.0526 | 
2023-02-26 13:00:36.662: real_rest_sum 407.7425 | real_rest_sum_int 420.0000 | all_sum 6094.0000 | rest_ratio 0.9708 | repeat_ratio 0.9863
2023-02-26 13:00:52.846: [Training]| Epochs  21 | Batch  1500  | ms/batch 0.03 | Loss 10.7887 | p1_Loss 0.5296 | p2_Loss 0.6888 | p3_Loss 3.4125 | p4_Loss 6.1035 | 
2023-02-26 13:00:52.846: real_rest_sum 944.2449 | real_rest_sum_int 973.0000 | all_sum 13812.0000 | rest_ratio 0.9704 | repeat_ratio 0.9739
2023-02-26 13:01:09.892: [Training]| Epochs  21 | Batch  2000  | ms/batch 0.04 | Loss 8.8326 | p1_Loss 0.4838 | p2_Loss 0.6873 | p3_Loss 2.2492 | p4_Loss 5.3673 | 
2023-02-26 13:01:09.893: real_rest_sum 1600.6587 | real_rest_sum_int 1645.0000 | all_sum 22002.0000 | rest_ratio 0.9730 | repeat_ratio 0.9697
2023-02-26 13:01:27.907: [Training]| Epochs  21 | Batch  2500  | ms/batch 0.04 | Loss 8.6225 | p1_Loss 0.4897 | p2_Loss 0.6826 | p3_Loss 2.1861 | p4_Loss 5.2425 | 
2023-02-26 13:01:27.908: real_rest_sum 1008.4543 | real_rest_sum_int 1030.0000 | all_sum 13790.0000 | rest_ratio 0.9791 | repeat_ratio 0.9706
2023-02-26 13:01:46.357: [Training]| Epochs  21 | Batch  3000  | ms/batch 0.04 | Loss 11.4687 | p1_Loss 0.5603 | p2_Loss 0.6905 | p3_Loss 3.8692 | p4_Loss 6.2699 | 
2023-02-26 13:01:46.357: real_rest_sum 513.2852 | real_rest_sum_int 528.0000 | all_sum 11182.0000 | rest_ratio 0.9721 | repeat_ratio 0.9938
2023-02-26 13:02:02.438: [Training]| Epochs  21 | Batch  3500  | ms/batch 0.03 | Loss 8.3670 | p1_Loss 0.4728 | p2_Loss 0.6851 | p3_Loss 2.0743 | p4_Loss 5.1092 | 
2023-02-26 13:02:02.438: real_rest_sum 1254.2244 | real_rest_sum_int 1287.0000 | all_sum 17197.0000 | rest_ratio 0.9745 | repeat_ratio 0.9663
2023-02-26 13:02:18.940: [Training]| Epochs  21 | Batch  4000  | ms/batch 0.03 | Loss 13.7262 | p1_Loss 0.6332 | p2_Loss 0.6923 | p3_Loss 5.6447 | p4_Loss 6.6996 | 
2023-02-26 13:02:18.940: real_rest_sum 94.8342 | real_rest_sum_int 97.0000 | all_sum 1600.0000 | rest_ratio 0.9777 | repeat_ratio 1.0000
2023-02-26 13:02:35.447: [Training]| Epochs  21 | Batch  4500  | ms/batch 0.03 | Loss 11.7063 | p1_Loss 0.5824 | p2_Loss 0.6869 | p3_Loss 4.2779 | p4_Loss 6.1591 | 
2023-02-26 13:02:35.447: real_rest_sum 442.3934 | real_rest_sum_int 450.0000 | all_sum 3775.0000 | rest_ratio 0.9831 | repeat_ratio 0.9577
2023-02-26 13:02:50.848: [Training]| Epochs  21 | Batch  5000  | ms/batch 0.03 | Loss 11.0377 | p1_Loss 0.5272 | p2_Loss 0.6861 | p3_Loss 3.5571 | p4_Loss 6.2139 | 
2023-02-26 13:02:50.849: real_rest_sum 875.7369 | real_rest_sum_int 902.0000 | all_sum 13276.0000 | rest_ratio 0.9709 | repeat_ratio 0.9623
2023-02-26 13:02:56.347: batch_num: 5179
2023-02-26 13:02:56.347: [Training]| Epochs  21 | loss_all  10.2460 | p1_all  0.5272 | p2_all  0.6876 | p3_all  3.2217 | p4_all  5.7724 | real_rest_ratio 0.0681 | repeat_ratio 0.9728 |
2023-02-26 13:03:12.281: 1
2023-02-26 13:03:12.282: valid_real_ratio_avg 0.0861 valid_neg_ratio_avg 0.1202 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 13:03:12.282: [Validation] neg_sample TOP5 [Test]| Epochs  21 | Hit ratio 0.8968 | recall 0.3399 |  precision 0.5436 | f1  0.3709 | ndcg  0.6190 | mrr  0.7917 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 13:03:12.282: [Validation] p_n_score_differences_avg 0.4166 
2023-02-26 13:03:12.282: ##############################################
2023-02-26 13:03:12.284: G1_flag 0 pretrain 1 temp 10.0 train_epoch 4  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:03:12.421: [Training]| Epochs  22 | Batch     0  | ms/batch 0.00 | Loss 12.9997 | p1_Loss 0.5988 | p2_Loss 0.6920 | p3_Loss 5.0439 | p4_Loss 6.5971 | 
2023-02-26 13:03:12.421: real_rest_sum 207.3062 | real_rest_sum_int 215.0000 | all_sum 3361.0000 | rest_ratio 0.9642 | repeat_ratio 0.9600
2023-02-26 13:03:27.717: [Training]| Epochs  22 | Batch   500  | ms/batch 0.03 | Loss 9.0081 | p1_Loss 0.4908 | p2_Loss 0.6869 | p3_Loss 2.4539 | p4_Loss 5.3259 | 
2023-02-26 13:03:27.718: real_rest_sum 952.4768 | real_rest_sum_int 977.0000 | all_sum 15367.0000 | rest_ratio 0.9749 | repeat_ratio 0.9800
2023-02-26 13:03:43.751: [Training]| Epochs  22 | Batch  1000  | ms/batch 0.03 | Loss 11.6884 | p1_Loss 0.5741 | p2_Loss 0.6894 | p3_Loss 4.1067 | p4_Loss 6.2997 | 
2023-02-26 13:03:43.752: real_rest_sum 475.6226 | real_rest_sum_int 491.0000 | all_sum 6881.0000 | rest_ratio 0.9687 | repeat_ratio 0.9818
2023-02-26 13:04:00.517: [Training]| Epochs  22 | Batch  1500  | ms/batch 0.03 | Loss 11.1463 | p1_Loss 0.5408 | p2_Loss 0.6907 | p3_Loss 3.7007 | p4_Loss 6.1670 | 
2023-02-26 13:04:00.518: real_rest_sum 620.1913 | real_rest_sum_int 637.0000 | all_sum 10202.0000 | rest_ratio 0.9736 | repeat_ratio 0.9896
2023-02-26 13:04:17.339: [Training]| Epochs  22 | Batch  2000  | ms/batch 0.03 | Loss 8.9439 | p1_Loss 0.4646 | p2_Loss 0.6875 | p3_Loss 2.0418 | p4_Loss 5.7427 | 
2023-02-26 13:04:17.339: real_rest_sum 1881.8329 | real_rest_sum_int 1938.0000 | all_sum 25844.0000 | rest_ratio 0.9710 | repeat_ratio 0.9819
2023-02-26 13:04:35.501: [Training]| Epochs  22 | Batch  2500  | ms/batch 0.04 | Loss 9.7753 | p1_Loss 0.5203 | p2_Loss 0.6885 | p3_Loss 2.6884 | p4_Loss 5.8576 | 
2023-02-26 13:04:35.501: real_rest_sum 2787.1841 | real_rest_sum_int 2880.0000 | all_sum 32600.0000 | rest_ratio 0.9678 | repeat_ratio 0.9808
2023-02-26 13:04:52.153: [Training]| Epochs  22 | Batch  3000  | ms/batch 0.03 | Loss 9.3802 | p1_Loss 0.5147 | p2_Loss 0.6861 | p3_Loss 2.6356 | p4_Loss 5.5338 | 
2023-02-26 13:04:52.154: real_rest_sum 1118.4620 | real_rest_sum_int 1150.0000 | all_sum 12169.0000 | rest_ratio 0.9726 | repeat_ratio 0.9938
2023-02-26 13:05:07.931: [Training]| Epochs  22 | Batch  3500  | ms/batch 0.03 | Loss 9.4458 | p1_Loss 0.5214 | p2_Loss 0.6896 | p3_Loss 2.5989 | p4_Loss 5.6359 | 
2023-02-26 13:05:07.932: real_rest_sum 1871.3615 | real_rest_sum_int 1920.0000 | all_sum 20911.0000 | rest_ratio 0.9747 | repeat_ratio 0.9892
2023-02-26 13:05:23.741: [Training]| Epochs  22 | Batch  4000  | ms/batch 0.03 | Loss 14.1733 | p1_Loss 0.6379 | p2_Loss 0.6913 | p3_Loss 6.0507 | p4_Loss 6.7712 | 
2023-02-26 13:05:23.741: real_rest_sum 89.9434 | real_rest_sum_int 92.0000 | all_sum 1073.0000 | rest_ratio 0.9776 | repeat_ratio 0.9688
2023-02-26 13:05:39.487: [Training]| Epochs  22 | Batch  4500  | ms/batch 0.03 | Loss 8.6459 | p1_Loss 0.4710 | p2_Loss 0.6869 | p3_Loss 2.0175 | p4_Loss 5.3997 | 
2023-02-26 13:05:39.487: real_rest_sum 892.4784 | real_rest_sum_int 916.0000 | all_sum 16459.0000 | rest_ratio 0.9743 | repeat_ratio 0.9715
2023-02-26 13:05:57.775: [Training]| Epochs  22 | Batch  5000  | ms/batch 0.04 | Loss 10.2814 | p1_Loss 0.5161 | p2_Loss 0.6895 | p3_Loss 3.0425 | p4_Loss 5.9940 | 
2023-02-26 13:05:57.775: real_rest_sum 1539.2373 | real_rest_sum_int 1581.0000 | all_sum 18943.0000 | rest_ratio 0.9736 | repeat_ratio 0.9646
2023-02-26 13:06:03.508: batch_num: 5179
2023-02-26 13:06:03.508: [Training]| Epochs  22 | loss_all  10.2232 | p1_all  0.5263 | p2_all  0.6876 | p3_all  3.2034 | p4_all  5.7670 | real_rest_ratio 0.0671 | repeat_ratio 0.9733 |
2023-02-26 13:06:19.338: 1
2023-02-26 13:06:19.339: valid_real_ratio_avg 0.0833 valid_neg_ratio_avg 0.1185 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 13:06:19.339: [Validation] neg_sample TOP5 [Test]| Epochs  22 | Hit ratio 0.9070 | recall 0.3464 |  precision 0.5517 | f1  0.3775 | ndcg  0.6251 | mrr  0.7875 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 13:06:19.339: [Validation] p_n_score_differences_avg 0.4180 
2023-02-26 13:06:19.339: ##############################################
2023-02-26 13:08:43.655: 1
2023-02-26 13:08:43.661: Epochs  22 topk   5  basket_length <4  num 714  Hit ratio 0.8193 | recall 0.5220 |  precision 0.3459 | f1  0.3782 | ndcg  0.5506 | mrr  0.6939 
2023-02-26 13:08:43.662: Epochs  22 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8520 | recall 0.4212 |  precision 0.4360 | f1  0.3944 | ndcg  0.5419 | mrr  0.7256 
2023-02-26 13:08:43.665: Epochs  22 topk   5  basket_length >6  num 4295  Hit ratio 0.9474 | recall 0.3311 |  precision 0.6351 | f1  0.4011 | ndcg  0.6766 | mrr  0.8323 
2023-02-26 13:08:43.665: ...............................................
2023-02-26 13:08:43.666: test_real_ratio_avg 0.0928 test_neg_ratio_avg 0.1157 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 13:08:43.666: neg_sample TOP5 [Test]| Epochs  22 | Hit ratio 0.9143 | recall 0.3704 |  precision 0.5636 | f1  0.3972 | ndcg  0.6363 | mrr  0.7959 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 13:08:43.666: [Test] p_n_score_differences_avg 0.4501 
2023-02-26 13:08:43.666: ##############################################
2023-02-26 13:08:43.773: Save model as ./runs/model_1_Instacart_t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5.pt
2023-02-26 13:08:43.773: Epochs  22 best_hit 0.9159 best_recall 0.3704 best_precision 0.5636 best_f1 0.3972 best_ndcg 0.6363  best_mrr 0.7959 
2023-02-26 13:08:43.773: Epochs  22 loss_all 10.2232 Hit ratio 0.9143 recall 0.3704 precision 0.5636 f1  0.3972 ndcg  0.6363 mrr  0.7959 avg_fake_length 5.0000
2023-02-26 13:08:43.775: G1_flag 1 pretrain 1 temp 10.0 train_epoch 0  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:08:43.990: [Training]| Epochs  23 | Batch     0  | ms/batch 0.00 | Loss 2.5810 | p1_Loss 0.4282 | p2_Loss 0.6843 | p3_Loss 1.4139 | p4_Loss 1.4139 | 
2023-02-26 13:08:43.990: real_rest_sum 1194.5149 | real_rest_sum_int 1784.0000 | all_sum 27864.0000 | rest_ratio 0.6696 | repeat_ratio 0.9813
2023-02-26 13:09:01.130: [Training]| Epochs  23 | Batch   500  | ms/batch 0.04 | Loss 7.4083 | p1_Loss 0.6298 | p2_Loss 0.6921 | p3_Loss 6.0316 | p4_Loss 6.0316 | 
2023-02-26 13:09:01.130: real_rest_sum 77.1739 | real_rest_sum_int 114.0000 | all_sum 2097.0000 | rest_ratio 0.6770 | repeat_ratio 1.0000
2023-02-26 13:09:16.573: [Training]| Epochs  23 | Batch  1000  | ms/batch 0.03 | Loss 3.3854 | p1_Loss 0.4483 | p2_Loss 0.6871 | p3_Loss 2.1831 | p4_Loss 2.1831 | 
2023-02-26 13:09:16.574: real_rest_sum 564.9218 | real_rest_sum_int 808.0000 | all_sum 22379.0000 | rest_ratio 0.6992 | repeat_ratio 0.9529
2023-02-26 13:09:32.804: [Training]| Epochs  23 | Batch  1500  | ms/batch 0.03 | Loss 3.5749 | p1_Loss 0.4664 | p2_Loss 0.6889 | p3_Loss 2.3471 | p4_Loss 2.3471 | 
2023-02-26 13:09:32.804: real_rest_sum 975.6019 | real_rest_sum_int 1335.0000 | all_sum 36910.0000 | rest_ratio 0.7308 | repeat_ratio 0.9828
2023-02-26 13:09:48.102: [Training]| Epochs  23 | Batch  2000  | ms/batch 0.03 | Loss 4.4468 | p1_Loss 0.5247 | p2_Loss 0.6835 | p3_Loss 3.1700 | p4_Loss 3.1700 | 
2023-02-26 13:09:48.102: real_rest_sum 248.5273 | real_rest_sum_int 338.0000 | all_sum 10235.0000 | rest_ratio 0.7353 | repeat_ratio 0.9782
2023-02-26 13:10:04.938: [Training]| Epochs  23 | Batch  2500  | ms/batch 0.03 | Loss 3.8002 | p1_Loss 0.4977 | p2_Loss 0.6882 | p3_Loss 2.5410 | p4_Loss 2.5410 | 
2023-02-26 13:10:04.938: real_rest_sum 828.8793 | real_rest_sum_int 1155.0000 | all_sum 34404.0000 | rest_ratio 0.7176 | repeat_ratio 0.9620
2023-02-26 13:10:21.792: [Training]| Epochs  23 | Batch  3000  | ms/batch 0.03 | Loss 4.8323 | p1_Loss 0.5509 | p2_Loss 0.6885 | p3_Loss 3.5264 | p4_Loss 3.5264 | 
2023-02-26 13:10:21.793: real_rest_sum 281.5573 | real_rest_sum_int 374.0000 | all_sum 9902.0000 | rest_ratio 0.7528 | repeat_ratio 0.9706
2023-02-26 13:10:38.387: [Training]| Epochs  23 | Batch  3500  | ms/batch 0.03 | Loss 3.5221 | p1_Loss 0.4693 | p2_Loss 0.6883 | p3_Loss 2.2610 | p4_Loss 2.2610 | 
2023-02-26 13:10:38.387: real_rest_sum 603.7338 | real_rest_sum_int 760.0000 | all_sum 26415.0000 | rest_ratio 0.7944 | repeat_ratio 0.9833
2023-02-26 13:10:55.064: [Training]| Epochs  23 | Batch  4000  | ms/batch 0.03 | Loss 6.2336 | p1_Loss 0.6047 | p2_Loss 0.6913 | p3_Loss 4.8816 | p4_Loss 4.8816 | 
2023-02-26 13:10:55.064: real_rest_sum 192.1316 | real_rest_sum_int 261.0000 | all_sum 5085.0000 | rest_ratio 0.7361 | repeat_ratio 0.9519
2023-02-26 13:11:10.579: [Training]| Epochs  23 | Batch  4500  | ms/batch 0.03 | Loss 4.8928 | p1_Loss 0.5472 | p2_Loss 0.6879 | p3_Loss 3.6259 | p4_Loss 3.6259 | 
2023-02-26 13:11:10.579: real_rest_sum 264.3263 | real_rest_sum_int 319.0000 | all_sum 4368.0000 | rest_ratio 0.8286 | repeat_ratio 0.9643
2023-02-26 13:11:26.373: [Training]| Epochs  23 | Batch  5000  | ms/batch 0.03 | Loss 4.8898 | p1_Loss 0.5489 | p2_Loss 0.6905 | p3_Loss 3.5668 | p4_Loss 3.5668 | 
2023-02-26 13:11:26.373: real_rest_sum 281.4170 | real_rest_sum_int 356.0000 | all_sum 8286.0000 | rest_ratio 0.7905 | repeat_ratio 0.9613
2023-02-26 13:11:32.237: batch_num: 5179
2023-02-26 13:11:32.237: [Training]| Epochs  23 | loss_all  4.5544 | p1_all  0.5245 | p2_all  0.6875 | p3_all  3.2852 | p4_all  3.2852 | real_rest_ratio 0.0493 | repeat_ratio 0.9767 |
2023-02-26 13:11:48.167: 1
2023-02-26 13:11:48.168: valid_real_ratio_avg 0.0703 valid_neg_ratio_avg 0.0811 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 13:11:48.168: [Validation] neg_sample TOP5 [Test]| Epochs  23 | Hit ratio 0.8968 | recall 0.3405 |  precision 0.5439 | f1  0.3715 | ndcg  0.6170 | mrr  0.7812 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 13:11:48.168: [Validation] p_n_score_differences_avg 0.4116 
2023-02-26 13:11:48.168: ##############################################
2023-02-26 13:11:48.170: G1_flag 1 pretrain 1 temp 10.0 train_epoch 1  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:11:48.370: [Training]| Epochs  24 | Batch     0  | ms/batch 0.00 | Loss 2.9896 | p1_Loss 0.4580 | p2_Loss 0.6884 | p3_Loss 1.8027 | p4_Loss 1.8027 | 
2023-02-26 13:11:48.371: real_rest_sum 2121.9727 | real_rest_sum_int 3301.0000 | all_sum 36019.0000 | rest_ratio 0.6428 | repeat_ratio 0.9957
2023-02-26 13:12:05.770: [Training]| Epochs  24 | Batch   500  | ms/batch 0.04 | Loss 2.7777 | p1_Loss 0.4426 | p2_Loss 0.6844 | p3_Loss 1.5866 | p4_Loss 1.5866 | 
2023-02-26 13:12:05.770: real_rest_sum 544.5605 | real_rest_sum_int 767.0000 | all_sum 19870.0000 | rest_ratio 0.7100 | repeat_ratio 0.9845
2023-02-26 13:12:20.381: [Training]| Epochs  24 | Batch  1000  | ms/batch 0.03 | Loss 8.4646 | p1_Loss 0.6513 | p2_Loss 0.6917 | p3_Loss 7.0670 | p4_Loss 7.0670 | 
2023-02-26 13:12:20.381: real_rest_sum 89.0025 | real_rest_sum_int 139.0000 | all_sum 1867.0000 | rest_ratio 0.6403 | repeat_ratio 1.0000
2023-02-26 13:12:36.475: [Training]| Epochs  24 | Batch  1500  | ms/batch 0.03 | Loss 5.8863 | p1_Loss 0.5736 | p2_Loss 0.6893 | p3_Loss 4.5417 | p4_Loss 4.5417 | 
2023-02-26 13:12:36.475: real_rest_sum 169.4792 | real_rest_sum_int 236.0000 | all_sum 9839.0000 | rest_ratio 0.7181 | repeat_ratio 0.9630
2023-02-26 13:12:51.944: [Training]| Epochs  24 | Batch  2000  | ms/batch 0.03 | Loss 4.7840 | p1_Loss 0.5285 | p2_Loss 0.6894 | p3_Loss 3.4940 | p4_Loss 3.4940 | 
2023-02-26 13:12:51.944: real_rest_sum 169.7694 | real_rest_sum_int 224.0000 | all_sum 6439.0000 | rest_ratio 0.7579 | repeat_ratio 0.9803
2023-02-26 13:13:09.412: [Training]| Epochs  24 | Batch  2500  | ms/batch 0.04 | Loss 5.5746 | p1_Loss 0.5516 | p2_Loss 0.6898 | p3_Loss 4.2519 | p4_Loss 4.2519 | 
2023-02-26 13:13:09.413: real_rest_sum 156.2255 | real_rest_sum_int 206.0000 | all_sum 6530.0000 | rest_ratio 0.7584 | repeat_ratio 0.9786
2023-02-26 13:13:25.706: [Training]| Epochs  24 | Batch  3000  | ms/batch 0.03 | Loss 6.2552 | p1_Loss 0.5949 | p2_Loss 0.6874 | p3_Loss 4.9229 | p4_Loss 4.9229 | 
2023-02-26 13:13:25.706: real_rest_sum 128.4453 | real_rest_sum_int 173.0000 | all_sum 3554.0000 | rest_ratio 0.7425 | repeat_ratio 0.9833
2023-02-26 13:13:41.012: [Training]| Epochs  24 | Batch  3500  | ms/batch 0.03 | Loss 6.9721 | p1_Loss 0.6052 | p2_Loss 0.6899 | p3_Loss 5.6456 | p4_Loss 5.6456 | 
2023-02-26 13:13:41.012: real_rest_sum 114.7441 | real_rest_sum_int 145.0000 | all_sum 2491.0000 | rest_ratio 0.7913 | repeat_ratio 0.9722
2023-02-26 13:13:56.258: [Training]| Epochs  24 | Batch  4000  | ms/batch 0.03 | Loss 4.0014 | p1_Loss 0.5176 | p2_Loss 0.6825 | p3_Loss 2.7513 | p4_Loss 2.7513 | 
2023-02-26 13:13:56.259: real_rest_sum 412.9995 | real_rest_sum_int 534.0000 | all_sum 10552.0000 | rest_ratio 0.7734 | repeat_ratio 0.9898
2023-02-26 13:14:12.511: [Training]| Epochs  24 | Batch  4500  | ms/batch 0.03 | Loss 3.9701 | p1_Loss 0.5222 | p2_Loss 0.6891 | p3_Loss 2.6948 | p4_Loss 2.6948 | 
2023-02-26 13:14:12.511: real_rest_sum 798.5614 | real_rest_sum_int 1020.0000 | all_sum 19377.0000 | rest_ratio 0.7829 | repeat_ratio 0.9879
2023-02-26 13:14:28.779: [Training]| Epochs  24 | Batch  5000  | ms/batch 0.03 | Loss 3.5923 | p1_Loss 0.4984 | p2_Loss 0.6870 | p3_Loss 2.3693 | p4_Loss 2.3693 | 
2023-02-26 13:14:28.779: real_rest_sum 1660.5388 | real_rest_sum_int 2118.0000 | all_sum 29130.0000 | rest_ratio 0.7840 | repeat_ratio 0.9877
2023-02-26 13:14:35.447: batch_num: 5179
2023-02-26 13:14:35.447: [Training]| Epochs  24 | loss_all  4.5964 | p1_all  0.5257 | p2_all  0.6875 | p3_all  3.3254 | p4_all  3.3254 | real_rest_ratio 0.0499 | repeat_ratio 0.9814 |
2023-02-26 13:14:51.300: 1
2023-02-26 13:14:51.300: valid_real_ratio_avg 0.0739 valid_neg_ratio_avg 0.0908 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 13:14:51.300: [Validation] neg_sample TOP5 [Test]| Epochs  24 | Hit ratio 0.8939 | recall 0.3382 |  precision 0.5451 | f1  0.3715 | ndcg  0.6137 | mrr  0.7728 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 13:14:51.301: [Validation] p_n_score_differences_avg 0.4048 
2023-02-26 13:14:51.301: ##############################################
2023-02-26 13:17:15.594: 1
2023-02-26 13:17:15.601: Epochs  24 topk   5  basket_length <4  num 714  Hit ratio 0.8235 | recall 0.5188 |  precision 0.3448 | f1  0.3768 | ndcg  0.5469 | mrr  0.6925 
2023-02-26 13:17:15.602: Epochs  24 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8503 | recall 0.4235 |  precision 0.4377 | f1  0.3961 | ndcg  0.5483 | mrr  0.7366 
2023-02-26 13:17:15.605: Epochs  24 topk   5  basket_length >6  num 4295  Hit ratio 0.9469 | recall 0.3291 |  precision 0.6328 | f1  0.3993 | ndcg  0.6746 | mrr  0.8302 
2023-02-26 13:17:15.605: ...............................................
2023-02-26 13:17:15.605: test_real_ratio_avg 0.0833 test_neg_ratio_avg 0.0883 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 13:17:15.605: neg_sample TOP5 [Test]| Epochs  24 | Hit ratio 0.9142 | recall 0.3691 |  precision 0.5622 | f1  0.3961 | ndcg  0.6357 | mrr  0.7963 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 13:17:15.605: [Test] p_n_score_differences_avg 0.4397 
2023-02-26 13:17:15.605: ##############################################
2023-02-26 13:17:15.607: Epochs  24 best_hit 0.9159 best_recall 0.3704 best_precision 0.5636 best_f1 0.3972 best_ndcg 0.6363  best_mrr 0.7963 
2023-02-26 13:17:15.607: Epochs  24 loss_all 4.5964 Hit ratio 0.9142 recall 0.3691 precision 0.5622 f1  0.3961 ndcg  0.6357 mrr  0.7963 avg_fake_length 5.0000
2023-02-26 13:17:15.609: G1_flag 1 pretrain 1 temp 10.0 train_epoch 2  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:17:15.836: [Training]| Epochs  25 | Batch     0  | ms/batch 0.00 | Loss 3.4845 | p1_Loss 0.4902 | p2_Loss 0.6872 | p3_Loss 2.2720 | p4_Loss 2.2720 | 
2023-02-26 13:17:15.837: real_rest_sum 1088.4095 | real_rest_sum_int 1662.0000 | all_sum 17892.0000 | rest_ratio 0.6549 | repeat_ratio 0.9913
2023-02-26 13:17:32.790: [Training]| Epochs  25 | Batch   500  | ms/batch 0.03 | Loss 4.4548 | p1_Loss 0.5184 | p2_Loss 0.6893 | p3_Loss 3.1849 | p4_Loss 3.1849 | 
2023-02-26 13:17:32.791: real_rest_sum 264.6794 | real_rest_sum_int 398.0000 | all_sum 8390.0000 | rest_ratio 0.6650 | repeat_ratio 0.9848
2023-02-26 13:17:48.687: [Training]| Epochs  25 | Batch  1000  | ms/batch 0.03 | Loss 6.4882 | p1_Loss 0.5859 | p2_Loss 0.6900 | p3_Loss 5.1550 | p4_Loss 5.1550 | 
2023-02-26 13:17:48.687: real_rest_sum 124.4577 | real_rest_sum_int 185.0000 | all_sum 4473.0000 | rest_ratio 0.6727 | repeat_ratio 0.9598
2023-02-26 13:18:04.599: [Training]| Epochs  25 | Batch  1500  | ms/batch 0.03 | Loss 6.0397 | p1_Loss 0.5656 | p2_Loss 0.6873 | p3_Loss 4.7066 | p4_Loss 4.7066 | 
2023-02-26 13:18:04.599: real_rest_sum 133.5285 | real_rest_sum_int 185.0000 | all_sum 6498.0000 | rest_ratio 0.7218 | repeat_ratio 0.9655
2023-02-26 13:18:21.975: [Training]| Epochs  25 | Batch  2000  | ms/batch 0.04 | Loss 2.4909 | p1_Loss 0.4241 | p2_Loss 0.6872 | p3_Loss 1.3094 | p4_Loss 1.3094 | 
2023-02-26 13:18:21.976: real_rest_sum 968.1395 | real_rest_sum_int 1313.0000 | all_sum 43586.0000 | rest_ratio 0.7373 | repeat_ratio 0.9887
2023-02-26 13:18:38.480: [Training]| Epochs  25 | Batch  2500  | ms/batch 0.03 | Loss 7.6459 | p1_Loss 0.6262 | p2_Loss 0.6891 | p3_Loss 6.2702 | p4_Loss 6.2702 | 
2023-02-26 13:18:38.481: real_rest_sum 61.8359 | real_rest_sum_int 81.0000 | all_sum 1792.0000 | rest_ratio 0.7634 | repeat_ratio 0.9643
2023-02-26 13:18:55.808: [Training]| Epochs  25 | Batch  3000  | ms/batch 0.04 | Loss 4.6634 | p1_Loss 0.5274 | p2_Loss 0.6859 | p3_Loss 3.3884 | p4_Loss 3.3884 | 
2023-02-26 13:18:55.809: real_rest_sum 225.5455 | real_rest_sum_int 289.0000 | all_sum 7874.0000 | rest_ratio 0.7804 | repeat_ratio 0.9810
2023-02-26 13:19:12.568: [Training]| Epochs  25 | Batch  3500  | ms/batch 0.03 | Loss 8.5721 | p1_Loss 0.6403 | p2_Loss 0.6927 | p3_Loss 7.1835 | p4_Loss 7.1835 | 
2023-02-26 13:19:12.568: real_rest_sum 55.4280 | real_rest_sum_int 73.0000 | all_sum 1632.0000 | rest_ratio 0.7593 | repeat_ratio 1.0000
2023-02-26 13:19:27.788: [Training]| Epochs  25 | Batch  4000  | ms/batch 0.03 | Loss 3.6134 | p1_Loss 0.4808 | p2_Loss 0.6852 | p3_Loss 2.3970 | p4_Loss 2.3970 | 
2023-02-26 13:19:27.788: real_rest_sum 1209.4524 | real_rest_sum_int 1630.0000 | all_sum 27452.0000 | rest_ratio 0.7420 | repeat_ratio 0.9874
2023-02-26 13:19:43.995: [Training]| Epochs  25 | Batch  4500  | ms/batch 0.03 | Loss 4.7513 | p1_Loss 0.5466 | p2_Loss 0.6859 | p3_Loss 3.4688 | p4_Loss 3.4688 | 
2023-02-26 13:19:43.995: real_rest_sum 380.5811 | real_rest_sum_int 476.0000 | all_sum 8628.0000 | rest_ratio 0.7995 | repeat_ratio 0.9798
2023-02-26 13:20:01.376: [Training]| Epochs  25 | Batch  5000  | ms/batch 0.04 | Loss 2.8660 | p1_Loss 0.4598 | p2_Loss 0.6833 | p3_Loss 1.6959 | p4_Loss 1.6959 | 
2023-02-26 13:20:01.376: real_rest_sum 2067.1484 | real_rest_sum_int 2615.0000 | all_sum 38393.0000 | rest_ratio 0.7905 | repeat_ratio 0.9955
2023-02-26 13:20:07.343: batch_num: 5179
2023-02-26 13:20:07.343: [Training]| Epochs  25 | loss_all  4.6082 | p1_all  0.5254 | p2_all  0.6874 | p3_all  3.3372 | p4_all  3.3372 | real_rest_ratio 0.0490 | repeat_ratio 0.9803 |
2023-02-26 13:20:23.246: 1
2023-02-26 13:20:23.247: valid_real_ratio_avg 0.0700 valid_neg_ratio_avg 0.0835 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 13:20:23.247: [Validation] neg_sample TOP5 [Test]| Epochs  25 | Hit ratio 0.9041 | recall 0.3451 |  precision 0.5517 | f1  0.3769 | ndcg  0.6233 | mrr  0.7863 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 13:20:23.247: [Validation] p_n_score_differences_avg 0.4155 
2023-02-26 13:20:23.247: ##############################################
2023-02-26 13:20:23.249: G1_flag 1 pretrain 1 temp 10.0 train_epoch 3  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:20:23.469: [Training]| Epochs  26 | Batch     0  | ms/batch 0.00 | Loss 4.0919 | p1_Loss 0.5330 | p2_Loss 0.6866 | p3_Loss 2.8481 | p4_Loss 2.8481 | 
2023-02-26 13:20:23.470: real_rest_sum 975.3073 | real_rest_sum_int 1533.0000 | all_sum 13823.0000 | rest_ratio 0.6362 | repeat_ratio 0.9986
2023-02-26 13:20:39.953: [Training]| Epochs  26 | Batch   500  | ms/batch 0.03 | Loss 3.7939 | p1_Loss 0.4958 | p2_Loss 0.6842 | p3_Loss 2.5632 | p4_Loss 2.5632 | 
2023-02-26 13:20:39.953: real_rest_sum 531.3782 | real_rest_sum_int 768.0000 | all_sum 12547.0000 | rest_ratio 0.6919 | repeat_ratio 0.9611
2023-02-26 13:20:56.519: [Training]| Epochs  26 | Batch  1000  | ms/batch 0.03 | Loss 5.6931 | p1_Loss 0.5683 | p2_Loss 0.6892 | p3_Loss 4.3808 | p4_Loss 4.3808 | 
2023-02-26 13:20:56.519: real_rest_sum 136.1467 | real_rest_sum_int 192.0000 | all_sum 3524.0000 | rest_ratio 0.7091 | repeat_ratio 0.9343
2023-02-26 13:21:13.022: [Training]| Epochs  26 | Batch  1500  | ms/batch 0.03 | Loss 2.9105 | p1_Loss 0.4510 | p2_Loss 0.6884 | p3_Loss 1.6945 | p4_Loss 1.6945 | 
2023-02-26 13:21:13.023: real_rest_sum 1132.3574 | real_rest_sum_int 1565.0000 | all_sum 50569.0000 | rest_ratio 0.7236 | repeat_ratio 0.9635
2023-02-26 13:21:30.454: [Training]| Epochs  26 | Batch  2000  | ms/batch 0.04 | Loss 6.1969 | p1_Loss 0.5958 | p2_Loss 0.6866 | p3_Loss 4.8634 | p4_Loss 4.8634 | 
2023-02-26 13:21:30.454: real_rest_sum 79.3845 | real_rest_sum_int 109.0000 | all_sum 2255.0000 | rest_ratio 0.7283 | repeat_ratio 0.9583
2023-02-26 13:21:45.847: [Training]| Epochs  26 | Batch  2500  | ms/batch 0.03 | Loss 4.1750 | p1_Loss 0.5109 | p2_Loss 0.6883 | p3_Loss 2.9117 | p4_Loss 2.9117 | 
2023-02-26 13:21:45.847: real_rest_sum 240.1376 | real_rest_sum_int 318.0000 | all_sum 7639.0000 | rest_ratio 0.7551 | repeat_ratio 0.9926
2023-02-26 13:22:01.947: [Training]| Epochs  26 | Batch  3000  | ms/batch 0.03 | Loss 3.6478 | p1_Loss 0.4845 | p2_Loss 0.6873 | p3_Loss 2.4068 | p4_Loss 2.4068 | 
2023-02-26 13:22:01.947: real_rest_sum 942.9555 | real_rest_sum_int 1246.0000 | all_sum 33659.0000 | rest_ratio 0.7568 | repeat_ratio 0.9864
2023-02-26 13:22:18.434: [Training]| Epochs  26 | Batch  3500  | ms/batch 0.03 | Loss 5.1023 | p1_Loss 0.5508 | p2_Loss 0.6905 | p3_Loss 3.8021 | p4_Loss 3.8021 | 
2023-02-26 13:22:18.435: real_rest_sum 266.5064 | real_rest_sum_int 356.0000 | all_sum 9000.0000 | rest_ratio 0.7486 | repeat_ratio 0.9765
2023-02-26 13:22:34.068: [Training]| Epochs  26 | Batch  4000  | ms/batch 0.03 | Loss 4.4442 | p1_Loss 0.5235 | p2_Loss 0.6888 | p3_Loss 3.1655 | p4_Loss 3.1655 | 
2023-02-26 13:22:34.068: real_rest_sum 324.3155 | real_rest_sum_int 416.0000 | all_sum 9966.0000 | rest_ratio 0.7796 | repeat_ratio 0.9923
2023-02-26 13:22:51.186: [Training]| Epochs  26 | Batch  4500  | ms/batch 0.04 | Loss 4.8069 | p1_Loss 0.5349 | p2_Loss 0.6889 | p3_Loss 3.5239 | p4_Loss 3.5239 | 
2023-02-26 13:22:51.186: real_rest_sum 466.4758 | real_rest_sum_int 604.0000 | all_sum 11174.0000 | rest_ratio 0.7723 | repeat_ratio 0.9779
2023-02-26 13:23:05.700: [Training]| Epochs  26 | Batch  5000  | ms/batch 0.03 | Loss 7.3954 | p1_Loss 0.6443 | p2_Loss 0.6921 | p3_Loss 6.0348 | p4_Loss 6.0348 | 
2023-02-26 13:23:05.700: real_rest_sum 97.7418 | real_rest_sum_int 123.0000 | all_sum 1303.0000 | rest_ratio 0.7946 | repeat_ratio 1.0000
2023-02-26 13:23:11.509: batch_num: 5179
2023-02-26 13:23:11.509: [Training]| Epochs  26 | loss_all  4.5924 | p1_all  0.5249 | p2_all  0.6874 | p3_all  3.3215 | p4_all  3.3215 | real_rest_ratio 0.0465 | repeat_ratio 0.9802 |
2023-02-26 13:23:27.335: 1
2023-02-26 13:23:27.336: valid_real_ratio_avg 0.0740 valid_neg_ratio_avg 0.0899 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 13:23:27.336: [Validation] neg_sample TOP5 [Test]| Epochs  26 | Hit ratio 0.9012 | recall 0.3376 |  precision 0.5416 | f1  0.3686 | ndcg  0.6163 | mrr  0.7861 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 13:23:27.336: [Validation] p_n_score_differences_avg 0.4082 
2023-02-26 13:23:27.336: ##############################################
2023-02-26 13:23:27.338: G1_flag 1 pretrain 1 temp 10.0 train_epoch 4  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:23:27.567: [Training]| Epochs  27 | Batch     0  | ms/batch 0.00 | Loss 3.3232 | p1_Loss 0.4778 | p2_Loss 0.6888 | p3_Loss 2.1028 | p4_Loss 2.1028 | 
2023-02-26 13:23:27.567: real_rest_sum 1043.7517 | real_rest_sum_int 1611.0000 | all_sum 23079.0000 | rest_ratio 0.6479 | repeat_ratio 0.9933
2023-02-26 13:23:43.636: [Training]| Epochs  27 | Batch   500  | ms/batch 0.03 | Loss 6.7617 | p1_Loss 0.6096 | p2_Loss 0.6907 | p3_Loss 5.4095 | p4_Loss 5.4095 | 
2023-02-26 13:23:43.636: real_rest_sum 190.5296 | real_rest_sum_int 292.0000 | all_sum 4362.0000 | rest_ratio 0.6525 | repeat_ratio 0.9902
2023-02-26 13:24:00.860: [Training]| Epochs  27 | Batch  1000  | ms/batch 0.03 | Loss 3.6314 | p1_Loss 0.4841 | p2_Loss 0.6867 | p3_Loss 2.3864 | p4_Loss 2.3864 | 
2023-02-26 13:24:00.861: real_rest_sum 753.0296 | real_rest_sum_int 1076.0000 | all_sum 31904.0000 | rest_ratio 0.6998 | repeat_ratio 0.9682
2023-02-26 13:24:16.741: [Training]| Epochs  27 | Batch  1500  | ms/batch 0.03 | Loss 6.9604 | p1_Loss 0.6100 | p2_Loss 0.6891 | p3_Loss 5.6103 | p4_Loss 5.6103 | 
2023-02-26 13:24:16.741: real_rest_sum 83.9531 | real_rest_sum_int 117.0000 | all_sum 1986.0000 | rest_ratio 0.7175 | repeat_ratio 0.9792
2023-02-26 13:24:32.591: [Training]| Epochs  27 | Batch  2000  | ms/batch 0.03 | Loss 8.4201 | p1_Loss 0.6594 | p2_Loss 0.6914 | p3_Loss 7.0058 | p4_Loss 7.0058 | 
2023-02-26 13:24:32.592: real_rest_sum 32.8655 | real_rest_sum_int 45.0000 | all_sum 1256.0000 | rest_ratio 0.7303 | repeat_ratio 1.0000
2023-02-26 13:24:47.573: [Training]| Epochs  27 | Batch  2500  | ms/batch 0.03 | Loss 3.2896 | p1_Loss 0.4661 | p2_Loss 0.6871 | p3_Loss 2.0729 | p4_Loss 2.0729 | 
2023-02-26 13:24:47.573: real_rest_sum 1048.0962 | real_rest_sum_int 1386.0000 | all_sum 32310.0000 | rest_ratio 0.7562 | repeat_ratio 0.9815
2023-02-26 13:25:04.772: [Training]| Epochs  27 | Batch  3000  | ms/batch 0.04 | Loss 4.1237 | p1_Loss 0.5011 | p2_Loss 0.6906 | p3_Loss 2.8521 | p4_Loss 2.8521 | 
2023-02-26 13:25:04.772: real_rest_sum 400.3058 | real_rest_sum_int 529.0000 | all_sum 16316.0000 | rest_ratio 0.7567 | repeat_ratio 0.9933
2023-02-26 13:25:21.184: [Training]| Epochs  27 | Batch  3500  | ms/batch 0.03 | Loss 4.0845 | p1_Loss 0.5076 | p2_Loss 0.6871 | p3_Loss 2.8291 | p4_Loss 2.8291 | 
2023-02-26 13:25:21.184: real_rest_sum 950.9353 | real_rest_sum_int 1235.0000 | all_sum 26005.0000 | rest_ratio 0.7700 | repeat_ratio 0.9945
2023-02-26 13:25:37.159: [Training]| Epochs  27 | Batch  4000  | ms/batch 0.03 | Loss 5.5526 | p1_Loss 0.5702 | p2_Loss 0.6825 | p3_Loss 4.2619 | p4_Loss 4.2619 | 
2023-02-26 13:25:37.159: real_rest_sum 323.5344 | real_rest_sum_int 439.0000 | all_sum 5597.0000 | rest_ratio 0.7370 | repeat_ratio 0.9876
2023-02-26 13:25:52.803: [Training]| Epochs  27 | Batch  4500  | ms/batch 0.03 | Loss 5.3175 | p1_Loss 0.5698 | p2_Loss 0.6905 | p3_Loss 3.9950 | p4_Loss 3.9950 | 
2023-02-26 13:25:52.803: real_rest_sum 187.2999 | real_rest_sum_int 231.0000 | all_sum 4466.0000 | rest_ratio 0.8108 | repeat_ratio 1.0000
2023-02-26 13:26:08.637: [Training]| Epochs  27 | Batch  5000  | ms/batch 0.03 | Loss 3.9078 | p1_Loss 0.5078 | p2_Loss 0.6884 | p3_Loss 2.6652 | p4_Loss 2.6652 | 
2023-02-26 13:26:08.637: real_rest_sum 1035.4900 | real_rest_sum_int 1334.0000 | all_sum 18943.0000 | rest_ratio 0.7762 | repeat_ratio 0.9823
2023-02-26 13:26:14.247: batch_num: 5179
2023-02-26 13:26:14.247: [Training]| Epochs  27 | loss_all  4.5983 | p1_all  0.5249 | p2_all  0.6874 | p3_all  3.3264 | p4_all  3.3264 | real_rest_ratio 0.0453 | repeat_ratio 0.9808 |
2023-02-26 13:26:30.035: 1
2023-02-26 13:26:30.036: valid_real_ratio_avg 0.0667 valid_neg_ratio_avg 0.0766 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 13:26:30.036: [Validation] neg_sample TOP5 [Test]| Epochs  27 | Hit ratio 0.8997 | recall 0.3414 |  precision 0.5497 | f1  0.3740 | ndcg  0.6219 | mrr  0.7864 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 13:26:30.036: [Validation] p_n_score_differences_avg 0.4152 
2023-02-26 13:26:30.036: ##############################################
2023-02-26 13:28:53.987: 1
2023-02-26 13:28:53.994: Epochs  27 topk   5  basket_length <4  num 714  Hit ratio 0.8081 | recall 0.5122 |  precision 0.3417 | f1  0.3727 | ndcg  0.5441 | mrr  0.6891 
2023-02-26 13:28:53.995: Epochs  27 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8537 | recall 0.4226 |  precision 0.4373 | f1  0.3956 | ndcg  0.5471 | mrr  0.7336 
2023-02-26 13:28:53.998: Epochs  27 topk   5  basket_length >6  num 4295  Hit ratio 0.9492 | recall 0.3307 |  precision 0.6335 | f1  0.4002 | ndcg  0.6765 | mrr  0.8342 
2023-02-26 13:28:53.998: ...............................................
2023-02-26 13:28:53.998: test_real_ratio_avg 0.0750 test_neg_ratio_avg 0.0736 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 13:28:53.998: neg_sample TOP5 [Test]| Epochs  27 | Hit ratio 0.9146 | recall 0.3692 |  precision 0.5623 | f1  0.3962 | ndcg  0.6364 | mrr  0.7982 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 13:28:53.998: [Test] p_n_score_differences_avg 0.4465 
2023-02-26 13:28:53.998: ##############################################
2023-02-26 13:28:54.000: Epochs  27 best_hit 0.9159 best_recall 0.3704 best_precision 0.5636 best_f1 0.3972 best_ndcg 0.6364  best_mrr 0.7982 
2023-02-26 13:28:54.000: Epochs  27 loss_all 4.5983 Hit ratio 0.9146 recall 0.3692 precision 0.5623 f1  0.3962 ndcg  0.6364 mrr  0.7982 avg_fake_length 5.0000
2023-02-26 13:28:54.002: G1_flag 0 pretrain 1 temp 10.0 train_epoch 0  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:28:54.223: [Training]| Epochs  28 | Batch     0  | ms/batch 0.00 | Loss 9.1691 | p1_Loss 0.4844 | p2_Loss 0.6886 | p3_Loss 2.2347 | p4_Loss 5.6928 | 
2023-02-26 13:28:54.223: real_rest_sum 1436.0016 | real_rest_sum_int 1483.0000 | all_sum 23079.0000 | rest_ratio 0.9683 | repeat_ratio 0.9848
2023-02-26 13:29:10.945: [Training]| Epochs  28 | Batch   500  | ms/batch 0.03 | Loss 10.1411 | p1_Loss 0.5053 | p2_Loss 0.6899 | p3_Loss 2.8645 | p4_Loss 5.9988 | 
2023-02-26 13:29:10.946: real_rest_sum 1396.6597 | real_rest_sum_int 1443.0000 | all_sum 27546.0000 | rest_ratio 0.9679 | repeat_ratio 0.9686
2023-02-26 13:29:27.992: [Training]| Epochs  28 | Batch  1000  | ms/batch 0.03 | Loss 8.5862 | p1_Loss 0.4838 | p2_Loss 0.6847 | p3_Loss 1.9605 | p4_Loss 5.3965 | 
2023-02-26 13:29:27.992: real_rest_sum 2712.1680 | real_rest_sum_int 2810.0000 | all_sum 42181.0000 | rest_ratio 0.9652 | repeat_ratio 0.9875
2023-02-26 13:29:43.150: [Training]| Epochs  28 | Batch  1500  | ms/batch 0.03 | Loss 12.9868 | p1_Loss 0.6150 | p2_Loss 0.6898 | p3_Loss 5.2224 | p4_Loss 6.4268 | 
2023-02-26 13:29:43.150: real_rest_sum 209.0973 | real_rest_sum_int 215.0000 | all_sum 3259.0000 | rest_ratio 0.9725 | repeat_ratio 1.0000
2023-02-26 13:29:58.991: [Training]| Epochs  28 | Batch  2000  | ms/batch 0.03 | Loss 8.8404 | p1_Loss 0.4637 | p2_Loss 0.6870 | p3_Loss 2.0198 | p4_Loss 5.6091 | 
2023-02-26 13:29:58.991: real_rest_sum 1902.2361 | real_rest_sum_int 1955.0000 | all_sum 35283.0000 | rest_ratio 0.9730 | repeat_ratio 0.9915
2023-02-26 13:30:14.985: [Training]| Epochs  28 | Batch  2500  | ms/batch 0.03 | Loss 10.1144 | p1_Loss 0.5332 | p2_Loss 0.6842 | p3_Loss 3.3873 | p4_Loss 5.4587 | 
2023-02-26 13:30:14.985: real_rest_sum 361.1658 | real_rest_sum_int 369.0000 | all_sum 4851.0000 | rest_ratio 0.9788 | repeat_ratio 0.9815
2023-02-26 13:30:31.852: [Training]| Epochs  28 | Batch  3000  | ms/batch 0.03 | Loss 8.6321 | p1_Loss 0.4853 | p2_Loss 0.6859 | p3_Loss 2.1622 | p4_Loss 5.2959 | 
2023-02-26 13:30:31.852: real_rest_sum 1274.3367 | real_rest_sum_int 1308.0000 | all_sum 15687.0000 | rest_ratio 0.9743 | repeat_ratio 0.9922
2023-02-26 13:30:49.025: [Training]| Epochs  28 | Batch  3500  | ms/batch 0.04 | Loss 9.9452 | p1_Loss 0.5054 | p2_Loss 0.6855 | p3_Loss 2.9000 | p4_Loss 5.8452 | 
2023-02-26 13:30:49.025: real_rest_sum 1354.4614 | real_rest_sum_int 1386.0000 | all_sum 17197.0000 | rest_ratio 0.9772 | repeat_ratio 0.9885
2023-02-26 13:31:06.232: [Training]| Epochs  28 | Batch  4000  | ms/batch 0.03 | Loss 10.9087 | p1_Loss 0.5338 | p2_Loss 0.6856 | p3_Loss 3.6712 | p4_Loss 5.9628 | 
2023-02-26 13:31:06.232: real_rest_sum 381.0519 | real_rest_sum_int 390.0000 | all_sum 6033.0000 | rest_ratio 0.9771 | repeat_ratio 0.9974
2023-02-26 13:31:22.782: [Training]| Epochs  28 | Batch  4500  | ms/batch 0.03 | Loss 12.9266 | p1_Loss 0.6121 | p2_Loss 0.6900 | p3_Loss 4.8361 | p4_Loss 6.7884 | 
2023-02-26 13:31:22.782: real_rest_sum 404.4634 | real_rest_sum_int 415.0000 | all_sum 4272.0000 | rest_ratio 0.9746 | repeat_ratio 1.0000
2023-02-26 13:31:39.369: [Training]| Epochs  28 | Batch  5000  | ms/batch 0.03 | Loss 8.6391 | p1_Loss 0.4854 | p2_Loss 0.6843 | p3_Loss 2.1965 | p4_Loss 5.2357 | 
2023-02-26 13:31:39.369: real_rest_sum 685.7912 | real_rest_sum_int 701.0000 | all_sum 11179.0000 | rest_ratio 0.9783 | repeat_ratio 0.9792
2023-02-26 13:31:45.557: batch_num: 5179
2023-02-26 13:31:45.557: [Training]| Epochs  28 | loss_all  10.2377 | p1_all  0.5281 | p2_all  0.6876 | p3_all  3.2157 | p4_all  5.7622 | real_rest_ratio 0.0641 | repeat_ratio 0.9848 |
2023-02-26 13:32:01.416: 1
2023-02-26 13:32:01.416: valid_real_ratio_avg 0.0780 valid_neg_ratio_avg 0.0956 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 13:32:01.417: [Validation] neg_sample TOP5 [Test]| Epochs  28 | Hit ratio 0.9084 | recall 0.3434 |  precision 0.5506 | f1  0.3758 | ndcg  0.6202 | mrr  0.7888 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 13:32:01.417: [Validation] p_n_score_differences_avg 0.4106 
2023-02-26 13:32:01.417: ##############################################
2023-02-26 13:34:26.774: 1
2023-02-26 13:34:26.782: Epochs  28 topk   5  basket_length <4  num 714  Hit ratio 0.8165 | recall 0.5219 |  precision 0.3454 | f1  0.3785 | ndcg  0.5502 | mrr  0.6915 
2023-02-26 13:34:26.783: Epochs  28 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8545 | recall 0.4211 |  precision 0.4345 | f1  0.3935 | ndcg  0.5439 | mrr  0.7317 
2023-02-26 13:34:26.786: Epochs  28 topk   5  basket_length >6  num 4295  Hit ratio 0.9502 | recall 0.3321 |  precision 0.6366 | f1  0.4021 | ndcg  0.6780 | mrr  0.8338 
2023-02-26 13:34:26.786: ...............................................
2023-02-26 13:34:26.786: test_real_ratio_avg 0.0861 test_neg_ratio_avg 0.0921 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 13:34:26.786: neg_sample TOP5 [Test]| Epochs  28 | Hit ratio 0.9164 | recall 0.3710 |  precision 0.5642 | f1  0.3978 | ndcg  0.6375 | mrr  0.7979 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 13:34:26.786: [Test] p_n_score_differences_avg 0.4404 
2023-02-26 13:34:26.786: ##############################################
2023-02-26 13:34:26.888: Save model as ./runs/model_1_Instacart_t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5.pt
2023-02-26 13:34:26.888: Epochs  28 best_hit 0.9164 best_recall 0.3710 best_precision 0.5642 best_f1 0.3978 best_ndcg 0.6375  best_mrr 0.7982 
2023-02-26 13:34:26.888: Epochs  28 loss_all 10.2377 Hit ratio 0.9164 recall 0.3710 precision 0.5642 f1  0.3978 ndcg  0.6375 mrr  0.7979 avg_fake_length 5.0000
2023-02-26 13:34:26.890: G1_flag 0 pretrain 1 temp 10.0 train_epoch 1  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:34:27.108: [Training]| Epochs  29 | Batch     0  | ms/batch 0.00 | Loss 8.3208 | p1_Loss 0.4773 | p2_Loss 0.6892 | p3_Loss 1.6759 | p4_Loss 5.4321 | 
2023-02-26 13:34:27.108: real_rest_sum 2409.7866 | real_rest_sum_int 2479.0000 | all_sum 33238.0000 | rest_ratio 0.9721 | repeat_ratio 0.9844
2023-02-26 13:34:42.574: [Training]| Epochs  29 | Batch   500  | ms/batch 0.03 | Loss 14.1814 | p1_Loss 0.6327 | p2_Loss 0.6923 | p3_Loss 5.9604 | p4_Loss 6.7896 | 
2023-02-26 13:34:42.575: real_rest_sum 68.9077 | real_rest_sum_int 70.0000 | all_sum 1521.0000 | rest_ratio 0.9844 | repeat_ratio 0.9706
2023-02-26 13:34:59.813: [Training]| Epochs  29 | Batch  1000  | ms/batch 0.04 | Loss 8.3152 | p1_Loss 0.4952 | p2_Loss 0.6854 | p3_Loss 2.1456 | p4_Loss 4.9838 | 
2023-02-26 13:34:59.814: real_rest_sum 2031.1377 | real_rest_sum_int 2088.0000 | all_sum 22108.0000 | rest_ratio 0.9728 | repeat_ratio 0.9917
2023-02-26 13:35:15.481: [Training]| Epochs  29 | Batch  1500  | ms/batch 0.03 | Loss 10.4677 | p1_Loss 0.5383 | p2_Loss 0.6909 | p3_Loss 3.2351 | p4_Loss 5.9506 | 
2023-02-26 13:35:15.481: real_rest_sum 595.4179 | real_rest_sum_int 617.0000 | all_sum 9981.0000 | rest_ratio 0.9650 | repeat_ratio 0.9887
2023-02-26 13:35:33.028: [Training]| Epochs  29 | Batch  2000  | ms/batch 0.04 | Loss 8.1193 | p1_Loss 0.4428 | p2_Loss 0.6883 | p3_Loss 1.7101 | p4_Loss 5.2166 | 
2023-02-26 13:35:33.029: real_rest_sum 2829.4392 | real_rest_sum_int 2907.0000 | all_sum 44143.0000 | rest_ratio 0.9733 | repeat_ratio 0.9932
2023-02-26 13:35:49.100: [Training]| Epochs  29 | Batch  2500  | ms/batch 0.03 | Loss 11.1409 | p1_Loss 0.5724 | p2_Loss 0.6896 | p3_Loss 3.9940 | p4_Loss 5.8342 | 
2023-02-26 13:35:49.101: real_rest_sum 200.3524 | real_rest_sum_int 207.0000 | all_sum 3117.0000 | rest_ratio 0.9679 | repeat_ratio 0.9922
2023-02-26 13:36:06.510: [Training]| Epochs  29 | Batch  3000  | ms/batch 0.04 | Loss 10.9807 | p1_Loss 0.5420 | p2_Loss 0.6908 | p3_Loss 3.4616 | p4_Loss 6.2429 | 
2023-02-26 13:36:06.510: real_rest_sum 1029.5747 | real_rest_sum_int 1061.0000 | all_sum 13680.0000 | rest_ratio 0.9704 | repeat_ratio 0.9871
2023-02-26 13:36:24.635: [Training]| Epochs  29 | Batch  3500  | ms/batch 0.04 | Loss 8.9963 | p1_Loss 0.4857 | p2_Loss 0.6852 | p3_Loss 2.4640 | p4_Loss 5.3193 | 
2023-02-26 13:36:24.636: real_rest_sum 766.8059 | real_rest_sum_int 783.0000 | all_sum 11358.0000 | rest_ratio 0.9793 | repeat_ratio 0.9812
2023-02-26 13:36:41.462: [Training]| Epochs  29 | Batch  4000  | ms/batch 0.03 | Loss 9.4382 | p1_Loss 0.5026 | p2_Loss 0.6874 | p3_Loss 2.6873 | p4_Loss 5.4916 | 
2023-02-26 13:36:41.462: real_rest_sum 925.9950 | real_rest_sum_int 961.0000 | all_sum 16003.0000 | rest_ratio 0.9636 | repeat_ratio 0.9936
2023-02-26 13:36:57.454: [Training]| Epochs  29 | Batch  4500  | ms/batch 0.03 | Loss 11.5813 | p1_Loss 0.5775 | p2_Loss 0.6870 | p3_Loss 4.3319 | p4_Loss 5.9698 | 
2023-02-26 13:36:57.454: real_rest_sum 294.4841 | real_rest_sum_int 302.0000 | all_sum 3721.0000 | rest_ratio 0.9751 | repeat_ratio 0.9921
2023-02-26 13:37:13.272: [Training]| Epochs  29 | Batch  5000  | ms/batch 0.03 | Loss 11.1991 | p1_Loss 0.5517 | p2_Loss 0.6889 | p3_Loss 3.8089 | p4_Loss 6.0939 | 
2023-02-26 13:37:13.273: real_rest_sum 516.9642 | real_rest_sum_int 533.0000 | all_sum 8848.0000 | rest_ratio 0.9699 | repeat_ratio 0.9954
2023-02-26 13:37:18.766: batch_num: 5179
2023-02-26 13:37:18.766: [Training]| Epochs  29 | loss_all  10.2059 | p1_all  0.5261 | p2_all  0.6877 | p3_all  3.1857 | p4_all  5.7620 | real_rest_ratio 0.0636 | repeat_ratio 0.9855 |
2023-02-26 13:37:34.807: 1
2023-02-26 13:37:34.808: valid_real_ratio_avg 0.0769 valid_neg_ratio_avg 0.0952 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 13:37:34.808: [Validation] neg_sample TOP5 [Test]| Epochs  29 | Hit ratio 0.8968 | recall 0.3378 |  precision 0.5442 | f1  0.3710 | ndcg  0.6173 | mrr  0.7936 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 13:37:34.808: [Validation] p_n_score_differences_avg 0.4205 
2023-02-26 13:37:34.808: ##############################################
2023-02-26 13:37:34.810: G1_flag 0 pretrain 1 temp 10.0 train_epoch 2  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:37:35.034: [Training]| Epochs  30 | Batch     0  | ms/batch 0.00 | Loss 9.3012 | p1_Loss 0.5045 | p2_Loss 0.6905 | p3_Loss 2.3004 | p4_Loss 5.8012 | 
2023-02-26 13:37:35.034: real_rest_sum 1348.5769 | real_rest_sum_int 1387.0000 | all_sum 15421.0000 | rest_ratio 0.9723 | repeat_ratio 1.0000
2023-02-26 13:37:52.528: [Training]| Epochs  30 | Batch   500  | ms/batch 0.04 | Loss 9.2492 | p1_Loss 0.5201 | p2_Loss 0.6892 | p3_Loss 2.5149 | p4_Loss 5.4632 | 
2023-02-26 13:37:52.528: real_rest_sum 1188.1934 | real_rest_sum_int 1226.0000 | all_sum 19377.0000 | rest_ratio 0.9692 | repeat_ratio 0.9953
2023-02-26 13:38:10.200: [Training]| Epochs  30 | Batch  1000  | ms/batch 0.04 | Loss 11.1655 | p1_Loss 0.5588 | p2_Loss 0.6885 | p3_Loss 3.6416 | p4_Loss 6.2003 | 
2023-02-26 13:38:10.200: real_rest_sum 554.2092 | real_rest_sum_int 575.0000 | all_sum 10647.0000 | rest_ratio 0.9638 | repeat_ratio 0.9885
2023-02-26 13:38:26.672: [Training]| Epochs  30 | Batch  1500  | ms/batch 0.03 | Loss 9.9388 | p1_Loss 0.5199 | p2_Loss 0.6890 | p3_Loss 2.9489 | p4_Loss 5.7179 | 
2023-02-26 13:38:26.673: real_rest_sum 1039.3751 | real_rest_sum_int 1073.0000 | all_sum 20458.0000 | rest_ratio 0.9687 | repeat_ratio 0.9879
2023-02-26 13:38:45.325: [Training]| Epochs  30 | Batch  2000  | ms/batch 0.04 | Loss 7.6196 | p1_Loss 0.4591 | p2_Loss 0.6832 | p3_Loss 1.5316 | p4_Loss 4.9292 | 
2023-02-26 13:38:45.325: real_rest_sum 1936.1577 | real_rest_sum_int 1992.0000 | all_sum 24610.0000 | rest_ratio 0.9720 | repeat_ratio 0.9882
2023-02-26 13:39:00.920: [Training]| Epochs  30 | Batch  2500  | ms/batch 0.03 | Loss 14.7562 | p1_Loss 0.6369 | p2_Loss 0.6909 | p3_Loss 6.4499 | p4_Loss 6.9662 | 
2023-02-26 13:39:00.921: real_rest_sum 91.0871 | real_rest_sum_int 93.0000 | all_sum 1243.0000 | rest_ratio 0.9794 | repeat_ratio 1.0000
2023-02-26 13:39:19.120: [Training]| Epochs  30 | Batch  3000  | ms/batch 0.04 | Loss 11.0828 | p1_Loss 0.5588 | p2_Loss 0.6883 | p3_Loss 3.9043 | p4_Loss 5.8929 | 
2023-02-26 13:39:19.121: real_rest_sum 362.6849 | real_rest_sum_int 374.0000 | all_sum 4926.0000 | rest_ratio 0.9697 | repeat_ratio 0.9892
2023-02-26 13:39:34.234: [Training]| Epochs  30 | Batch  3500  | ms/batch 0.03 | Loss 12.2274 | p1_Loss 0.5899 | p2_Loss 0.6877 | p3_Loss 4.5669 | p4_Loss 6.3728 | 
2023-02-26 13:39:34.234: real_rest_sum 459.0656 | real_rest_sum_int 473.0000 | all_sum 4926.0000 | rest_ratio 0.9705 | repeat_ratio 1.0000
2023-02-26 13:39:50.661: [Training]| Epochs  30 | Batch  4000  | ms/batch 0.03 | Loss 8.8032 | p1_Loss 0.4742 | p2_Loss 0.6893 | p3_Loss 1.9314 | p4_Loss 5.6810 | 
2023-02-26 13:39:50.661: real_rest_sum 2427.0630 | real_rest_sum_int 2493.0000 | all_sum 32217.0000 | rest_ratio 0.9736 | repeat_ratio 0.9911
2023-02-26 13:40:07.417: [Training]| Epochs  30 | Batch  4500  | ms/batch 0.03 | Loss 9.1523 | p1_Loss 0.4688 | p2_Loss 0.6901 | p3_Loss 2.0956 | p4_Loss 5.7999 | 
2023-02-26 13:40:07.418: real_rest_sum 1658.4720 | real_rest_sum_int 1705.0000 | all_sum 40333.0000 | rest_ratio 0.9727 | repeat_ratio 0.9893
2023-02-26 13:40:23.038: [Training]| Epochs  30 | Batch  5000  | ms/batch 0.03 | Loss 12.6997 | p1_Loss 0.6010 | p2_Loss 0.6897 | p3_Loss 5.0085 | p4_Loss 6.4004 | 
2023-02-26 13:40:23.039: real_rest_sum 175.3068 | real_rest_sum_int 180.0000 | all_sum 1986.0000 | rest_ratio 0.9739 | repeat_ratio 1.0000
2023-02-26 13:40:28.344: batch_num: 5179
2023-02-26 13:40:28.344: [Training]| Epochs  30 | loss_all  10.1684 | p1_all  0.5249 | p2_all  0.6876 | p3_all  3.1572 | p4_all  5.7539 | real_rest_ratio 0.0634 | repeat_ratio 0.9864 |
2023-02-26 13:40:44.213: 1
2023-02-26 13:40:44.214: valid_real_ratio_avg 0.0776 valid_neg_ratio_avg 0.0947 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 13:40:44.214: [Validation] neg_sample TOP5 [Test]| Epochs  30 | Hit ratio 0.9055 | recall 0.3466 |  precision 0.5529 | f1  0.3782 | ndcg  0.6238 | mrr  0.7896 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 13:40:44.214: [Validation] p_n_score_differences_avg 0.4344 
2023-02-26 13:40:44.214: ##############################################
2023-02-26 13:43:08.152: 1
2023-02-26 13:43:08.158: Epochs  30 topk   5  basket_length <4  num 714  Hit ratio 0.8179 | recall 0.5125 |  precision 0.3398 | f1  0.3712 | ndcg  0.5472 | mrr  0.6987 
2023-02-26 13:43:08.159: Epochs  30 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8427 | recall 0.4159 |  precision 0.4272 | f1  0.3870 | ndcg  0.5372 | mrr  0.7222 
2023-02-26 13:43:08.162: Epochs  30 topk   5  basket_length >6  num 4295  Hit ratio 0.9451 | recall 0.3283 |  precision 0.6287 | f1  0.3974 | ndcg  0.6701 | mrr  0.8274 
2023-02-26 13:43:08.162: ...............................................
2023-02-26 13:43:08.162: test_real_ratio_avg 0.0861 test_neg_ratio_avg 0.0917 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 13:43:08.162: neg_sample TOP5 [Test]| Epochs  30 | Hit ratio 0.9108 | recall 0.3663 |  precision 0.5568 | f1  0.3924 | ndcg  0.6305 | mrr  0.7924 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 13:43:08.162: [Test] p_n_score_differences_avg 0.4578 
2023-02-26 13:43:08.162: ##############################################
2023-02-26 13:43:08.164: Epochs  30 best_hit 0.9164 best_recall 0.3710 best_precision 0.5642 best_f1 0.3978 best_ndcg 0.6375  best_mrr 0.7982 
2023-02-26 13:43:08.164: Epochs  30 loss_all 10.1684 Hit ratio 0.9108 recall 0.3663 precision 0.5568 f1  0.3924 ndcg  0.6305 mrr  0.7924 avg_fake_length 5.0000
2023-02-26 13:43:08.165: G1_flag 0 pretrain 1 temp 10.0 train_epoch 3  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:43:08.303: [Training]| Epochs  31 | Batch     0  | ms/batch 0.00 | Loss 12.7547 | p1_Loss 0.5949 | p2_Loss 0.6920 | p3_Loss 5.0276 | p4_Loss 6.3616 | 
2023-02-26 13:43:08.303: real_rest_sum 187.5746 | real_rest_sum_int 194.0000 | all_sum 3361.0000 | rest_ratio 0.9669 | repeat_ratio 1.0000
2023-02-26 13:43:23.307: [Training]| Epochs  31 | Batch   500  | ms/batch 0.03 | Loss 9.2584 | p1_Loss 0.5297 | p2_Loss 0.6819 | p3_Loss 2.9654 | p4_Loss 5.0605 | 
2023-02-26 13:43:23.307: real_rest_sum 461.6377 | real_rest_sum_int 472.0000 | all_sum 5999.0000 | rest_ratio 0.9780 | repeat_ratio 0.9935
2023-02-26 13:43:41.109: [Training]| Epochs  31 | Batch  1000  | ms/batch 0.04 | Loss 9.4313 | p1_Loss 0.4862 | p2_Loss 0.6909 | p3_Loss 2.2068 | p4_Loss 5.9817 | 
2023-02-26 13:43:41.109: real_rest_sum 1642.7589 | real_rest_sum_int 1689.0000 | all_sum 30476.0000 | rest_ratio 0.9726 | repeat_ratio 0.9939
2023-02-26 13:43:58.365: [Training]| Epochs  31 | Batch  1500  | ms/batch 0.04 | Loss 9.0864 | p1_Loss 0.4901 | p2_Loss 0.6841 | p3_Loss 2.3886 | p4_Loss 5.4985 | 
2023-02-26 13:43:58.365: real_rest_sum 1421.7380 | real_rest_sum_int 1458.0000 | all_sum 18316.0000 | rest_ratio 0.9751 | repeat_ratio 0.9879
2023-02-26 13:44:14.203: [Training]| Epochs  31 | Batch  2000  | ms/batch 0.03 | Loss 11.6769 | p1_Loss 0.5885 | p2_Loss 0.6850 | p3_Loss 4.4895 | p4_Loss 5.9139 | 
2023-02-26 13:44:14.204: real_rest_sum 301.8146 | real_rest_sum_int 309.0000 | all_sum 3419.0000 | rest_ratio 0.9767 | repeat_ratio 1.0000
2023-02-26 13:44:30.565: [Training]| Epochs  31 | Batch  2500  | ms/batch 0.03 | Loss 15.8465 | p1_Loss 0.6750 | p2_Loss 0.6926 | p3_Loss 7.1723 | p4_Loss 7.3065 | 
2023-02-26 13:44:30.566: real_rest_sum 149.8162 | real_rest_sum_int 156.0000 | all_sum 1223.0000 | rest_ratio 0.9604 | repeat_ratio 1.0000
2023-02-26 13:44:46.356: [Training]| Epochs  31 | Batch  3000  | ms/batch 0.03 | Loss 8.2805 | p1_Loss 0.4447 | p2_Loss 0.6857 | p3_Loss 1.8886 | p4_Loss 5.1900 | 
2023-02-26 13:44:46.356: real_rest_sum 1435.7932 | real_rest_sum_int 1472.0000 | all_sum 29973.0000 | rest_ratio 0.9754 | repeat_ratio 0.9908
2023-02-26 13:45:02.654: [Training]| Epochs  31 | Batch  3500  | ms/batch 0.03 | Loss 11.3551 | p1_Loss 0.5738 | p2_Loss 0.6869 | p3_Loss 4.2346 | p4_Loss 5.8357 | 
2023-02-26 13:45:02.654: real_rest_sum 402.8171 | real_rest_sum_int 417.0000 | all_sum 5177.0000 | rest_ratio 0.9660 | repeat_ratio 0.9508
2023-02-26 13:45:19.142: [Training]| Epochs  31 | Batch  4000  | ms/batch 0.03 | Loss 9.0500 | p1_Loss 0.4965 | p2_Loss 0.6818 | p3_Loss 2.5307 | p4_Loss 5.3379 | 
2023-02-26 13:45:19.142: real_rest_sum 565.5961 | real_rest_sum_int 580.0000 | all_sum 7093.0000 | rest_ratio 0.9752 | repeat_ratio 0.9892
2023-02-26 13:45:36.283: [Training]| Epochs  31 | Batch  4500  | ms/batch 0.03 | Loss 10.7028 | p1_Loss 0.5380 | p2_Loss 0.6842 | p3_Loss 3.7714 | p4_Loss 5.6826 | 
2023-02-26 13:45:36.284: real_rest_sum 531.9230 | real_rest_sum_int 547.0000 | all_sum 7017.0000 | rest_ratio 0.9724 | repeat_ratio 0.9923
2023-02-26 13:45:53.818: [Training]| Epochs  31 | Batch  5000  | ms/batch 0.04 | Loss 7.2274 | p1_Loss 0.4069 | p2_Loss 0.6889 | p3_Loss 0.8932 | p4_Loss 5.1475 | 
2023-02-26 13:45:53.818: real_rest_sum 1996.1484 | real_rest_sum_int 2056.0000 | all_sum 43139.0000 | rest_ratio 0.9709 | repeat_ratio 0.9845
2023-02-26 13:46:00.010: batch_num: 5179
2023-02-26 13:46:00.010: [Training]| Epochs  31 | loss_all  10.1324 | p1_all  0.5244 | p2_all  0.6875 | p3_all  3.1450 | p4_all  5.7300 | real_rest_ratio 0.0629 | repeat_ratio 0.9862 |
2023-02-26 13:46:15.908: 1
2023-02-26 13:46:15.909: valid_real_ratio_avg 0.0776 valid_neg_ratio_avg 0.0969 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 13:46:15.909: [Validation] neg_sample TOP5 [Test]| Epochs  31 | Hit ratio 0.8997 | recall 0.3416 |  precision 0.5512 | f1  0.3756 | ndcg  0.6179 | mrr  0.7780 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 13:46:15.909: [Validation] p_n_score_differences_avg 0.4028 
2023-02-26 13:46:15.909: ##############################################
2023-02-26 13:46:15.911: G1_flag 0 pretrain 1 temp 10.0 train_epoch 4  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:46:16.137: [Training]| Epochs  32 | Batch     0  | ms/batch 0.00 | Loss 10.1045 | p1_Loss 0.5452 | p2_Loss 0.6887 | p3_Loss 3.2538 | p4_Loss 5.6032 | 
2023-02-26 13:46:16.138: real_rest_sum 609.8120 | real_rest_sum_int 625.0000 | all_sum 7937.0000 | rest_ratio 0.9757 | repeat_ratio 0.9842
2023-02-26 13:46:32.267: [Training]| Epochs  32 | Batch   500  | ms/batch 0.03 | Loss 12.4176 | p1_Loss 0.6072 | p2_Loss 0.6884 | p3_Loss 4.9985 | p4_Loss 6.0712 | 
2023-02-26 13:46:32.267: real_rest_sum 158.2512 | real_rest_sum_int 164.0000 | all_sum 2955.0000 | rest_ratio 0.9649 | repeat_ratio 0.9688
2023-02-26 13:46:49.405: [Training]| Epochs  32 | Batch  1000  | ms/batch 0.03 | Loss 11.8811 | p1_Loss 0.5793 | p2_Loss 0.6877 | p3_Loss 4.5210 | p4_Loss 6.0349 | 
2023-02-26 13:46:49.406: real_rest_sum 251.3152 | real_rest_sum_int 257.0000 | all_sum 4116.0000 | rest_ratio 0.9779 | repeat_ratio 0.9846
2023-02-26 13:47:04.735: [Training]| Epochs  32 | Batch  1500  | ms/batch 0.03 | Loss 10.3774 | p1_Loss 0.5271 | p2_Loss 0.6846 | p3_Loss 3.0903 | p4_Loss 6.0623 | 
2023-02-26 13:47:04.735: real_rest_sum 534.6424 | real_rest_sum_int 549.0000 | all_sum 7063.0000 | rest_ratio 0.9738 | repeat_ratio 0.9966
2023-02-26 13:47:22.218: [Training]| Epochs  32 | Batch  2000  | ms/batch 0.04 | Loss 8.4673 | p1_Loss 0.4553 | p2_Loss 0.6899 | p3_Loss 1.6517 | p4_Loss 5.5688 | 
2023-02-26 13:47:22.218: real_rest_sum 1949.0197 | real_rest_sum_int 2011.0000 | all_sum 43332.0000 | rest_ratio 0.9692 | repeat_ratio 0.9863
2023-02-26 13:47:39.855: [Training]| Epochs  32 | Batch  2500  | ms/batch 0.04 | Loss 7.3141 | p1_Loss 0.4211 | p2_Loss 0.6871 | p3_Loss 1.2328 | p4_Loss 4.9011 | 
2023-02-26 13:47:39.856: real_rest_sum 1665.3595 | real_rest_sum_int 1713.0000 | all_sum 30400.0000 | rest_ratio 0.9722 | repeat_ratio 0.9900
2023-02-26 13:47:56.274: [Training]| Epochs  32 | Batch  3000  | ms/batch 0.03 | Loss 13.7692 | p1_Loss 0.6319 | p2_Loss 0.6913 | p3_Loss 5.8237 | p4_Loss 6.5921 | 
2023-02-26 13:47:56.274: real_rest_sum 101.6795 | real_rest_sum_int 104.0000 | all_sum 1210.0000 | rest_ratio 0.9777 | repeat_ratio 1.0000
2023-02-26 13:48:11.826: [Training]| Epochs  32 | Batch  3500  | ms/batch 0.03 | Loss 9.6606 | p1_Loss 0.5135 | p2_Loss 0.6866 | p3_Loss 2.8027 | p4_Loss 5.6043 | 
2023-02-26 13:48:11.826: real_rest_sum 642.3905 | real_rest_sum_int 660.0000 | all_sum 10038.0000 | rest_ratio 0.9733 | repeat_ratio 0.9908
2023-02-26 13:48:27.779: [Training]| Epochs  32 | Batch  4000  | ms/batch 0.03 | Loss 9.1747 | p1_Loss 0.4811 | p2_Loss 0.6907 | p3_Loss 2.1119 | p4_Loss 5.7888 | 
2023-02-26 13:48:27.779: real_rest_sum 1294.4244 | real_rest_sum_int 1335.0000 | all_sum 28348.0000 | rest_ratio 0.9696 | repeat_ratio 0.9922
2023-02-26 13:48:43.787: [Training]| Epochs  32 | Batch  4500  | ms/batch 0.03 | Loss 8.1435 | p1_Loss 0.4621 | p2_Loss 0.6867 | p3_Loss 1.7040 | p4_Loss 5.2324 | 
2023-02-26 13:48:43.787: real_rest_sum 1402.4561 | real_rest_sum_int 1442.0000 | all_sum 24341.0000 | rest_ratio 0.9726 | repeat_ratio 0.9913
2023-02-26 13:49:00.499: [Training]| Epochs  32 | Batch  5000  | ms/batch 0.03 | Loss 8.6138 | p1_Loss 0.4728 | p2_Loss 0.6895 | p3_Loss 1.8704 | p4_Loss 5.5117 | 
2023-02-26 13:49:00.499: real_rest_sum 1737.1833 | real_rest_sum_int 1786.0000 | all_sum 31131.0000 | rest_ratio 0.9727 | repeat_ratio 0.9950
2023-02-26 13:49:07.031: batch_num: 5179
2023-02-26 13:49:07.031: [Training]| Epochs  32 | loss_all  10.1209 | p1_all  0.5237 | p2_all  0.6876 | p3_all  3.1305 | p4_all  5.7344 | real_rest_ratio 0.0633 | repeat_ratio 0.9867 |
2023-02-26 13:49:22.948: 1
2023-02-26 13:49:22.948: valid_real_ratio_avg 0.0774 valid_neg_ratio_avg 0.0971 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 13:49:22.949: [Validation] neg_sample TOP5 [Test]| Epochs  32 | Hit ratio 0.9041 | recall 0.3414 |  precision 0.5509 | f1  0.3747 | ndcg  0.6194 | mrr  0.7794 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 13:49:22.949: [Validation] p_n_score_differences_avg 0.4128 
2023-02-26 13:49:22.949: ##############################################
2023-02-26 13:51:47.081: 1
2023-02-26 13:51:47.089: Epochs  32 topk   5  basket_length <4  num 714  Hit ratio 0.8193 | recall 0.5117 |  precision 0.3403 | f1  0.3714 | ndcg  0.5472 | mrr  0.6982 
2023-02-26 13:51:47.090: Epochs  32 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8503 | recall 0.4171 |  precision 0.4331 | f1  0.3912 | ndcg  0.5445 | mrr  0.7342 
2023-02-26 13:51:47.093: Epochs  32 topk   5  basket_length >6  num 4295  Hit ratio 0.9471 | recall 0.3310 |  precision 0.6359 | f1  0.4012 | ndcg  0.6772 | mrr  0.8317 
2023-02-26 13:51:47.093: ...............................................
2023-02-26 13:51:47.093: test_real_ratio_avg 0.0872 test_neg_ratio_avg 0.0944 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 13:51:47.093: neg_sample TOP5 [Test]| Epochs  32 | Hit ratio 0.9138 | recall 0.3683 |  precision 0.5630 | f1  0.3959 | ndcg  0.6367 | mrr  0.7976 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 13:51:47.093: [Test] p_n_score_differences_avg 0.4467 
2023-02-26 13:51:47.093: ##############################################
2023-02-26 13:51:47.095: Epochs  32 best_hit 0.9164 best_recall 0.3710 best_precision 0.5642 best_f1 0.3978 best_ndcg 0.6375  best_mrr 0.7982 
2023-02-26 13:51:47.095: Epochs  32 loss_all 10.1209 Hit ratio 0.9138 recall 0.3683 precision 0.5630 f1  0.3959 ndcg  0.6367 mrr  0.7976 avg_fake_length 5.0000
2023-02-26 13:51:47.097: G1_flag 1 pretrain 1 temp 10.0 train_epoch 0  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:51:47.297: [Training]| Epochs  33 | Batch     0  | ms/batch 0.00 | Loss 2.7018 | p1_Loss 0.4312 | p2_Loss 0.6823 | p3_Loss 1.5341 | p4_Loss 1.5341 | 
2023-02-26 13:51:47.297: real_rest_sum 1110.8899 | real_rest_sum_int 1667.0000 | all_sum 27864.0000 | rest_ratio 0.6664 | repeat_ratio 0.9849
2023-02-26 13:52:03.659: [Training]| Epochs  33 | Batch   500  | ms/batch 0.03 | Loss 2.7783 | p1_Loss 0.4417 | p2_Loss 0.6828 | p3_Loss 1.5917 | p4_Loss 1.5917 | 
2023-02-26 13:52:03.660: real_rest_sum 1244.6973 | real_rest_sum_int 1841.0000 | all_sum 40349.0000 | rest_ratio 0.6761 | repeat_ratio 0.9788
2023-02-26 13:52:19.272: [Training]| Epochs  33 | Batch  1000  | ms/batch 0.03 | Loss 8.5775 | p1_Loss 0.6628 | p2_Loss 0.6900 | p3_Loss 7.1722 | p4_Loss 7.1722 | 
2023-02-26 13:52:19.272: real_rest_sum 48.8705 | real_rest_sum_int 72.0000 | all_sum 1265.0000 | rest_ratio 0.6788 | repeat_ratio 0.9615
2023-02-26 13:52:34.613: [Training]| Epochs  33 | Batch  1500  | ms/batch 0.03 | Loss 3.9337 | p1_Loss 0.4986 | p2_Loss 0.6865 | p3_Loss 2.6754 | p4_Loss 2.6754 | 
2023-02-26 13:52:34.613: real_rest_sum 569.8675 | real_rest_sum_int 843.0000 | all_sum 22859.0000 | rest_ratio 0.6760 | repeat_ratio 0.9701
2023-02-26 13:52:52.165: [Training]| Epochs  33 | Batch  2000  | ms/batch 0.04 | Loss 3.7759 | p1_Loss 0.4738 | p2_Loss 0.6852 | p3_Loss 2.5507 | p4_Loss 2.5507 | 
2023-02-26 13:52:52.165: real_rest_sum 982.6461 | real_rest_sum_int 1370.0000 | all_sum 31856.0000 | rest_ratio 0.7173 | repeat_ratio 0.9907
2023-02-26 13:53:08.351: [Training]| Epochs  33 | Batch  2500  | ms/batch 0.03 | Loss 6.3558 | p1_Loss 0.6020 | p2_Loss 0.6859 | p3_Loss 5.0291 | p4_Loss 5.0291 | 
2023-02-26 13:53:08.352: real_rest_sum 127.7790 | real_rest_sum_int 169.0000 | all_sum 2629.0000 | rest_ratio 0.7561 | repeat_ratio 0.9655
2023-02-26 13:53:24.560: [Training]| Epochs  33 | Batch  3000  | ms/batch 0.03 | Loss 5.6090 | p1_Loss 0.5560 | p2_Loss 0.6876 | p3_Loss 4.3025 | p4_Loss 4.3025 | 
2023-02-26 13:53:24.560: real_rest_sum 271.1431 | real_rest_sum_int 375.0000 | all_sum 10350.0000 | rest_ratio 0.7230 | repeat_ratio 0.9924
2023-02-26 13:53:40.229: [Training]| Epochs  33 | Batch  3500  | ms/batch 0.03 | Loss 6.1773 | p1_Loss 0.5857 | p2_Loss 0.6881 | p3_Loss 4.8438 | p4_Loss 4.8438 | 
2023-02-26 13:53:40.229: real_rest_sum 184.8753 | real_rest_sum_int 244.0000 | all_sum 5907.0000 | rest_ratio 0.7577 | repeat_ratio 0.9911
2023-02-26 13:53:55.117: [Training]| Epochs  33 | Batch  4000  | ms/batch 0.03 | Loss 6.5251 | p1_Loss 0.6003 | p2_Loss 0.6853 | p3_Loss 5.2001 | p4_Loss 5.2001 | 
2023-02-26 13:53:55.117: real_rest_sum 147.0249 | real_rest_sum_int 188.0000 | all_sum 3543.0000 | rest_ratio 0.7820 | repeat_ratio 0.9636
2023-02-26 13:54:12.037: [Training]| Epochs  33 | Batch  4500  | ms/batch 0.03 | Loss 4.4970 | p1_Loss 0.5207 | p2_Loss 0.6890 | p3_Loss 3.2241 | p4_Loss 3.2241 | 
2023-02-26 13:54:12.037: real_rest_sum 809.1243 | real_rest_sum_int 1023.0000 | all_sum 19374.0000 | rest_ratio 0.7909 | repeat_ratio 0.9836
2023-02-26 13:54:29.178: [Training]| Epochs  33 | Batch  5000  | ms/batch 0.03 | Loss 2.7322 | p1_Loss 0.4553 | p2_Loss 0.6870 | p3_Loss 1.5429 | p4_Loss 1.5429 | 
2023-02-26 13:54:29.178: real_rest_sum 1924.4739 | real_rest_sum_int 2458.0000 | all_sum 37859.0000 | rest_ratio 0.7829 | repeat_ratio 0.9901
2023-02-26 13:54:35.634: batch_num: 5179
2023-02-26 13:54:35.634: [Training]| Epochs  33 | loss_all  4.5820 | p1_all  0.5233 | p2_all  0.6869 | p3_all  3.3152 | p4_all  3.3152 | real_rest_ratio 0.0499 | repeat_ratio 0.9837 |
2023-02-26 13:54:51.540: 1
2023-02-26 13:54:51.541: valid_real_ratio_avg 0.0757 valid_neg_ratio_avg 0.0887 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 13:54:51.541: [Validation] neg_sample TOP5 [Test]| Epochs  33 | Hit ratio 0.9055 | recall 0.3409 |  precision 0.5485 | f1  0.3735 | ndcg  0.6189 | mrr  0.7868 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 13:54:51.541: [Validation] p_n_score_differences_avg 0.4037 
2023-02-26 13:54:51.541: ##############################################
2023-02-26 13:54:51.543: G1_flag 1 pretrain 1 temp 10.0 train_epoch 1  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:54:51.769: [Training]| Epochs  34 | Batch     0  | ms/batch 0.00 | Loss 2.6121 | p1_Loss 0.4602 | p2_Loss 0.6873 | p3_Loss 1.4216 | p4_Loss 1.4216 | 
2023-02-26 13:54:51.769: real_rest_sum 2017.8046 | real_rest_sum_int 3118.0000 | all_sum 36019.0000 | rest_ratio 0.6471 | repeat_ratio 0.9956
2023-02-26 13:55:08.555: [Training]| Epochs  34 | Batch   500  | ms/batch 0.03 | Loss 4.8847 | p1_Loss 0.5397 | p2_Loss 0.6854 | p3_Loss 3.5971 | p4_Loss 3.5971 | 
2023-02-26 13:55:08.555: real_rest_sum 256.8459 | real_rest_sum_int 369.0000 | all_sum 7932.0000 | rest_ratio 0.6961 | repeat_ratio 0.9953
2023-02-26 13:55:24.709: [Training]| Epochs  34 | Batch  1000  | ms/batch 0.03 | Loss 5.5531 | p1_Loss 0.5627 | p2_Loss 0.6836 | p3_Loss 4.2466 | p4_Loss 4.2466 | 
2023-02-26 13:55:24.709: real_rest_sum 233.4527 | real_rest_sum_int 347.0000 | all_sum 6769.0000 | rest_ratio 0.6728 | repeat_ratio 0.9743
2023-02-26 13:55:40.595: [Training]| Epochs  34 | Batch  1500  | ms/batch 0.03 | Loss 4.2537 | p1_Loss 0.4958 | p2_Loss 0.6820 | p3_Loss 3.0191 | p4_Loss 3.0191 | 
2023-02-26 13:55:40.595: real_rest_sum 308.0459 | real_rest_sum_int 403.0000 | all_sum 7660.0000 | rest_ratio 0.7644 | repeat_ratio 0.9856
2023-02-26 13:55:57.721: [Training]| Epochs  34 | Batch  2000  | ms/batch 0.04 | Loss 3.2205 | p1_Loss 0.4664 | p2_Loss 0.6822 | p3_Loss 2.0153 | p4_Loss 2.0153 | 
2023-02-26 13:55:57.721: real_rest_sum 740.4383 | real_rest_sum_int 1001.0000 | all_sum 21671.0000 | rest_ratio 0.7397 | repeat_ratio 0.9908
2023-02-26 13:56:15.420: [Training]| Epochs  34 | Batch  2500  | ms/batch 0.04 | Loss 3.6610 | p1_Loss 0.4726 | p2_Loss 0.6870 | p3_Loss 2.4390 | p4_Loss 2.4390 | 
2023-02-26 13:56:15.420: real_rest_sum 1255.8730 | real_rest_sum_int 1641.0000 | all_sum 40441.0000 | rest_ratio 0.7653 | repeat_ratio 0.9962
2023-02-26 13:56:31.042: [Training]| Epochs  34 | Batch  3000  | ms/batch 0.03 | Loss 7.1792 | p1_Loss 0.6268 | p2_Loss 0.6911 | p3_Loss 5.8019 | p4_Loss 5.8019 | 
2023-02-26 13:56:31.042: real_rest_sum 81.8089 | real_rest_sum_int 111.0000 | all_sum 2059.0000 | rest_ratio 0.7370 | repeat_ratio 0.9674
2023-02-26 13:56:47.516: [Training]| Epochs  34 | Batch  3500  | ms/batch 0.03 | Loss 3.9115 | p1_Loss 0.5151 | p2_Loss 0.6869 | p3_Loss 2.6656 | p4_Loss 2.6656 | 
2023-02-26 13:56:47.516: real_rest_sum 662.1691 | real_rest_sum_int 854.0000 | all_sum 13396.0000 | rest_ratio 0.7754 | repeat_ratio 0.9882
2023-02-26 13:57:03.148: [Training]| Epochs  34 | Batch  4000  | ms/batch 0.03 | Loss 2.4484 | p1_Loss 0.4352 | p2_Loss 0.6886 | p3_Loss 1.2565 | p4_Loss 1.2565 | 
2023-02-26 13:57:03.148: real_rest_sum 1394.1917 | real_rest_sum_int 1876.0000 | all_sum 40922.0000 | rest_ratio 0.7432 | repeat_ratio 0.9892
2023-02-26 13:57:19.310: [Training]| Epochs  34 | Batch  4500  | ms/batch 0.03 | Loss 5.0802 | p1_Loss 0.5634 | p2_Loss 0.6861 | p3_Loss 3.7920 | p4_Loss 3.7920 | 
2023-02-26 13:57:19.310: real_rest_sum 379.0458 | real_rest_sum_int 471.0000 | all_sum 8422.0000 | rest_ratio 0.8048 | repeat_ratio 0.9855
2023-02-26 13:57:34.077: [Training]| Epochs  34 | Batch  5000  | ms/batch 0.03 | Loss 7.5544 | p1_Loss 0.6492 | p2_Loss 0.6921 | p3_Loss 6.1792 | p4_Loss 6.1792 | 
2023-02-26 13:57:34.077: real_rest_sum 78.3219 | real_rest_sum_int 96.0000 | all_sum 1401.0000 | rest_ratio 0.8159 | repeat_ratio 1.0000
2023-02-26 13:57:39.928: batch_num: 5179
2023-02-26 13:57:39.929: [Training]| Epochs  34 | loss_all  4.5746 | p1_all  0.5231 | p2_all  0.6869 | p3_all  3.3083 | p4_all  3.3083 | real_rest_ratio 0.0489 | repeat_ratio 0.9835 |
2023-02-26 13:57:55.742: 1
2023-02-26 13:57:55.743: valid_real_ratio_avg 0.0738 valid_neg_ratio_avg 0.0869 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 13:57:55.743: [Validation] neg_sample TOP5 [Test]| Epochs  34 | Hit ratio 0.9142 | recall 0.3397 |  precision 0.5404 | f1  0.3705 | ndcg  0.6115 | mrr  0.7865 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 13:57:55.743: [Validation] p_n_score_differences_avg 0.4126 
2023-02-26 13:57:55.743: ##############################################
2023-02-26 13:57:55.745: G1_flag 1 pretrain 1 temp 10.0 train_epoch 2  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 13:57:55.914: [Training]| Epochs  35 | Batch     0  | ms/batch 0.00 | Loss 5.4551 | p1_Loss 0.5677 | p2_Loss 0.6888 | p3_Loss 4.1592 | p4_Loss 4.1592 | 
2023-02-26 13:57:55.914: real_rest_sum 333.9076 | real_rest_sum_int 490.0000 | all_sum 6322.0000 | rest_ratio 0.6814 | repeat_ratio 0.9661
2023-02-26 13:58:11.025: [Training]| Epochs  35 | Batch   500  | ms/batch 0.03 | Loss 4.5030 | p1_Loss 0.5160 | p2_Loss 0.6824 | p3_Loss 3.2431 | p4_Loss 3.2431 | 
2023-02-26 13:58:11.025: real_rest_sum 350.4586 | real_rest_sum_int 511.0000 | all_sum 10601.0000 | rest_ratio 0.6858 | repeat_ratio 0.9631
2023-02-26 13:58:28.090: [Training]| Epochs  35 | Batch  1000  | ms/batch 0.03 | Loss 9.1574 | p1_Loss 0.6751 | p2_Loss 0.6922 | p3_Loss 7.7185 | p4_Loss 7.7185 | 
2023-02-26 13:58:28.090: real_rest_sum 28.4861 | real_rest_sum_int 42.0000 | all_sum 920.0000 | rest_ratio 0.6782 | repeat_ratio 1.0000
2023-02-26 13:58:43.442: [Training]| Epochs  35 | Batch  1500  | ms/batch 0.03 | Loss 2.9942 | p1_Loss 0.4485 | p2_Loss 0.6854 | p3_Loss 1.7888 | p4_Loss 1.7888 | 
2023-02-26 13:58:43.442: real_rest_sum 847.2504 | real_rest_sum_int 1147.0000 | all_sum 31607.0000 | rest_ratio 0.7387 | repeat_ratio 0.9749
2023-02-26 13:58:58.880: [Training]| Epochs  35 | Batch  2000  | ms/batch 0.03 | Loss 3.9677 | p1_Loss 0.4870 | p2_Loss 0.6856 | p3_Loss 2.7241 | p4_Loss 2.7241 | 
2023-02-26 13:58:58.880: real_rest_sum 418.1964 | real_rest_sum_int 558.0000 | all_sum 17134.0000 | rest_ratio 0.7495 | repeat_ratio 0.9877
2023-02-26 13:59:16.415: [Training]| Epochs  35 | Batch  2500  | ms/batch 0.04 | Loss 4.2518 | p1_Loss 0.5216 | p2_Loss 0.6879 | p3_Loss 2.9752 | p4_Loss 2.9752 | 
2023-02-26 13:59:16.415: real_rest_sum 548.1973 | real_rest_sum_int 758.0000 | all_sum 20831.0000 | rest_ratio 0.7232 | repeat_ratio 0.9941
2023-02-26 13:59:31.744: [Training]| Epochs  35 | Batch  3000  | ms/batch 0.03 | Loss 3.7317 | p1_Loss 0.4898 | p2_Loss 0.6881 | p3_Loss 2.4959 | p4_Loss 2.4959 | 
2023-02-26 13:59:31.744: real_rest_sum 595.8452 | real_rest_sum_int 787.0000 | all_sum 19082.0000 | rest_ratio 0.7571 | repeat_ratio 0.9915
2023-02-26 13:59:48.897: [Training]| Epochs  35 | Batch  3500  | ms/batch 0.04 | Loss 4.6063 | p1_Loss 0.5349 | p2_Loss 0.6871 | p3_Loss 3.3266 | p4_Loss 3.3266 | 
2023-02-26 13:59:48.898: real_rest_sum 360.7208 | real_rest_sum_int 451.0000 | all_sum 9364.0000 | rest_ratio 0.7998 | repeat_ratio 0.9872
2023-02-26 14:00:04.952: [Training]| Epochs  35 | Batch  4000  | ms/batch 0.03 | Loss 3.8471 | p1_Loss 0.4974 | p2_Loss 0.6875 | p3_Loss 2.6090 | p4_Loss 2.6090 | 
2023-02-26 14:00:04.952: real_rest_sum 608.8761 | real_rest_sum_int 791.0000 | all_sum 16703.0000 | rest_ratio 0.7698 | repeat_ratio 0.9834
2023-02-26 14:00:22.042: [Training]| Epochs  35 | Batch  4500  | ms/batch 0.04 | Loss 3.8757 | p1_Loss 0.5006 | p2_Loss 0.6885 | p3_Loss 2.6292 | p4_Loss 2.6292 | 
2023-02-26 14:00:22.042: real_rest_sum 609.8073 | real_rest_sum_int 742.0000 | all_sum 14990.0000 | rest_ratio 0.8218 | repeat_ratio 0.9905
2023-02-26 14:00:37.815: [Training]| Epochs  35 | Batch  5000  | ms/batch 0.03 | Loss 5.1031 | p1_Loss 0.5504 | p2_Loss 0.6911 | p3_Loss 3.7826 | p4_Loss 3.7826 | 
2023-02-26 14:00:37.815: real_rest_sum 305.6553 | real_rest_sum_int 385.0000 | all_sum 8286.0000 | rest_ratio 0.7939 | repeat_ratio 0.9930
2023-02-26 14:00:43.749: batch_num: 5179
2023-02-26 14:00:43.749: [Training]| Epochs  35 | loss_all  4.5757 | p1_all  0.5234 | p2_all  0.6870 | p3_all  3.3087 | p4_all  3.3087 | real_rest_ratio 0.0491 | repeat_ratio 0.9832 |
2023-02-26 14:00:59.670: 1
2023-02-26 14:00:59.671: valid_real_ratio_avg 0.0731 valid_neg_ratio_avg 0.0833 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 14:00:59.671: [Validation] neg_sample TOP5 [Test]| Epochs  35 | Hit ratio 0.9041 | recall 0.3359 |  precision 0.5436 | f1  0.3695 | ndcg  0.6107 | mrr  0.7736 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 14:00:59.671: [Validation] p_n_score_differences_avg 0.4053 
2023-02-26 14:00:59.671: ##############################################
2023-02-26 14:00:59.673: G1_flag 1 pretrain 1 temp 10.0 train_epoch 3  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 14:00:59.886: [Training]| Epochs  36 | Batch     0  | ms/batch 0.00 | Loss 2.6075 | p1_Loss 0.4507 | p2_Loss 0.6862 | p3_Loss 1.4263 | p4_Loss 1.4263 | 
2023-02-26 14:00:59.886: real_rest_sum 1953.0322 | real_rest_sum_int 2986.0000 | all_sum 36019.0000 | rest_ratio 0.6541 | repeat_ratio 0.9907
2023-02-26 14:01:17.247: [Training]| Epochs  36 | Batch   500  | ms/batch 0.04 | Loss 3.8410 | p1_Loss 0.5106 | p2_Loss 0.6844 | p3_Loss 2.6030 | p4_Loss 2.6030 | 
2023-02-26 14:01:17.247: real_rest_sum 713.6246 | real_rest_sum_int 1048.0000 | all_sum 15095.0000 | rest_ratio 0.6809 | repeat_ratio 0.9913
2023-02-26 14:01:32.983: [Training]| Epochs  36 | Batch  1000  | ms/batch 0.03 | Loss 5.9972 | p1_Loss 0.5920 | p2_Loss 0.6898 | p3_Loss 4.6494 | p4_Loss 4.6494 | 
2023-02-26 14:01:32.983: real_rest_sum 165.9850 | real_rest_sum_int 241.0000 | all_sum 5769.0000 | rest_ratio 0.6887 | repeat_ratio 0.9774
2023-02-26 14:01:48.788: [Training]| Epochs  36 | Batch  1500  | ms/batch 0.03 | Loss 7.7504 | p1_Loss 0.6446 | p2_Loss 0.6921 | p3_Loss 6.3501 | p4_Loss 6.3501 | 
2023-02-26 14:01:48.788: real_rest_sum 52.4542 | real_rest_sum_int 74.0000 | all_sum 1871.0000 | rest_ratio 0.7088 | repeat_ratio 0.8974
2023-02-26 14:02:04.501: [Training]| Epochs  36 | Batch  2000  | ms/batch 0.03 | Loss 3.3123 | p1_Loss 0.4616 | p2_Loss 0.6858 | p3_Loss 2.1023 | p4_Loss 2.1023 | 
2023-02-26 14:02:04.502: real_rest_sum 692.7405 | real_rest_sum_int 913.0000 | all_sum 20911.0000 | rest_ratio 0.7588 | repeat_ratio 0.9891
2023-02-26 14:02:20.935: [Training]| Epochs  36 | Batch  2500  | ms/batch 0.03 | Loss 3.8756 | p1_Loss 0.4900 | p2_Loss 0.6850 | p3_Loss 2.6383 | p4_Loss 2.6383 | 
2023-02-26 14:02:20.936: real_rest_sum 568.0024 | real_rest_sum_int 774.0000 | all_sum 17949.0000 | rest_ratio 0.7339 | repeat_ratio 0.9838
2023-02-26 14:02:37.274: [Training]| Epochs  36 | Batch  3000  | ms/batch 0.03 | Loss 4.2137 | p1_Loss 0.5193 | p2_Loss 0.6865 | p3_Loss 2.9548 | p4_Loss 2.9548 | 
2023-02-26 14:02:37.275: real_rest_sum 600.0669 | real_rest_sum_int 825.0000 | all_sum 14608.0000 | rest_ratio 0.7274 | repeat_ratio 0.9913
2023-02-26 14:02:53.753: [Training]| Epochs  36 | Batch  3500  | ms/batch 0.03 | Loss 3.9274 | p1_Loss 0.5001 | p2_Loss 0.6889 | p3_Loss 2.6916 | p4_Loss 2.6916 | 
2023-02-26 14:02:53.753: real_rest_sum 517.5446 | real_rest_sum_int 664.0000 | all_sum 10554.0000 | rest_ratio 0.7794 | repeat_ratio 0.9657
2023-02-26 14:03:10.135: [Training]| Epochs  36 | Batch  4000  | ms/batch 0.03 | Loss 3.8135 | p1_Loss 0.4975 | p2_Loss 0.6790 | p3_Loss 2.6115 | p4_Loss 2.6115 | 
2023-02-26 14:03:10.135: real_rest_sum 471.5773 | real_rest_sum_int 597.0000 | all_sum 6899.0000 | rest_ratio 0.7899 | repeat_ratio 0.9894
2023-02-26 14:03:25.276: [Training]| Epochs  36 | Batch  4500  | ms/batch 0.03 | Loss 2.6742 | p1_Loss 0.4474 | p2_Loss 0.6834 | p3_Loss 1.4962 | p4_Loss 1.4962 | 
2023-02-26 14:03:25.277: real_rest_sum 1783.7909 | real_rest_sum_int 2167.0000 | all_sum 36032.0000 | rest_ratio 0.8232 | repeat_ratio 0.9888
2023-02-26 14:03:42.424: [Training]| Epochs  36 | Batch  5000  | ms/batch 0.03 | Loss 6.0148 | p1_Loss 0.5916 | p2_Loss 0.6913 | p3_Loss 4.6849 | p4_Loss 4.6849 | 
2023-02-26 14:03:42.424: real_rest_sum 225.1339 | real_rest_sum_int 277.0000 | all_sum 4697.0000 | rest_ratio 0.8128 | repeat_ratio 0.9561
2023-02-26 14:03:47.538: batch_num: 5179
2023-02-26 14:03:47.538: [Training]| Epochs  36 | loss_all  4.5649 | p1_all  0.5233 | p2_all  0.6869 | p3_all  3.2984 | p4_all  3.2984 | real_rest_ratio 0.0506 | repeat_ratio 0.9848 |
2023-02-26 14:04:03.393: 1
2023-02-26 14:04:03.393: valid_real_ratio_avg 0.0578 valid_neg_ratio_avg 0.0568 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 14:04:03.394: [Validation] neg_sample TOP5 [Test]| Epochs  36 | Hit ratio 0.9099 | recall 0.3440 |  precision 0.5538 | f1  0.3774 | ndcg  0.6229 | mrr  0.7872 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 14:04:03.394: [Validation] p_n_score_differences_avg 0.4221 
2023-02-26 14:04:03.394: ##############################################
2023-02-26 14:06:26.974: 1
2023-02-26 14:06:26.982: Epochs  36 topk   5  basket_length <4  num 714  Hit ratio 0.8151 | recall 0.5148 |  precision 0.3420 | f1  0.3742 | ndcg  0.5494 | mrr  0.6984 
2023-02-26 14:06:26.983: Epochs  36 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8587 | recall 0.4290 |  precision 0.4432 | f1  0.4014 | ndcg  0.5567 | mrr  0.7469 
2023-02-26 14:06:26.986: Epochs  36 topk   5  basket_length >6  num 4295  Hit ratio 0.9520 | recall 0.3364 |  precision 0.6420 | f1  0.4064 | ndcg  0.6844 | mrr  0.8400 
2023-02-26 14:06:26.986: ...............................................
2023-02-26 14:06:26.986: test_real_ratio_avg 0.0659 test_neg_ratio_avg 0.0550 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 14:06:26.986: neg_sample TOP5 [Test]| Epochs  36 | Hit ratio 0.9184 | recall 0.3747 |  precision 0.5693 | f1  0.4017 | ndcg  0.6444 | mrr  0.8058 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 14:06:26.986: [Test] p_n_score_differences_avg 0.4549 
2023-02-26 14:06:26.986: ##############################################
2023-02-26 14:06:27.088: Save model as ./runs/model_1_Instacart_t_10_ANN_0001_same_1_triple_1_lr_001_G1_001_diftemp0_0_pos_01_epoch_G5_D5.pt
2023-02-26 14:06:27.088: Epochs  36 best_hit 0.9184 best_recall 0.3747 best_precision 0.5693 best_f1 0.4017 best_ndcg 0.6444  best_mrr 0.8058 
2023-02-26 14:06:27.088: Epochs  36 loss_all 4.5649 Hit ratio 0.9184 recall 0.3747 precision 0.5693 f1  0.4017 ndcg  0.6444 mrr  0.8058 avg_fake_length 5.0000
2023-02-26 14:06:27.089: G1_flag 1 pretrain 1 temp 10.0 train_epoch 4  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 14:06:27.288: [Training]| Epochs  37 | Batch     0  | ms/batch 0.00 | Loss 3.3265 | p1_Loss 0.4760 | p2_Loss 0.6852 | p3_Loss 2.1037 | p4_Loss 2.1037 | 
2023-02-26 14:06:27.288: real_rest_sum 1343.7324 | real_rest_sum_int 2064.0000 | all_sum 35747.0000 | rest_ratio 0.6510 | repeat_ratio 0.9679
2023-02-26 14:06:44.931: [Training]| Epochs  37 | Batch   500  | ms/batch 0.04 | Loss 4.0255 | p1_Loss 0.5085 | p2_Loss 0.6858 | p3_Loss 2.7596 | p4_Loss 2.7596 | 
2023-02-26 14:06:44.931: real_rest_sum 324.1312 | real_rest_sum_int 464.0000 | all_sum 13936.0000 | rest_ratio 0.6986 | repeat_ratio 0.9711
2023-02-26 14:07:01.750: [Training]| Epochs  37 | Batch  1000  | ms/batch 0.03 | Loss 3.7485 | p1_Loss 0.4818 | p2_Loss 0.6862 | p3_Loss 2.5123 | p4_Loss 2.5123 | 
2023-02-26 14:07:01.750: real_rest_sum 518.7432 | real_rest_sum_int 730.0000 | all_sum 18782.0000 | rest_ratio 0.7106 | repeat_ratio 0.9731
2023-02-26 14:07:16.762: [Training]| Epochs  37 | Batch  1500  | ms/batch 0.03 | Loss 8.6549 | p1_Loss 0.6586 | p2_Loss 0.6923 | p3_Loss 7.2440 | p4_Loss 7.2440 | 
2023-02-26 14:07:16.762: real_rest_sum 37.4088 | real_rest_sum_int 53.0000 | all_sum 1084.0000 | rest_ratio 0.7058 | repeat_ratio 0.9600
2023-02-26 14:07:32.682: [Training]| Epochs  37 | Batch  2000  | ms/batch 0.03 | Loss 5.8583 | p1_Loss 0.5675 | p2_Loss 0.6877 | p3_Loss 4.5489 | p4_Loss 4.5489 | 
2023-02-26 14:07:32.682: real_rest_sum 111.2020 | real_rest_sum_int 145.0000 | all_sum 3091.0000 | rest_ratio 0.7669 | repeat_ratio 0.9853
2023-02-26 14:07:48.335: [Training]| Epochs  37 | Batch  2500  | ms/batch 0.03 | Loss 5.7432 | p1_Loss 0.5674 | p2_Loss 0.6903 | p3_Loss 4.4210 | p4_Loss 4.4210 | 
2023-02-26 14:07:48.335: real_rest_sum 175.7425 | real_rest_sum_int 235.0000 | all_sum 5238.0000 | rest_ratio 0.7478 | repeat_ratio 0.9950
2023-02-26 14:08:03.721: [Training]| Epochs  37 | Batch  3000  | ms/batch 0.03 | Loss 5.2853 | p1_Loss 0.5581 | p2_Loss 0.6844 | p3_Loss 3.9964 | p4_Loss 3.9964 | 
2023-02-26 14:08:03.721: real_rest_sum 222.9002 | real_rest_sum_int 294.0000 | all_sum 5848.0000 | rest_ratio 0.7582 | repeat_ratio 0.9853
2023-02-26 14:08:20.168: [Training]| Epochs  37 | Batch  3500  | ms/batch 0.03 | Loss 3.3491 | p1_Loss 0.4925 | p2_Loss 0.6819 | p3_Loss 2.1437 | p4_Loss 2.1437 | 
2023-02-26 14:08:20.168: real_rest_sum 1271.8679 | real_rest_sum_int 1626.0000 | all_sum 21221.0000 | rest_ratio 0.7822 | repeat_ratio 0.9887
2023-02-26 14:08:37.435: [Training]| Epochs  37 | Batch  4000  | ms/batch 0.04 | Loss 4.7607 | p1_Loss 0.5464 | p2_Loss 0.6884 | p3_Loss 3.4722 | p4_Loss 3.4722 | 
2023-02-26 14:08:37.435: real_rest_sum 268.4642 | real_rest_sum_int 347.0000 | all_sum 7716.0000 | rest_ratio 0.7737 | repeat_ratio 0.9838
2023-02-26 14:08:52.995: [Training]| Epochs  37 | Batch  4500  | ms/batch 0.03 | Loss 3.8377 | p1_Loss 0.5044 | p2_Loss 0.6864 | p3_Loss 2.6225 | p4_Loss 2.6225 | 
2023-02-26 14:08:52.995: real_rest_sum 595.2616 | real_rest_sum_int 728.0000 | all_sum 9397.0000 | rest_ratio 0.8177 | repeat_ratio 0.9984
2023-02-26 14:09:09.004: [Training]| Epochs  37 | Batch  5000  | ms/batch 0.03 | Loss 2.9166 | p1_Loss 0.4558 | p2_Loss 0.6870 | p3_Loss 1.7239 | p4_Loss 1.7239 | 
2023-02-26 14:09:09.004: real_rest_sum 1158.4698 | real_rest_sum_int 1427.0000 | all_sum 27516.0000 | rest_ratio 0.8118 | repeat_ratio 0.9889
2023-02-26 14:09:15.662: batch_num: 5179
2023-02-26 14:09:15.662: [Training]| Epochs  37 | loss_all  4.5820 | p1_all  0.5233 | p2_all  0.6870 | p3_all  3.3149 | p4_all  3.3149 | real_rest_ratio 0.0490 | repeat_ratio 0.9847 |
2023-02-26 14:09:31.580: 1
2023-02-26 14:09:31.581: valid_real_ratio_avg 0.0754 valid_neg_ratio_avg 0.0852 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 14:09:31.581: [Validation] neg_sample TOP5 [Test]| Epochs  37 | Hit ratio 0.9041 | recall 0.3351 |  precision 0.5442 | f1  0.3689 | ndcg  0.6110 | mrr  0.7742 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 14:09:31.581: [Validation] p_n_score_differences_avg 0.4006 
2023-02-26 14:09:31.581: ##############################################
2023-02-26 14:11:56.200: 1
2023-02-26 14:11:56.207: Epochs  37 topk   5  basket_length <4  num 714  Hit ratio 0.8067 | recall 0.5022 |  precision 0.3387 | f1  0.3682 | ndcg  0.5406 | mrr  0.6876 
2023-02-26 14:11:56.208: Epochs  37 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8486 | recall 0.4225 |  precision 0.4378 | f1  0.3959 | ndcg  0.5545 | mrr  0.7511 
2023-02-26 14:11:56.211: Epochs  37 topk   5  basket_length >6  num 4295  Hit ratio 0.9485 | recall 0.3305 |  precision 0.6344 | f1  0.4005 | ndcg  0.6777 | mrr  0.8372 
2023-02-26 14:11:56.211: ...............................................
2023-02-26 14:11:56.211: test_real_ratio_avg 0.0835 test_neg_ratio_avg 0.0823 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 14:11:56.212: neg_sample TOP5 [Test]| Epochs  37 | Hit ratio 0.9130 | recall 0.3679 |  precision 0.5626 | f1  0.3959 | ndcg  0.6383 | mrr  0.8034 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 14:11:56.212: [Test] p_n_score_differences_avg 0.4352 
2023-02-26 14:11:56.212: ##############################################
2023-02-26 14:11:56.213: Epochs  37 best_hit 0.9184 best_recall 0.3747 best_precision 0.5693 best_f1 0.4017 best_ndcg 0.6444  best_mrr 0.8058 
2023-02-26 14:11:56.213: Epochs  37 loss_all 4.5820 Hit ratio 0.9130 recall 0.3679 precision 0.5626 f1  0.3959 ndcg  0.6383 mrr  0.8034 avg_fake_length 5.0000
2023-02-26 14:11:56.216: G1_flag 0 pretrain 1 temp 10.0 train_epoch 0  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 14:11:56.426: [Training]| Epochs  38 | Batch     0  | ms/batch 0.00 | Loss 6.8611 | p1_Loss 0.4322 | p2_Loss 0.6839 | p3_Loss 1.1587 | p4_Loss 4.5584 | 
2023-02-26 14:11:56.426: real_rest_sum 2454.6245 | real_rest_sum_int 2515.0000 | all_sum 31114.0000 | rest_ratio 0.9760 | repeat_ratio 0.9977
2023-02-26 14:12:12.234: [Training]| Epochs  38 | Batch   500  | ms/batch 0.03 | Loss 13.7441 | p1_Loss 0.6420 | p2_Loss 0.6912 | p3_Loss 5.7399 | p4_Loss 6.6359 | 
2023-02-26 14:12:12.234: real_rest_sum 167.1382 | real_rest_sum_int 172.0000 | all_sum 2030.0000 | rest_ratio 0.9717 | repeat_ratio 1.0000
2023-02-26 14:12:27.966: [Training]| Epochs  38 | Batch  1000  | ms/batch 0.03 | Loss 9.2051 | p1_Loss 0.5195 | p2_Loss 0.6823 | p3_Loss 2.6672 | p4_Loss 5.2936 | 
2023-02-26 14:12:27.966: real_rest_sum 1056.7163 | real_rest_sum_int 1079.0000 | all_sum 17369.0000 | rest_ratio 0.9793 | repeat_ratio 0.9875
2023-02-26 14:12:45.230: [Training]| Epochs  38 | Batch  1500  | ms/batch 0.03 | Loss 7.9311 | p1_Loss 0.4562 | p2_Loss 0.6874 | p3_Loss 1.3876 | p4_Loss 5.3448 | 
2023-02-26 14:12:45.230: real_rest_sum 2860.4653 | real_rest_sum_int 2949.0000 | all_sum 51801.0000 | rest_ratio 0.9700 | repeat_ratio 0.9934
2023-02-26 14:13:01.556: [Training]| Epochs  38 | Batch  2000  | ms/batch 0.03 | Loss 11.9049 | p1_Loss 0.5750 | p2_Loss 0.6897 | p3_Loss 4.5066 | p4_Loss 6.0798 | 
2023-02-26 14:13:01.557: real_rest_sum 200.4740 | real_rest_sum_int 205.0000 | all_sum 3139.0000 | rest_ratio 0.9779 | repeat_ratio 1.0000
2023-02-26 14:13:17.568: [Training]| Epochs  38 | Batch  2500  | ms/batch 0.03 | Loss 10.5492 | p1_Loss 0.5558 | p2_Loss 0.6860 | p3_Loss 3.4674 | p4_Loss 5.8400 | 
2023-02-26 14:13:17.568: real_rest_sum 864.5411 | real_rest_sum_int 887.0000 | all_sum 9958.0000 | rest_ratio 0.9747 | repeat_ratio 1.0000
2023-02-26 14:13:34.935: [Training]| Epochs  38 | Batch  3000  | ms/batch 0.04 | Loss 9.9152 | p1_Loss 0.5366 | p2_Loss 0.6836 | p3_Loss 3.1892 | p4_Loss 5.5058 | 
2023-02-26 14:13:34.936: real_rest_sum 808.1205 | real_rest_sum_int 829.0000 | all_sum 8566.0000 | rest_ratio 0.9748 | repeat_ratio 0.9802
2023-02-26 14:13:51.477: [Training]| Epochs  38 | Batch  3500  | ms/batch 0.03 | Loss 8.8348 | p1_Loss 0.4952 | p2_Loss 0.6879 | p3_Loss 2.2323 | p4_Loss 5.4053 | 
2023-02-26 14:13:51.477: real_rest_sum 1708.1934 | real_rest_sum_int 1755.0000 | all_sum 21940.0000 | rest_ratio 0.9733 | repeat_ratio 0.9905
2023-02-26 14:14:09.175: [Training]| Epochs  38 | Batch  4000  | ms/batch 0.04 | Loss 8.9724 | p1_Loss 0.4864 | p2_Loss 0.6895 | p3_Loss 2.0141 | p4_Loss 5.6969 | 
2023-02-26 14:14:09.175: real_rest_sum 1566.0067 | real_rest_sum_int 1610.0000 | all_sum 29866.0000 | rest_ratio 0.9727 | repeat_ratio 1.0000
2023-02-26 14:14:24.668: [Training]| Epochs  38 | Batch  4500  | ms/batch 0.03 | Loss 11.2186 | p1_Loss 0.5630 | p2_Loss 0.6899 | p3_Loss 3.8310 | p4_Loss 6.0872 | 
2023-02-26 14:14:24.668: real_rest_sum 384.8782 | real_rest_sum_int 399.0000 | all_sum 6932.0000 | rest_ratio 0.9646 | repeat_ratio 0.9868
2023-02-26 14:14:42.268: [Training]| Epochs  38 | Batch  5000  | ms/batch 0.04 | Loss 8.5552 | p1_Loss 0.4824 | p2_Loss 0.6864 | p3_Loss 2.0895 | p4_Loss 5.2822 | 
2023-02-26 14:14:42.268: real_rest_sum 1239.9725 | real_rest_sum_int 1274.0000 | all_sum 16298.0000 | rest_ratio 0.9733 | repeat_ratio 0.9913
2023-02-26 14:14:48.414: batch_num: 5179
2023-02-26 14:14:48.414: [Training]| Epochs  38 | loss_all  10.1308 | p1_all  0.5295 | p2_all  0.6875 | p3_all  3.1456 | p4_all  5.7354 | real_rest_ratio 0.0699 | repeat_ratio 0.9930 |
2023-02-26 14:15:04.349: 1
2023-02-26 14:15:04.350: valid_real_ratio_avg 0.0807 valid_neg_ratio_avg 0.0976 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 14:15:04.350: [Validation] neg_sample TOP5 [Test]| Epochs  38 | Hit ratio 0.9012 | recall 0.3340 |  precision 0.5366 | f1  0.3665 | ndcg  0.6093 | mrr  0.7883 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 14:15:04.350: [Validation] p_n_score_differences_avg 0.3929 
2023-02-26 14:15:04.350: ##############################################
2023-02-26 14:17:29.066: 1
2023-02-26 14:17:29.074: Epochs  38 topk   5  basket_length <4  num 714  Hit ratio 0.8081 | recall 0.5135 |  precision 0.3398 | f1  0.3724 | ndcg  0.5451 | mrr  0.6933 
2023-02-26 14:17:29.075: Epochs  38 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8486 | recall 0.4165 |  precision 0.4315 | f1  0.3897 | ndcg  0.5443 | mrr  0.7383 
2023-02-26 14:17:29.078: Epochs  38 topk   5  basket_length >6  num 4295  Hit ratio 0.9495 | recall 0.3301 |  precision 0.6342 | f1  0.4002 | ndcg  0.6786 | mrr  0.8397 
2023-02-26 14:17:29.078: ...............................................
2023-02-26 14:17:29.078: test_real_ratio_avg 0.0896 test_neg_ratio_avg 0.0946 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 14:17:29.078: neg_sample TOP5 [Test]| Epochs  38 | Hit ratio 0.9138 | recall 0.3678 |  precision 0.5614 | f1  0.3950 | ndcg  0.6375 | mrr  0.8034 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 14:17:29.078: [Test] p_n_score_differences_avg 0.4269 
2023-02-26 14:17:29.078: ##############################################
2023-02-26 14:17:29.080: Epochs  38 best_hit 0.9184 best_recall 0.3747 best_precision 0.5693 best_f1 0.4017 best_ndcg 0.6444  best_mrr 0.8058 
2023-02-26 14:17:29.080: Epochs  38 loss_all 10.1308 Hit ratio 0.9138 recall 0.3678 precision 0.5614 f1  0.3950 ndcg  0.6375 mrr  0.8034 avg_fake_length 5.0000
2023-02-26 14:17:29.082: G1_flag 0 pretrain 1 temp 10.0 train_epoch 1  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 14:17:29.262: [Training]| Epochs  39 | Batch     0  | ms/batch 0.00 | Loss 10.3613 | p1_Loss 0.5538 | p2_Loss 0.6837 | p3_Loss 3.3201 | p4_Loss 5.7677 | 
2023-02-26 14:17:29.262: real_rest_sum 498.5233 | real_rest_sum_int 509.0000 | all_sum 7684.0000 | rest_ratio 0.9794 | repeat_ratio 1.0000
2023-02-26 14:17:46.145: [Training]| Epochs  39 | Batch   500  | ms/batch 0.03 | Loss 12.4040 | p1_Loss 0.5920 | p2_Loss 0.6891 | p3_Loss 4.6067 | p4_Loss 6.4757 | 
2023-02-26 14:17:46.145: real_rest_sum 340.3130 | real_rest_sum_int 348.0000 | all_sum 4721.0000 | rest_ratio 0.9779 | repeat_ratio 1.0000
2023-02-26 14:18:02.408: [Training]| Epochs  39 | Batch  1000  | ms/batch 0.03 | Loss 9.7768 | p1_Loss 0.5234 | p2_Loss 0.6876 | p3_Loss 3.1678 | p4_Loss 5.3782 | 
2023-02-26 14:18:02.409: real_rest_sum 571.8994 | real_rest_sum_int 590.0000 | all_sum 7674.0000 | rest_ratio 0.9693 | repeat_ratio 0.9833
2023-02-26 14:18:19.538: [Training]| Epochs  39 | Batch  1500  | ms/batch 0.03 | Loss 8.8667 | p1_Loss 0.5053 | p2_Loss 0.6883 | p3_Loss 2.2952 | p4_Loss 5.3476 | 
2023-02-26 14:18:19.539: real_rest_sum 2017.4921 | real_rest_sum_int 2077.0000 | all_sum 27644.0000 | rest_ratio 0.9713 | repeat_ratio 0.9970
2023-02-26 14:18:36.624: [Training]| Epochs  39 | Batch  2000  | ms/batch 0.04 | Loss 8.0993 | p1_Loss 0.4532 | p2_Loss 0.6871 | p3_Loss 1.6932 | p4_Loss 5.2143 | 
2023-02-26 14:18:36.624: real_rest_sum 2178.8625 | real_rest_sum_int 2241.0000 | all_sum 33852.0000 | rest_ratio 0.9723 | repeat_ratio 0.9889
2023-02-26 14:18:54.135: [Training]| Epochs  39 | Batch  2500  | ms/batch 0.04 | Loss 11.2096 | p1_Loss 0.5734 | p2_Loss 0.6890 | p3_Loss 3.9511 | p4_Loss 5.9961 | 
2023-02-26 14:18:54.136: real_rest_sum 373.3566 | real_rest_sum_int 383.0000 | all_sum 3845.0000 | rest_ratio 0.9748 | repeat_ratio 1.0000
2023-02-26 14:19:09.854: [Training]| Epochs  39 | Batch  3000  | ms/batch 0.03 | Loss 11.0635 | p1_Loss 0.5797 | p2_Loss 0.6877 | p3_Loss 3.7598 | p4_Loss 6.0315 | 
2023-02-26 14:19:09.855: real_rest_sum 675.1658 | real_rest_sum_int 694.0000 | all_sum 8134.0000 | rest_ratio 0.9729 | repeat_ratio 0.9944
2023-02-26 14:19:25.683: [Training]| Epochs  39 | Batch  3500  | ms/batch 0.03 | Loss 11.9079 | p1_Loss 0.5814 | p2_Loss 0.6911 | p3_Loss 4.3203 | p4_Loss 6.2736 | 
2023-02-26 14:19:25.683: real_rest_sum 285.2394 | real_rest_sum_int 294.0000 | all_sum 4644.0000 | rest_ratio 0.9702 | repeat_ratio 0.9831
2023-02-26 14:19:42.469: [Training]| Epochs  39 | Batch  4000  | ms/batch 0.03 | Loss 9.1133 | p1_Loss 0.4994 | p2_Loss 0.6845 | p3_Loss 2.5340 | p4_Loss 5.3954 | 
2023-02-26 14:19:42.469: real_rest_sum 1338.9125 | real_rest_sum_int 1377.0000 | all_sum 15095.0000 | rest_ratio 0.9723 | repeat_ratio 1.0000
2023-02-26 14:19:59.091: [Training]| Epochs  39 | Batch  4500  | ms/batch 0.03 | Loss 14.4514 | p1_Loss 0.6385 | p2_Loss 0.6922 | p3_Loss 6.1404 | p4_Loss 6.9734 | 
2023-02-26 14:19:59.091: real_rest_sum 139.5165 | real_rest_sum_int 142.0000 | all_sum 1328.0000 | rest_ratio 0.9825 | repeat_ratio 1.0000
2023-02-26 14:20:15.630: [Training]| Epochs  39 | Batch  5000  | ms/batch 0.03 | Loss 9.1571 | p1_Loss 0.4739 | p2_Loss 0.6893 | p3_Loss 1.9342 | p4_Loss 6.0195 | 
2023-02-26 14:20:15.630: real_rest_sum 2533.3240 | real_rest_sum_int 2617.0000 | all_sum 37412.0000 | rest_ratio 0.9680 | repeat_ratio 0.9983
2023-02-26 14:20:22.112: batch_num: 5179
2023-02-26 14:20:22.112: [Training]| Epochs  39 | loss_all  10.0842 | p1_all  0.5262 | p2_all  0.6876 | p3_all  3.0996 | p4_all  5.7338 | real_rest_ratio 0.0676 | repeat_ratio 0.9928 |
2023-02-26 14:20:38.073: 1
2023-02-26 14:20:38.074: valid_real_ratio_avg 0.0789 valid_neg_ratio_avg 0.0970 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 14:20:38.074: [Validation] neg_sample TOP5 [Test]| Epochs  39 | Hit ratio 0.9128 | recall 0.3441 |  precision 0.5515 | f1  0.3770 | ndcg  0.6247 | mrr  0.7969 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 14:20:38.074: [Validation] p_n_score_differences_avg 0.4084 
2023-02-26 14:20:38.074: ##############################################
2023-02-26 14:23:03.130: 1
2023-02-26 14:23:03.137: Epochs  39 topk   5  basket_length <4  num 714  Hit ratio 0.8123 | recall 0.5104 |  precision 0.3378 | f1  0.3699 | ndcg  0.5453 | mrr  0.6948 
2023-02-26 14:23:03.138: Epochs  39 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8478 | recall 0.4189 |  precision 0.4333 | f1  0.3920 | ndcg  0.5425 | mrr  0.7311 
2023-02-26 14:23:03.141: Epochs  39 topk   5  basket_length >6  num 4295  Hit ratio 0.9460 | recall 0.3335 |  precision 0.6387 | f1  0.4036 | ndcg  0.6802 | mrr  0.8337 
2023-02-26 14:23:03.141: ...............................................
2023-02-26 14:23:03.142: test_real_ratio_avg 0.0889 test_neg_ratio_avg 0.0937 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 14:23:03.142: neg_sample TOP5 [Test]| Epochs  39 | Hit ratio 0.9117 | recall 0.3703 |  precision 0.5646 | f1  0.3975 | ndcg  0.6383 | mrr  0.7980 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 14:23:03.142: [Test] p_n_score_differences_avg 0.4416 
2023-02-26 14:23:03.142: ##############################################
2023-02-26 14:23:03.143: Epochs  39 best_hit 0.9184 best_recall 0.3747 best_precision 0.5693 best_f1 0.4017 best_ndcg 0.6444  best_mrr 0.8058 
2023-02-26 14:23:03.144: Epochs  39 loss_all 10.0842 Hit ratio 0.9117 recall 0.3703 precision 0.5646 f1  0.3975 ndcg  0.6383 mrr  0.7980 avg_fake_length 5.0000
2023-02-26 14:23:03.145: G1_flag 0 pretrain 1 temp 10.0 train_epoch 2  B 128 al_batch 1000 lr 0.001  temp0 0.3
2023-02-26 14:23:03.372: [Training]| Epochs  40 | Batch     0  | ms/batch 0.00 | Loss 9.6258 | p1_Loss 0.5557 | p2_Loss 0.6871 | p3_Loss 3.0018 | p4_Loss 5.3690 | 
2023-02-26 14:23:03.372: real_rest_sum 851.0760 | real_rest_sum_int 874.0000 | all_sum 9379.0000 | rest_ratio 0.9738 | repeat_ratio 1.0000
2023-02-26 14:23:20.782: [Training]| Epochs  40 | Batch   500  | ms/batch 0.04 | Loss 8.5094 | p1_Loss 0.4998 | p2_Loss 0.6814 | p3_Loss 2.0467 | p4_Loss 5.2412 | 
2023-02-26 14:23:20.782: real_rest_sum 1532.2428 | real_rest_sum_int 1570.0000 | all_sum 22928.0000 | rest_ratio 0.9760 | repeat_ratio 1.0000
2023-02-26 14:23:37.544: [Training]| Epochs  40 | Batch  1000  | ms/batch 0.03 | Loss 10.4430 | p1_Loss 0.5529 | p2_Loss 0.6852 | p3_Loss 3.4788 | p4_Loss 5.7261 | 
2023-02-26 14:23:37.545: real_rest_sum 717.3840 | real_rest_sum_int 737.0000 | all_sum 7171.0000 | rest_ratio 0.9734 | repeat_ratio 0.9950
2023-02-26 14:23:54.687: [Training]| Epochs  40 | Batch  1500  | ms/batch 0.03 | Loss 15.1797 | p1_Loss 0.6609 | p2_Loss 0.6928 | p3_Loss 6.5662 | p4_Loss 7.2479 | 
2023-02-26 14:23:54.687: real_rest_sum 124.7627 | real_rest_sum_int 127.0000 | all_sum 1604.0000 | rest_ratio 0.9824 | repeat_ratio 1.0000
2023-02-26 14:24:09.669: [Training]| Epochs  40 | Batch  2000  | ms/batch 0.03 | Loss 12.8110 | p1_Loss 0.5989 | p2_Loss 0.6871 | p3_Loss 5.2783 | p4_Loss 6.2142 | 
2023-02-26 14:24:09.669: real_rest_sum 162.7518 | real_rest_sum_int 166.0000 | all_sum 2295.0000 | rest_ratio 0.9804 | repeat_ratio 0.9792
2023-02-26 14:24:25.799: [Training]| Epochs  40 | Batch  2500  | ms/batch 0.03 | Loss 7.8483 | p1_Loss 0.4527 | p2_Loss 0.6859 | p3_Loss 1.5271 | p4_Loss 5.1368 | 
2023-02-26 14:24:25.799: real_rest_sum 1986.3876 | real_rest_sum_int 2035.0000 | all_sum 29278.0000 | rest_ratio 0.9761 | repeat_ratio 0.9942
2023-02-26 14:24:44.609: [Training]| Epochs  40 | Batch  3000  | ms/batch 0.04 | Loss 7.9283 | p1_Loss 0.4463 | p2_Loss 0.6907 | p3_Loss 1.3345 | p4_Loss 5.3677 | 
2023-02-26 14:24:44.609: real_rest_sum 1918.1360 | real_rest_sum_int 1968.0000 | all_sum 46164.0000 | rest_ratio 0.9747 | repeat_ratio 0.9848
2023-02-26 14:25:01.703: [Training]| Epochs  40 | Batch  3500  | ms/batch 0.04 | Loss 11.4915 | p1_Loss 0.5660 | p2_Loss 0.6889 | p3_Loss 4.3215 | p4_Loss 5.8584 | 
2023-02-26 14:25:01.704: real_rest_sum 368.8419 | real_rest_sum_int 380.0000 | all_sum 6118.0000 | rest_ratio 0.9706 | repeat_ratio 0.9924
2023-02-26 14:25:17.493: [Training]| Epochs  40 | Batch  4000  | ms/batch 0.03 | Loss 8.6110 | p1_Loss 0.4606 | p2_Loss 0.6891 | p3_Loss 1.7934 | p4_Loss 5.6082 | 
2023-02-26 14:25:17.493: real_rest_sum 2713.4727 | real_rest_sum_int 2790.0000 | all_sum 39057.0000 | rest_ratio 0.9726 | repeat_ratio 0.9984
2023-02-26 14:25:35.633: [Training]| Epochs  40 | Batch  4500  | ms/batch 0.04 | Loss 8.1647 | p1_Loss 0.4433 | p2_Loss 0.6897 | p3_Loss 1.3578 | p4_Loss 5.6026 | 
2023-02-26 14:25:35.633: real_rest_sum 3122.2466 | real_rest_sum_int 3210.0000 | all_sum 55254.0000 | rest_ratio 0.9727 | repeat_ratio 0.9909
2023-02-26 14:25:52.060: [Training]| Epochs  40 | Batch  5000  | ms/batch 0.03 | Loss 11.7146 | p1_Loss 0.5872 | p2_Loss 0.6903 | p3_Loss 4.3421 | p4_Loss 6.0886 | 
2023-02-26 14:25:52.061: real_rest_sum 396.0416 | real_rest_sum_int 406.0000 | all_sum 4697.0000 | rest_ratio 0.9755 | repeat_ratio 1.0000
2023-02-26 14:25:57.326: batch_num: 5179
2023-02-26 14:25:57.326: [Training]| Epochs  40 | loss_all  10.0523 | p1_all  0.5244 | p2_all  0.6876 | p3_all  3.0780 | p4_all  5.7236 | real_rest_ratio 0.0667 | repeat_ratio 0.9924 |
2023-02-26 14:26:13.286: 1
2023-02-26 14:26:13.287: valid_real_ratio_avg 0.0785 valid_neg_ratio_avg 0.0972 valid_repeat_ratio_avg 1.0000 valid_neg_repeat_ratio_avg 1.0000
2023-02-26 14:26:13.287: [Validation] neg_sample TOP5 [Test]| Epochs  40 | Hit ratio 0.9070 | recall 0.3461 |  precision 0.5547 | f1  0.3790 | ndcg  0.6271 | mrr  0.7948 | have_fake_user 688 | avg_fake_length  5.0000 | all_valid_user_num  688
2023-02-26 14:26:13.287: [Validation] p_n_score_differences_avg 0.4234 
2023-02-26 14:26:13.287: ##############################################
2023-02-26 14:28:39.536: 1
2023-02-26 14:28:39.543: Epochs  40 topk   5  basket_length <4  num 714  Hit ratio 0.8179 | recall 0.5167 |  precision 0.3423 | f1  0.3750 | ndcg  0.5528 | mrr  0.7102 
2023-02-26 14:28:39.544: Epochs  40 topk   5  basket_length 4<<6  num 1189  Hit ratio 0.8520 | recall 0.4186 |  precision 0.4328 | f1  0.3916 | ndcg  0.5433 | mrr  0.7305 
2023-02-26 14:28:39.547: Epochs  40 topk   5  basket_length >6  num 4295  Hit ratio 0.9439 | recall 0.3267 |  precision 0.6273 | f1  0.3961 | ndcg  0.6717 | mrr  0.8327 
2023-02-26 14:28:39.548: ...............................................
2023-02-26 14:28:39.548: test_real_ratio_avg 0.0888 test_neg_ratio_avg 0.0939 test_repeat_ratio_avg 1.0000 test_neg_repeat_ratio_avg 1.0000
2023-02-26 14:28:39.548: neg_sample TOP5 [Test]| Epochs  40 | Hit ratio 0.9117 | recall 0.3663 |  precision 0.5571 | f1  0.3928 | ndcg  0.6334 | mrr  0.7990 | have_fake_user 6198 | avg_fake_length  5.0000 | all_test_user_num  6198
2023-02-26 14:28:39.548: [Test] p_n_score_differences_avg 0.4515 
2023-02-26 14:28:39.548: ##############################################
2023-02-26 14:28:39.550: Epochs  40 best_hit 0.9184 best_recall 0.3747 best_precision 0.5693 best_f1 0.4017 best_ndcg 0.6444  best_mrr 0.8058 
2023-02-26 14:28:39.550: Epochs  40 loss_all 10.0523 Hit ratio 0.9117 recall 0.3663 precision 0.5571 f1  0.3928 ndcg  0.6334 mrr  0.7990 avg_fake_length 5.0000
2023-02-26 14:28:39.550: valid_hit [0.8502906976744186, 0.8270348837209303, 0.8459302325581395, 0.8473837209302325, 0.8372093023255814, 0.8793604651162791, 0.8924418604651163, 0.8938953488372093, 0.9040697674418605, 0.9026162790697675, 0.9026162790697675, 0.9142441860465116, 0.9055232558139535, 0.9113372093023255, 0.9011627906976745, 0.9069767441860465, 0.9084302325581395, 0.8953488372093024, 0.8968023255813954, 0.9069767441860465, 0.8968023255813954, 0.8938953488372093, 0.9040697674418605, 0.9011627906976745, 0.8997093023255814, 0.9084302325581395, 0.8968023255813954, 0.9055232558139535, 0.8997093023255814, 0.9040697674418605, 0.9055232558139535, 0.9142441860465116, 0.9040697674418605, 0.9098837209302325, 0.9040697674418605, 0.9011627906976745, 0.9127906976744186, 0.9069767441860465]
2023-02-26 14:28:39.551: valid_recall [0.276914960792738, 0.2657637640280074, 0.2730849903006048, 0.27379059054216953, 0.27423259938276373, 0.31543289435435246, 0.33231221628517293, 0.33184939340768516, 0.3406766767704276, 0.3465007837739207, 0.34325636470423254, 0.3459724107995587, 0.34581895674904906, 0.34301789631150664, 0.3412873870072267, 0.34099672064526626, 0.3450319973829279, 0.3356037538168603, 0.33985920801126834, 0.34641234934406734, 0.340504183773575, 0.3382127228719668, 0.3451119271093554, 0.3375569137991503, 0.34142690022897176, 0.3434104716271161, 0.3378012451968751, 0.34658559480028683, 0.3415961347007531, 0.34138304529536556, 0.340910930773644, 0.33967823991287616, 0.33587447455617436, 0.34398329866858995, 0.3350699024778031, 0.3340143323332913, 0.3440555738028163, 0.3461093043919727]
2023-02-26 14:28:39.551: test_hit [0.8709261051952243, 0.8717328170377541, 0.8649564375605033, 0.8944820909970959, 0.9031945788964182, 0.9062600838980316, 0.909809616005163, 0.9131978057437883, 0.9159406260083898, 0.9131978057437883, 0.9122297515327525, 0.9119070667957405, 0.9159406260083898, 0.9143272023233301, 0.9141658599548241, 0.914649887060342, 0.9164246531139078, 0.9107776702161988, 0.9138431752178122, 0.9183607615359793, 0.9130364633752823, 0.9138431752178122, 0.9117457244272346, 0.9117457244272346]
2023-02-26 14:28:39.551: test_hit [0.30282606417643415, 0.30206163383783113, 0.3007257008566889, 0.33798861707732486, 0.353005939167817, 0.35868968399220125, 0.3622177542227596, 0.366182953755308, 0.36739320816908183, 0.3646098404949658, 0.36618072237394333, 0.3660999127023188, 0.3691077824610444, 0.3704020918718634, 0.36905899392978475, 0.3692272580601393, 0.37102155114303126, 0.3663306493561496, 0.3683370798579089, 0.3747004602115777, 0.3679150727820454, 0.3677857944815733, 0.37028104803210987, 0.3662561488485413]
2023-02-26 14:28:39.551: train_loss [7.2572127853403865, 6.907833539005596, 6.902291274250278, 6.8796504999040335, 6.915244312906937, 11.679016718741986, 10.95242038972821, 10.71191112229575, 10.597121032284686, 10.512155615148638, 4.667981583378356, 4.664628049309453, 4.686775430332029, 4.7040757494650425, 4.705735350994789, 10.392081760812344, 10.335679156735589, 10.276812480117023, 10.246012877073728, 10.22318371724705, 4.55435704050158, 4.596448013763626, 4.608193970941904, 4.592384271581193, 4.598295319768585, 10.237661316763552, 10.205945543718974, 10.168416316593492, 10.132411529944656, 10.120858233047283, 4.58198709659628, 4.57460395542667, 4.575698505706551, 4.564922585015961, 4.581965206511395, 10.130826686473169, 10.084230525356896, 10.052348945563907]
